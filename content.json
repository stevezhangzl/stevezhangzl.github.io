{"meta":{"title":"SteveZhangåšå®¢","subtitle":"","description":"","author":"å¼ é¾™","url":"http://example.com","root":"/"},"pages":[{"title":"æ ‡ç­¾","date":"2022-02-17T19:42:42.000Z","updated":"2022-02-17T19:43:25.000Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""},{"title":"åˆ†ç±»","date":"2022-02-17T19:39:33.000Z","updated":"2022-02-17T19:44:01.000Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"æå‡æµ·é‡ç”¨æˆ·æè‡´ä½“éªŒçš„Hybridæ¶æ„è®¾è®¡[è½¬]","slug":"[è½¬]æå‡æµ·é‡ç”¨æˆ·æè‡´ä½“éªŒçš„ Hybrid æ¶æ„è®¾è®¡","date":"2022-03-17T20:23:47.000Z","updated":"2022-05-12T07:29:40.000Z","comments":true,"path":"2022/03/18/[è½¬]æå‡æµ·é‡ç”¨æˆ·æè‡´ä½“éªŒçš„ Hybrid æ¶æ„è®¾è®¡/","link":"","permalink":"http://example.com/2022/03/18/[%E8%BD%AC]%E6%8F%90%E5%8D%87%E6%B5%B7%E9%87%8F%E7%94%A8%E6%88%B7%E6%9E%81%E8%87%B4%E4%BD%93%E9%AA%8C%E7%9A%84%20Hybrid%20%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/","excerpt":"","text":"åŸæ–‡é“¾æ¥ å¼•è¨€ä¸Šä¸€ç¯‡åŸç†ç¯‡ï¼Œæˆ‘ä»¬å·²ç»è¯¦ç»†åœ°é˜è¿°äº† Hybrid App çš„åŸºç¡€åŸç†ï¼Œäº†è§£äº† Native ç«¯ å’Œ H5 ç«¯ æ˜¯å¦‚ä½•é€šä¿¡çš„ï¼Œè¿˜æœ‰ bridge çš„è®¾è®¡å’Œæ¥å…¥ã€‚è€Œæœ¬ç¯‡æ–‡ç« å°†å¼€å§‹æŠŠè¿™äº›åŸå› è¿›ä¸€æ­¥å®è·µï¼Œç”¨ä»£ç çœŸæ­£åœ°å»å®ç°ä¸€å¥—å®Œæ•´ä¸”ç¨³å®šçš„ Hybrid æ–¹æ¡ˆã€‚å¦‚æœå¯¹åŸç†è¿˜æœ‰ç–‘é—®çš„å°ä¼™ä¼´ï¼Œè¯·ç§»æ­¥æå‡æµ·é‡ç”¨æˆ·æè‡´ä½“éªŒçš„ Hybrid æ¶æ„è®¾è®¡ï¼ˆåŸç†ç¯‡ï¼‰ï¼Œåªæœ‰åœ¨ç†è§£äº†ç†è®ºçš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥ä¸å®è·µç›¸ç»“åˆï¼Œæ‰èƒ½çœŸæ­£åœ°å»æ·±å…¥ä¸€é¡¹æŠ€æœ¯ã€‚ æ‘©å¤©å¤§æ¥¼è¯´äº†é‚£ä¹ˆä¸€å¤§å †ç†è®ºçŸ¥è¯†ï¼Œå¯èƒ½æœ‰å°ä¼™ä¼´ä¼šè¯´ï¼šâ€œ ä½ æ˜¯ä¸æ˜¯å¹æµå¼Šå•Šã€‚â€é‚£å°±å…ˆæ¥ç®€å•ä»‹ç»ä¸‹æˆ‘ä»¬å·²ç»ä½¿ç”¨è¿™å¥—æ–¹æ¡ˆè½åœ°çš„é¡¹ç›®ä¹‹ä¸€ã€‚ è¿™æ˜¯ä¸€ä¸ªå®Œå…¨å†…ç½®åœ¨ App é‡Œçš„ Hybrid æ¨¡å—ï¼Œç”± Native ä¸ H5 æ·±åº¦åä½œå®Œæˆï¼Œæ€»å…±æœ‰ 4 ä¸ªé¡µé¢ï¼Œå…¶ä¸­é¦–é¡µå’Œåˆ¶ä½œé¡µç”± H5 åˆ¶ä½œï¼Œè€Œç›¸æœºé¡µå’Œä¿å­˜é¡µæ˜¯å¤ç”¨ Native é¡µé¢ã€‚ é¡¹ç›®ä¸Šçº¿ä¸€å¹´ç´¯ç§¯ä½¿ç”¨æ¬¡æ•°å·²ç»è¶…è¿‡ 10 äº¿æ¬¡ã€‚è¿™å¥—æ–¹æ¡ˆç»å—ä½äº†è€ƒéªŒï¼Œå¹¶åœ¨è¿‡ç¨‹ä¸­ä»ç„¶åœ¨ä¸æ–­çš„ä¼˜åŒ–å’Œæ‹“å±•ã€‚ ä½¿ç”¨è¿™å¥—å®ç°æ–¹æ¡ˆæ˜¯åŸºäºä»¥ä¸‹å‡ ç‚¹è€ƒè™‘ï¼š æ•´ä¸ªæ¨¡å—çš„é£æ ¼å¤šå˜ï¼Œæ•´ä½“ UI æ˜¯ä¸å¦†å®¹æ‰€æ­é…çš„ï¼Œè€Œæ•´ä¸ªæ¨¡å—ä¸€ç›´éƒ½åœ¨æŒç»­ä¸æ–­çš„è¿­ä»£ä¹‹ä¸­ï¼› é¡¹ç›®é€»è¾‘æµç¨‹çš„å¯å˜æ€§å¤§ï¼Œéœ€è¦ H5 å¼ºå¤§çš„çƒ­æ›´æ–°èƒ½åŠ›ï¼ŒåŠæ—¶åº”å¯¹æ•°æ®çš„å˜åŒ–ï¼Œå¿«é€Ÿçš„è¯•é”™å’Œçº æ­£ï¼› æ‹æ‘„é¡µä¸ä¿å­˜é¡µæ˜¯å®¢æˆ·ç«¯å·²ç»æœ‰çš„æ¨¡å—ï¼Œå¯ä»¥ç•¥å¾®å®šåˆ¶åç›´æ¥å¤ç”¨ï¼› éœ€è¦ç”±å®¢æˆ·ç«¯ååŠ©æ¥å…¥å¤šå¥— SDKï¼Œä¾‹å¦‚ä½¿ç”¨ç®—æ³• SDK è¿›è¡Œå¤æ‚çš„å›¾åƒå¤„ç†ã€‚ ç®€å•çœ‹å®Œé¡¹ç›®ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å¼€å§‹ bridge.js çš„æ„å»ºã€‚ç”±äºæœ¬ç³»åˆ—æ–‡ç« ä¸»è¦é¢å‘å‰ç«¯ç«¥é‹ï¼Œå› æ­¤æˆ‘ä»¬ä¸»è¦å±•å¼€ H5 çš„éƒ¨åˆ†ï¼Œå³ä¼šæ³¨å…¥åˆ°æ¯ä¸ªé¡µé¢å¤´éƒ¨çš„ bridge.js çš„å®ç°ï¼Œå®¢æˆ·ç«¯ä¸­çš„ SDK éƒ¨åˆ†å°±ä¸è¯¦ç»†è§£æ„äº†ï¼Œåªä¼šæåˆ°ä¸€äº›ç»†èŠ‚ã€‚ æ­å»ºåœ°åŸº â€” bridge.js æ¶æ„åŸºäºä¸Šç¯‡æ–‡ç« é˜è¿°çš„ç»“æ„ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥å»å®Œå–„ç»†èŠ‚éƒ¨åˆ†ï¼Œå…ˆæ•´ç†æˆä¸‹é¢è¿™æ ·çš„æµç¨‹ç»“æ„å›¾ï¼Œå¤§å®¶å…ˆçœ‹ä¸‹å›¾ï¼Œæœ‰ä¸ªå¤§è‡´çš„æ¦‚å¿µï¼š æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šç»†çœ‹é‡Œé¢å„ä¸ªéƒ¨åˆ†çš„ä»£ç å®ç°ã€‚ (ä¸€) ä¸šåŠ¡æ–¹ä½¿ç”¨å§¿åŠ¿é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸‹åœ¨è¿™å¥—æ–¹æ¡ˆä¸­ï¼Œä¸šåŠ¡æ–¹æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼Œä¸‹é¢ä»¥è·å–ç½‘ç»œçŠ¶æ€ä¸ºä¾‹ï¼š (äºŒ) H5 â€“&gt; Nativeæ¥ä¸‹æ¥ç›´æ¥æ¥çœ‹ nativeCall çš„å†…éƒ¨å®ç°ï¼š é‡Œé¢å¯ä»¥è§£æ„æˆä¸‹é¢ 4 ä¸ªæ­¥éª¤: 1.ç”Ÿæˆå”¯ä¸€ handler æ ‡è¯†ï¼Œä» 0 å¼€å§‹ç´¯åŠ ï¼› 2.å°†å‚æ•°æŒ‰ handler å€¼çš„è§„åˆ™å­˜å…¥å‚æ•°æ± (_paramsStore)ä¸­ï¼› 3.ä»¥ handler æ³¨å†Œè‡ªå®šä¹‰äº‹ä»¶ï¼Œç»‘å®š callbackï¼Œå¹¶å°† callback ä¹Ÿå­˜å…¥ _callbackStore ä¸­ï¼ŒaddEvent()ï¼Œå‚¨å­˜çš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†äº‹ä»¶è§£ç»‘æ—¶ä½¿ç”¨ï¼› 4.ä»¥ iframe çš„å½¢å¼å‘é€åè®®ï¼Œå¹¶æºå¸¦å”¯ä¸€æ ‡è¯† handlerï¼Œsend()ï¼› Native: å®¢æˆ·ç«¯æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šä½¿ç”¨ handler è°ƒç”¨ getParam ä»å‚æ•°æ± ä¸­è·å–å¯¹åº”çš„å‚æ•°ã€‚ æ‰§è¡Œåè®®å¯¹åº”çš„åŠŸèƒ½ï¼› è¿™æ ·å³èµ°é€šäº† H5 â€“&gt; Native çš„è¿™ä¸ªæµç¨‹ï¼Œåœ¨å®¢æˆ·ç«¯å®Œæˆäº†å¯¹åº”çš„åŠŸèƒ½åï¼Œæ—¢å¼€å§‹å›ä¼ æ‰§è¡Œç»“æœã€‚ (ä¸‰) Native â€“&gt; H5Nativeï¼š Native å®ŒæˆåŠŸèƒ½åï¼Œç›´æ¥è°ƒç”¨ Bridge.postMessage(handler, data)ï¼Œå°† æ‰§è¡Œç»“æœ å’Œ ä¹‹å‰ nativeCall ä¼ è¿‡æ¥çš„ æ ‡è¯† å›ä¼ ç»™ H5ï¼› H5ï¼š H5 åœ¨æ¥æ”¶åˆ°å”¯ä¸€æ ‡è¯†ååˆå§‹åŒ–å¯¹åº”çš„è‡ªå®šä¹‰äº‹ä»¶ï¼ŒæŒ‚è½½æ•°æ®åè§¦å‘ï¼Œè¿™é‡Œæ¶‰åŠçš„å°±æ˜¯ fireEvent è¿™ä¸ªå‡½æ•°: è¿™æ ·ï¼Œæˆ‘ä»¬å°±å·²ç»å®Œæˆäº†åŒç«¯ä¹‹é—´çš„åŒå‘äº¤äº’æœºåˆ¶äº†ï¼Œæ¢³ç†å‡ºäº†æ•´ä¸ª bridge.js çš„æ ¸å¿ƒä»£ç äº†ï¼ŒåŒ…å«äº†ï¼š æœ€é‡è¦çš„å¼€æ”¾ API: nativeCall ä¸ postMessage ï¼› å®¢æˆ·ç«¯è·å–å‚æ•°å‡½æ•°: getParam ï¼› äº‹ä»¶å›è°ƒç³»ç»Ÿä¸­çš„ addEvent å’Œ fireEvent ï¼› ç”¨äºå‘é€åè®®çš„ sendã€‚ å®‰å“å…¼å®¹æ€§å¦‚æœçœ‹è¿‡ä¸Šä¸€ç¯‡æå‡æµ·é‡ç”¨æˆ·æè‡´ä½“éªŒçš„ Hybrid æ¶æ„è®¾è®¡ï¼ˆåŸç†ç¯‡ï¼‰çš„ç«¥é‹ï¼Œè¿™æ—¶å¯èƒ½ä¼šæœ‰ä¸ªç–‘é—®ï¼šåœ¨ Android 4.4 ä»¥ä¸‹æ—¶ï¼Œä½¿ç”¨çš„ loadUrl è¿›è¡Œ js å‡½æ•°çš„è°ƒç”¨ï¼Œè€Œæ­¤æ—¶æ˜¯æ— æ³•è·å–å‡½æ•°çš„è¿”å›å€¼çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ 4.4- æ—¶ï¼Œå®‰å“å¹¶æ— æ³•é€šè¿‡ getParam è¿™ä¸ªå‡½æ•°æ¥è·å–åˆ°åè®®çš„å‚æ•°ï¼Œè¿™é‡Œéœ€è¦åšå…¼å®¹æ€§çš„å¤„ç†ï¼Œè€Œæˆ‘ä»¬è¿™é‡Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ›²çº¿æ•‘å›½çš„éªšæ“ä½œï¼Œä½¿ç”¨åˆ°çš„åŸç†å°±æ˜¯ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æœ‰æåˆ°çš„å¦ä¸€ç§ H5 -&gt; Native çš„æ–¹æ¡ˆï¼šWebView ä¸­çš„ prompt æ‹¦æˆª æ–¹æ¡ˆå¦‚ä¸‹: å½“å®‰å“æ¥å—åˆ°åè®®ï¼Œå¹¶æ‹¿åˆ° handler å€¼ï¼› ä½¿ç”¨æ— å…¼å®¹æ€§é—®é¢˜çš„ loadUrl æ‰§è¡Œ jsï¼šBridge.getParam(handler) ï¼Œç›´æ¥å°†è¿”å›å€¼ç›´æ¥é€šè¿‡ js ä¸­çš„ prompt å‘å‡ºï¼š é€šè¿‡é‡å†™ onJsPrompt è¿™ä¸ªæ–¹æ³•ï¼Œæ‹¦æˆªä¸Šä¸€æ­¥å‘å‡ºçš„ prompt çš„å†…å®¹ï¼Œå¹¶è§£æå‡ºç›¸åº”çš„å‚æ•°ï¼› é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œå®‰å“å…¨å¹³å°éƒ½å¯ä»¥å®Œæˆå‚æ•°çš„è·å–ï¼Œå¹¶ä¸”æ–¹å¼ç»Ÿä¸€ï¼Œä¸éœ€è¦åˆ†å¹³å°å…¼å®¹ï¼Œè¿™å°±éå¸¸çš„ skrskr å•¦ã€‚ ç°åœ¨çœ‹ä¸‹æ¥ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—ç‚’é¸¡ç®€å•ï¼Ÿã€‚åˆ†åˆ†é’Ÿèƒ½å†™ 100 ä¸ªã€‚æ²¡é”™ï¼å…¶å®æ ¸å¿ƒçš„åŸç†å°±æ˜¯è¿™ä¹ˆçš„ç®€å•ï¼Œä½†è¿™åªæ˜¯ä¸€ä¸ªæœ€åŸºç¡€çš„åœ°åŸºè€Œå·²ï¼Œè€ŒåŸºäºåœ°åŸºä¹‹ä¸Šï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ä¸€å±‚ä¸€å±‚å»ºé€ æˆ‘ä»¬çš„å¤§æ¥¼äº†ï¼ å»ºé€ å¤§æ¥¼ â€” åè®®çš„å®šåˆ¶åœ¨å®Œæˆæœ€åŸºç¡€çš„æ¶æ„åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ¥è¿›ä¸€æ­¥å®Œæˆä¸€äº›ä¸Šå±‚å»ºç­‘äº†ï¼Œåˆ¶å®šä¸€ç³»åˆ—çœŸæ­£å¼€æ”¾ç»™ä¸šåŠ¡æ–¹ä½¿ç”¨çš„åè®® APIï¼Œå®Œå–„æ•´å¥—æ–¹æ¡ˆã€‚ é¦–å…ˆæˆ‘ä»¬å¯ä»¥å°†è¿™äº›åè®®åˆ†æˆ åŠŸèƒ½åè®® å’Œ ä¸šåŠ¡åè®®ã€‚ åŠŸèƒ½åè®®è¿™ç±»åè®®æ˜¯æŒ‡ç”¨äºå®Œå–„æ•´å¥—æ–¹æ¡ˆçš„åŸºç¡€åŠŸèƒ½çš„ä¸€äº›é€šç”¨åè®®ï¼Œä»¥ command:&#x2F;&#x2F;ä½œä¸ºé€šç”¨å¤´ï¼Œå°è£…åœ¨ SDK ä¹‹ä¸­ï¼Œå¯ä»¥åœ¨å…¨çº¿ Appã€å…¨çº¿ WebView ä¸­ä½¿ç”¨ï¼š 1.åˆå§‹åŒ–æœºåˆ¶ä¸Šç¯‡æ–‡ç« æœ‰æåˆ°ç”±äº bridge.js æ³¨å…¥çš„å¼‚æ­¥æ€§ï¼Œæˆ‘ä»¬éœ€è¦ç”±å®¢æˆ·ç«¯åœ¨æ³¨å…¥å®Œæˆåé€šçŸ¥ H5ã€‚ è¿™é‡Œæˆ‘ä»¬å¯ä»¥çº¦å®šä¸€ä¸ªé€šç”¨çš„åˆå§‹åŒ–äº‹ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬çº¦å®šä¸º initï¼Œå› æ­¤å‰ç«¯å°±å¯ä»¥è¿›è¡Œå…¥å£çš„ç›‘å¬, ç±»ä¼¼äºæˆ‘ä»¬å¸¸ç”¨çš„ DOMContentLoaded: å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œç”¨äº†ä¸ªæ ‡è®°ä½ç”¨äºé¿å…äº‹ä»¶è¢«é‡å¤è§¦å‘ï¼Œè¿™æ˜¯ç”±äºå®¢æˆ·ç«¯ä¸­æ˜¯é€šè¿‡ç›‘å¬ WebView çš„ç”Ÿå‘½å‘¨æœŸé’©å­æ¥è§¦å‘çš„ï¼Œè€Œ iframe ä¹‹ç±»çš„æ“ä½œä¼šå¯¼è‡´è¿™äº›é’©å­çš„å¤šæ¬¡è§¦å‘ï¼Œå› æ­¤éœ€è¦åŒæ–¹å„åšä¸€å±‚é˜²å¾¡æ€§æªæ–½ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¥äº‹ä»¶ï¼Œç›´æ¥åˆå§‹åŒ–ä¼ ç»™ H5 ä¸€äº›ç¯å¢ƒå‚æ•°å’Œç³»ç»Ÿä¿¡æ¯ç­‰ï¼Œä¸‹é¢æ˜¯æˆ‘ä»¬ä½¿ç”¨åˆ°çš„ï¼š åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥çº¦å®šæ›´å¤šçš„é¡µé¢ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ï¼Œä¾‹å¦‚å› ä¸º App å¾ˆç»å¸¸æ€§çš„éšè—åˆ°åå°ï¼Œå› æ­¤åœ¨è¢«æ¿€æ´»æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸ªç”Ÿå‘½å‘¨æœŸ: resumeï¼Œå¯ä»¥ç”¨äºå‘ŠçŸ¥ H5 é¡µé¢è¢«æ¿€æ´»ã€‚ Tips: è¿™é‡Œå°±èƒ½ä½“ç°å‡ºæˆ‘ä»¬é€šè¿‡äº‹ä»¶æœºåˆ¶æ¥ä½œä¸ºå›è°ƒç³»ç»Ÿçš„ä¼˜åŠ¿äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥æœ€ä¹ æƒ¯çš„æ–¹å¼è¿›è¡Œäº‹ä»¶çš„ç›‘å¬ï¼Œè€Œå®¢æˆ·ç«¯å¯ä»¥ç›´æ¥ä½¿ç”¨ bridge.fireEvent(â€˜initâ€™, data)è§¦å‘äº‹ä»¶ï¼Œè¿™æ ·ä¾¿å¯ä»¥ä¼˜é›…åœ°å®ç° Native -&gt; H5 çš„å•æ–¹å‘äº¤äº’ã€‚ 2.æ‰“åŒ…æœºåˆ¶Hybrid æ¨¡å— çš„å…¶ä¸­ä¸€ç§æ–¹å¼æ˜¯å°†å‰ç«¯ä»£ç æ‰“åŒ…åå†…ç½®äº App æœ¬åœ°ï¼Œä»¥ä¾¿æ‹¥æœ‰æœ€å¿«çš„å¯åŠ¨æ€§èƒ½å’Œç¦»çº¿è®¿é—®èƒ½åŠ›ã€‚è€Œè¿™ç§æ–¹å¼æœ€å¤§çš„éº»çƒ¦ç‚¹ï¼Œå°±æ˜¯ä»£ç çš„æ›´æ–°ï¼Œæˆ‘ä»¬ä¸å¯èƒ½æ¯æ¬¡æœ‰ä¿®æ”¹æ—¶å°±æ‰‹åŠ¨é‡æ–°æ‰“åŒ…ç»™å®¢æˆ·ç«¯ç«¥é‹æ›¿æ¢ï¼Œè€Œä¸”è¿™æ ·ä¹Ÿå¤±å»äº†æˆ‘ä»¬çš„çƒ­æ›´æ–°æœºåˆ¶ã€‚ å› æ­¤è¿™é‡Œå°±éœ€è¦ä¸€å¥—æ–°çš„çƒ­æ›´æ–°æœºåˆ¶ï¼Œè¿™å¥—æœºåˆ¶éœ€è¦ç”±å®¢æˆ·ç«¯&#x2F;å‰ç«¯&#x2F;æœåŠ¡ç«¯ ä¸‰ç«¯çš„ç«¥é‹æä¾›å¯¹åº”çš„èµ„æºï¼Œå…±åŒåä½œå®Œæˆæ•´å¥—æµç¨‹ã€‚ èµ„æºï¼š H5: æ¯ä¸ªä»£ç åŒ…éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€ä¸”é€’å¢çš„ç‰ˆæœ¬å·ï¼› Native: æä¾›åŒ…ä¸‹è½½ä¸”è§£å‹åˆ°å¯¹åº”ç›®å½•çš„æœåŠ¡ï¼Œå‰ç«¯å¯ä»¥ç”±ä¸‹é¢è¿™ä¸ªåè®®æ¥è°ƒç”¨è¯¥åŠŸèƒ½ã€‚ æœåŠ¡ç«¯: æä¾›ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥è·å–çº¿ä¸Šæœ€æ–°ä»£ç åŒ…çš„ç‰ˆæœ¬å·å’Œä¸‹è½½åœ°å€ã€‚ æµç¨‹ï¼š å‰ç«¯æ›´æ–°ä»£ç æ‰“åŒ…åæŒ‰ç‰ˆæœ¬å·ä¸Šä¼ è‡³æŒ‡å®šçš„æœåŠ¡å™¨ä¸Šï¼› æ¯æ¬¡æ‰“å¼€é¡µé¢æ—¶ï¼ŒH5 è¯·æ±‚æ¥å£è·å–çº¿ä¸Šæœ€æ–°ä»£ç åŒ…ç‰ˆæœ¬å·ï¼Œå¹¶ä¸æœ¬åœ°åŒ…è¿›è¡Œç‰ˆæœ¬å·æ¯”å¯¹ï¼Œå½“çº¿ä¸Šçš„ç‰ˆæœ¬å· å¤§äº æœ¬åœ°åŒ…ç‰ˆæœ¬å·æ—¶ï¼Œå‘èµ·åŒ…ä¸‹è½½åè®®ï¼š å®¢æˆ·ç«¯æ¥å—åˆ°åè®®åï¼Œç›´æ¥å»çº¿ä¸Šåœ°å€ä¸‹è½½æœ€æ–°çš„ä»£ç åŒ…ï¼Œå¹¶è§£å‹æ›¿æ¢åˆ°å½“å‰ç›®å½•æ–‡ä»¶ã€‚ æ‹¥æœ‰è¿™æ ·çš„æœºåˆ¶åï¼ŒH5 åœ¨å¼€å‘åï¼Œå°±å¯ä»¥ç›´æ¥æ‰“åŒ…å°†åŒ…ä¸Šä¼ åˆ°å¯¹åº”çš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·åœ¨ App ä¸­æ‰“å¼€é¡µé¢åï¼Œå³å¯ä»¥å®æ—¶çš„çƒ­æ›´æ–°ã€‚ 3.ç¯å¢ƒç³»ç»Ÿ å’Œ å¤šè¯­è¨€ç³»ç»Ÿé€šå¸¸ï¼Œæˆ‘ä»¬ä¼šå°†é¡¹ç›®åˆ†æˆå¤šä¸ªä¸åŒçš„ç¯å¢ƒï¼Œç›¸äº’éš”ç¦»ã€‚è€Œç”±äº Hybrid æ¨¡å—æ˜¯ç½®äº App ä¸­çš„ï¼Œå› æ­¤ç¯å¢ƒéœ€è¦ä¸ App è¿›è¡ŒåŒ¹é…ï¼Œè¿™é‡Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸Šé¢ç¬¬ä¸€ç‚¹æåˆ°çš„ï¼Œé€šè¿‡ init ä¸­æºå¸¦çš„æ•°æ® data.env æ¥åŒ¹é…ï¼š env: 0 - æ­£å¼ç¯å¢ƒï¼› 1 - æµ‹è¯•ç¯å¢ƒï¼› 2 - å¼€å‘ç¯å¢ƒï¼› åŒç†ï¼Œ å¤šè¯­è¨€ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ e.data.language ç›´æ¥è¿›è¡ŒåŒ¹é…ï¼› Tipsï¼š ç¯å¢ƒæœºåˆ¶æˆ‘ä»¬é€šå¸¸ä¸»è¦ç”¨äºåŒ¹é…åç«¯çš„ç¯å¢ƒï¼Œæ­£å¼ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒå¯¹åº”ä¸åŒçš„æ¥å£ã€‚è€Œè¿™é‡Œè¿˜æœ‰ä¸€ç‚¹ç‰¹åˆ«çš„ï¼Œå°±æ˜¯éœ€è¦æ³¨æ„ä»£ç åŒ…çš„æ›´æ–°ï¼Œä¸Šè¿°çš„åŒ…æ›´æ–°æ¡ä»¶è¦åŒ…å«ä¸‰ä¸ªæ–¹é¢: ç‰ˆæœ¬å·ã€ç¯å¢ƒå’Œ App ç‰ˆæœ¬ï¼Œåœ¨ä¸åŒç¯å¢ƒä¸åŒ App ç‰ˆæœ¬ä¸‹ï¼Œä¹Ÿåº”è¯¥æ›´æ–°åˆ°ç›¸åº”çš„æœ€æ–°ä»£ç åŒ…ã€‚ 4. äº‹ä»¶ä¸­è½¬ç«™ç”±äºé¡µé¢æ˜¯ H5 å¼€å‘ï¼Œè€Œ Native å¯èƒ½éœ€è¦æ§åˆ¶ H5 é¡µé¢ï¼Œä¾‹å¦‚æœ€å¸¸ç”¨çš„åœºæ™¯: å½“é¡µé¢ä¸­æœ‰å¼¹çª—æˆ–è€… SPA åˆ‡æ¢é¡µé¢æ—¶ï¼Œå®‰å“çš„è¿”å›å®ä½“é”®åº”è¯¥èƒ½å®Œæˆå¯¹åº”çš„å›é€€ï¼Œè€Œä¸æ˜¯å› ä¸º WebView æ²¡æœ‰ history å°±ç›´æ¥å…³é—­ã€‚ ç±»ä¼¼äºè¿™ç±»éœ€æ±‚ï¼Œè¿™é‡Œå°±å¯ä»¥å®šåˆ¶ä¸€ä¸ªäº‹ä»¶ä¸­å¿ƒ(eventListeners )ï¼Œç”¨äºç›‘å¬å®¢æˆ·ç«¯çš„å®ä½“è¿”å›é”®ï¼š 5. æ•°æ®ä¼ é€’æœºåˆ¶åœ¨ä¸šåŠ¡ä¸­ï¼Œå¾ˆå¤šåœºæ™¯éœ€è¦åšåˆ° Native ä¸ H5 ä¿æŒæ•°æ®çš„åŒæ­¥ï¼Œæ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨ç±»ä¼¼ä¸Šé¢çš„åŸç†ï¼Œåˆ¶å®šä¸€å¥—æ•°æ®ä¼ é€’åè®®: Tipsï¼š Hybrid æ¨¡å—é€šå¸¸éœ€è¦ä»å¯¹åº”çš„å…¥å£è¿›å…¥ï¼Œå› æ­¤è¿™é‡Œæœ‰ä¸€ç§å¯ä»¥ä¼˜åŒ–çš„æ–¹å¼ï¼š ç”± App åœ¨å¯åŠ¨æ—¶å…ˆå»è·å–çº¿ä¸Šæ•°æ®ï¼Œåœ¨è¿›å…¥ WebView åç›´æ¥é€šè¿‡ init æˆ–è€…è§¦å‘ getData ç›´æ¥å‘é€ç»™ H5ï¼Œè¿™æ ·èƒ½å‡å°‘è¯·æ±‚æ•°é‡ï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒã€‚ 6. ä»£ç†è¯·æ±‚H5 ä¸­æœ€å¸¸ç”¨çš„å°±æ˜¯è¯·æ±‚ï¼Œé€šå¸¸æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ ajaxï¼Œä½†æ˜¯è¿™é‡Œæœ‰å‡ ä¸ªé—®é¢˜æ¯”è¾ƒæ£˜æ‰‹: æœ€å¸¸è§çš„è¯·æ±‚è·¨åŸŸï¼› æ•°æ®ç®—æ³•åŠ å¯†ï¼› ç”¨æˆ·ç™»å½•æ ¡éªŒï¼› è€Œå®¢æˆ·ç«¯çš„è¯·æ±‚ä¾¿ä¸ä¼šå‡ºç°è¿™äº›é—®é¢˜ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”±å®¢æˆ·ç«¯ä»£ç†æˆ‘ä»¬å‘å‡ºçš„è¯·æ±‚ï¼Œå¯ä»¥å®šåˆ¶ 4 ä¸ªåè®®: getProxyï¼ŒpostProxyï¼Œ getProxyLoginedï¼ŒpostProxyLoginedï¼Œå…¶ä¸­å¸¦æœ‰ Logined çš„åè®®ä»£è¡¨ç€åœ¨è¯·æ±‚æ—¶ä¼šè‡ªåŠ¨æºå¸¦å·²ç™»å½•ç”¨æˆ·çš„ token å’Œ uid ç­‰å‚æ•°ï¼Œä½¿ç”¨åœ¨ä¸€äº›éœ€è¦ç™»å½•ä¿¡æ¯çš„æ¥å£ä¸Šã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š H5 æ–¹å°±æ— éœ€å¤„ç†ç¹å¤šçš„å„é¡¹å¤æ‚ä¿¡æ¯ï¼Œä¸éœ€è¦è¿›è¡Œè·¨ç«¯ä¼ è¾“ï¼› èƒ½å¤Ÿå¯¹ H5 ä¸ Native çš„è¯·æ±‚å‡ºå£è¿›è¡Œç»Ÿä¸€ï¼Œæ–¹ä¾¿åŠ å·¥å¤„ç†ã€‚ 7.æ›´å¤šé™¤äº†è¿™äº›é‡è¦çš„åŠŸèƒ½å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥éå¸¸è‡ªç”±åœ°å®šåˆ¶å¾ˆå¤šåè®®ï¼Œè®© H5 æ‹¥æœ‰æ›´å¤šæ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œä¸‹é¢æ˜¯æˆ‘ä»¬æ‰€å®šåˆ¶çš„ä¸€äº›åŠŸèƒ½ï¼š getNetworkï¼šè·å–ç½‘ç»œçŠ¶æ€ï¼› openAppï¼šå”¤èµ·å…¶å®ƒ Appï¼› setShareInfo ä¸ callShareï¼šåˆ†äº«å†…å®¹åˆ°ç¬¬ä¸‰æ–¹å¹³å°ï¼› linkï¼šä½¿ç”¨æ–°çš„ WebView æ‰“å¼€é¡µé¢ï¼› closeWebviewï¼šå…³é—­ WebViewï¼› setStorage ä¸ getStorageï¼šè®¾ç½®ä¸è·å–ç¼“å­˜æ•°æ®ï¼› loadingï¼šè°ƒç”¨å®¢æˆ·ç«¯é€šç”¨ Loadingï¼› setWebviewTitleï¼šè®¾ç½® WebView æ ‡é¢˜ï¼› saveImageï¼šä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°ï¼› â€¦ è¿™é‡Œå¯ä»¥å®šä¹‰æ›´å¤šçš„é€šç”¨æ€§åè®®ï¼Œè¿™é‡Œæœ‰ä¸ªåŸåˆ™å¯ä»¥éµå®ˆï¼Œå³è¿™éƒ¨åˆ†åè®®åº”è¯¥æ˜¯åŸºç¡€æ€§åŠŸèƒ½ï¼Œåº”è¯¥æ˜¯çº¯å‡€çš„ï¼Œé€‚ç”¨äºæ‰€æœ‰çš„ä¸šåŠ¡æ–¹ã€‚æ ¹æ®ä¸Šç¯‡æ–‡ç« æåˆ°çš„ç†å¿µï¼Œè¿™éƒ¨åˆ†æ˜¯å½“æˆé€šç”¨ SDK è¿›è¡Œç»´æŠ¤ä¸å‡çº§çš„ï¼Œå› æ­¤ä¸åº”è¯¥è€¦åˆä¸šåŠ¡å±‚çš„ä»»ä½•é€»è¾‘ã€‚ è€Œæœ‰æ—¶æˆ‘ä»¬ä¼šé‡åˆ°éœ€è¦å®šåˆ¶ä¸€äº›ä¸šåŠ¡ä¸Šçš„é€»è¾‘ï¼Œä¾‹å¦‚ä¸Šé¢æåˆ°çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬è¦å°†ç”¨æˆ·å›¾ç‰‡é€šè¿‡ç®—æ³•å¤„ç†æˆå¡é€šç”»ã€‚è¿™æ ·çš„éœ€æ±‚å°±æ˜¯éå¸¸çš„ä¸šåŠ¡åŒ–ï¼Œä¸é€‚ç”¨äºå…¶å®ƒé¡¹ç›®ï¼Œå› æ­¤æˆ‘ä»¬åº”è¯¥å®šåˆ¶æˆä¸šåŠ¡åè®®ã€‚ ä¸šåŠ¡åè®®è¿™ç±»åè®®åŒºåˆ«äºåŠŸèƒ½åè®®ï¼Œå®ƒä»¬ä¼šæ‚åˆä¸€å®šç¨‹åº¦çš„ä¸šåŠ¡é€»è¾‘ï¼Œè€Œè¿™äº›é€»è¾‘åªæ˜¯é’ˆå¯¹äºç‰¹å®šçš„é¡¹ç›®ã€‚å…¶å®å¯¹äº H5 çš„ä½¿ç”¨ä¸Šï¼Œå·®åˆ«å¹¶ä¸å¤§ï¼Œåªæ˜¯ä½¿ç”¨å¯¹åº”ç‰¹æ®Šçš„åè®®å¤´ç”¨äºåŒºåˆ†ï¼Œä¾‹å¦‚: è¿™ç±»åè®®é€šå¸¸ä¸åŒ…å«åœ¨ SDK ä¸­ï¼Œå› æ­¤éœ€è¦ç”±å®¢æˆ·ç«¯çš„ç«¥é‹é’ˆå¯¹é¡¹ç›®çš„ WebView è¿›è¡Œå®šåˆ¶ï¼Œä½¿ç”¨ bridge.js æä¾›çš„åŸºç¡€åŠŸèƒ½å®ç°å¯¹åº”çš„å¤æ‚åŠŸèƒ½ã€‚è€Œåœ¨å…¶å®ƒçš„é¡¹ç›®å…¥å£ä¸­ï¼Œå°±æ— æ³•ä½¿ç”¨è¿™äº›åè®®ã€‚ æ€»ç»“çœ‹åˆ°æ€»ç»“ä¸¤ä¸ªå­—ï¼Œæœ‰æ²¡æœ‰é•¿èˆ’äº†ä¸€å£æ°”ã€‚é€šè¿‡è¿™ä¸¤ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ç»ˆäºå°† Hybrid æ–¹æ¡ˆçš„å‰ç«¯éƒ¨åˆ†å®Œå…¨çš„è§£æ„æ¸…æ¥šäº†ï¼Œæ˜¯ä¸æ˜¯æœ‰ç§ç¥æ¸…æ°”çˆ½çš„æ„Ÿè§‰ï¼Œå®Œå…¨å¯ä»¥é©¬ä¸Šå¼€å¯ä½ ä»¬çš„ Hybrid ä¹‹æ—…äº†ã€‚é¼“æŒé¼“æŒï¼ ä½†è¿™ä¹Ÿè¿œéç»ˆç‚¹ï¼Œæˆ–è€…è¯´è¿™æ°¸æ— ç»ˆç‚¹ã€‚~å¤§æ¥¼å»ºæˆåï¼Œç¦»çœŸæ­£çš„æ‘©å¤©å¤§æ¥¼è¿˜æ˜¯å·®ç€ä¸€æ­¥ â€” å†…éƒ¨è£…ä¿®ï¼Œå…¶å®æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜éœ€è¦åšå¾ˆå¤šçš„ä¼˜åŒ–æªæ–½ï¼Œæ¥è§£å†³ä¸€äº›ä»ç„¶å­˜åœ¨çš„é—®é¢˜ï¼Œè¿™éƒ¨åˆ†å…¶å®æˆ‘ä»¬ä¹Ÿä¸€ç›´è¿˜åœ¨åŠªåŠ›çš„é˜¶æ®µã€‚ å—ç¯‡å¹…æ‰€é™ï¼Œæœ‰æ—¶é—´ä¼šå°†è¿™éƒ¨åˆ†å†å†™ä¸€ç¯‡ä¼˜åŒ–ç¯‡ï¼Œä¸»è¦æ¥ä¸å¤§å®¶æ¢è®¨ä¸‹æˆ‘ä»¬æ‰€èƒ½æƒ³åˆ°çš„ä¸€äº›ä¼˜åŒ–æ–¹æ¡ˆï¼Œéå¸¸æœŸå¾…å¤§ä½¬ä»¬ä¹Ÿèƒ½ç»™æˆ‘ä»¬æä¾›æ›´å¤šçš„å»ºè®®å’Œè§£å†³åŠæ³•ã€‚æ„Ÿæ©~~ğŸ˜‡","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"webview","slug":"webview","permalink":"http://example.com/tags/webview/"},{"name":"hybrid","slug":"hybrid","permalink":"http://example.com/tags/hybrid/"}]},{"title":"æå‡æµ·é‡ç”¨æˆ·æè‡´ä½“éªŒçš„Hybridæ¶æ„è®¾è®¡ï¼ˆåŸç†ç¯‡ï¼‰[è½¬]","slug":"[è½¬]æå‡æµ·é‡ç”¨æˆ·æè‡´ä½“éªŒçš„ Hybrid æ¶æ„è®¾è®¡ï¼ˆåŸç†ç¯‡ï¼‰","date":"2022-03-16T20:23:47.000Z","updated":"2022-05-12T07:31:29.000Z","comments":true,"path":"2022/03/17/[è½¬]æå‡æµ·é‡ç”¨æˆ·æè‡´ä½“éªŒçš„ Hybrid æ¶æ„è®¾è®¡ï¼ˆåŸç†ç¯‡ï¼‰/","link":"","permalink":"http://example.com/2022/03/17/[%E8%BD%AC]%E6%8F%90%E5%8D%87%E6%B5%B7%E9%87%8F%E7%94%A8%E6%88%B7%E6%9E%81%E8%87%B4%E4%BD%93%E9%AA%8C%E7%9A%84%20Hybrid%20%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%EF%BC%88%E5%8E%9F%E7%90%86%E7%AF%87%EF%BC%89/","excerpt":"","text":"åŸæ–‡é“¾æ¥ ä¸€ã€å¼•è¨€éšç€ Web æŠ€æœ¯å’Œç§»åŠ¨è®¾å¤‡çš„å¿«é€Ÿå‘å±•ï¼ŒHybrid æŠ€æœ¯å·²ç»æˆä¸ºä¸€ç§æœ€ä¸»æµæœ€å¸¸è§çš„æ–¹æ¡ˆã€‚ä¸€å¥—å¥½çš„ Hybrid æ¶æ„æ–¹æ¡ˆèƒ½è®© App æ—¢èƒ½æ‹¥æœ‰æè‡´çš„ä½“éªŒå’Œæ€§èƒ½ï¼ŒåŒæ—¶ä¹Ÿèƒ½æ‹¥æœ‰ Web æŠ€æœ¯çµæ´»çš„å¼€å‘æ¨¡å¼ã€è·¨å¹³å°èƒ½åŠ›ä»¥åŠçƒ­æ›´æ–°æœºåˆ¶ï¼Œæƒ³æƒ³æ˜¯ä¸æ˜¯éƒ½é¸¡å†»ä¸å·²â€¦æœ¬ç³»åˆ—æ–‡ç« æ˜¯ç¾å›¾å…¬å¸åœ¨è¿™æ–¹é¢å®è·µçš„ä¸€ä¸ªæ€»ç»“ï¼ŒåŒ…å«äº†åŸç†è§£æã€æ–¹æ¡ˆé€‰å‹ä¸å®ç°ã€å®è·µä¼˜åŒ–ç­‰æ–¹é¢ã€‚ å¤§å®¶å¯ä»¥åˆ° github (https://github.com/xd-tayde/blog/blob/master/hybrid-1.md)ä¸Šå’Œä½œè€…è¿›è¡Œè®¨è®ºå“ˆï¼ äºŒã€ç°æœ‰æ··åˆæ–¹æ¡ˆHybrid Appï¼Œä¿—ç§°æ··åˆåº”ç”¨ï¼Œå³æ··åˆäº† Native æŠ€æœ¯ ä¸ Web æŠ€æœ¯è¿›è¡Œå¼€å‘çš„ç§»åŠ¨åº”ç”¨ã€‚ç°åœ¨æ¯”è¾ƒæµè¡Œçš„æ··åˆæ–¹æ¡ˆä¸»è¦æœ‰ä¸‰ç§ï¼Œä¸»è¦æ˜¯åœ¨ UI æ¸²æŸ“æœºåˆ¶ä¸Šçš„ä¸åŒï¼š 1.åŸºäº WebView UI çš„åŸºç¡€æ–¹æ¡ˆï¼Œå¸‚é¢ä¸Šå¤§éƒ¨åˆ†ä¸»æµ App éƒ½æœ‰é‡‡ç”¨ï¼Œä¾‹å¦‚å¾®ä¿¡ JS-SDK ï¼Œé€šè¿‡ JSBridge å®Œæˆ H5 ä¸ Native çš„åŒå‘é€šè®¯ï¼Œä»è€Œèµ‹äºˆ H5 ä¸€å®šç¨‹åº¦çš„åŸç”Ÿèƒ½åŠ›ã€‚ 2.åŸºäº Native UI çš„æ–¹æ¡ˆï¼Œä¾‹å¦‚ React-Nativeã€Weexã€‚åœ¨èµ‹äºˆ H5 åŸç”Ÿ API èƒ½åŠ›çš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥é€šè¿‡ JSBridge å°† js è§£ææˆçš„è™šæ‹ŸèŠ‚ç‚¹æ ‘( Virtual DOM )ä¼ é€’åˆ° Native å¹¶ä½¿ç”¨åŸç”Ÿæ¸²æŸ“ã€‚ 3.å¦å¤–è¿˜æœ‰è¿‘æœŸæ¯”è¾ƒæµè¡Œçš„å°ç¨‹åºæ–¹æ¡ˆï¼Œä¹Ÿæ˜¯é€šè¿‡æ›´åŠ å®šåˆ¶åŒ–çš„ JSBridgeï¼Œå¹¶ä½¿ç”¨åŒ WebView åŒçº¿ç¨‹çš„æ¨¡å¼éš”ç¦»äº† JS é€»è¾‘ä¸ UI æ¸²æŸ“ï¼Œå½¢æˆäº†ç‰¹æ®Šçš„å¼€å‘æ¨¡å¼ï¼ŒåŠ å¼ºäº† H5 ä¸ Native æ··åˆç¨‹åº¦ï¼Œæé«˜äº†é¡µé¢æ€§èƒ½åŠå¼€å‘ä½“éªŒã€‚ ä»¥ä¸Šçš„ä¸‰ç§æ–¹æ¡ˆï¼Œå…¶å®åŒæ ·éƒ½æ˜¯åŸºäº JSBridge å®Œæˆçš„é€šè®¯å±‚ï¼Œç¬¬äºŒä¸‰ç§æ–¹æ¡ˆï¼Œå…¶å®å¯ä»¥çœ‹åšæ˜¯åœ¨æ–¹æ¡ˆä¸€çš„åŸºç¡€ä¸Šï¼Œç»§ç»­é€šè¿‡ä¸åŒçš„æ–°æŠ€æœ¯è¿›ä¸€æ­¥æé«˜äº†åº”ç”¨çš„æ··åˆç¨‹åº¦ã€‚å› æ­¤ï¼ŒJSBridge ä¹Ÿæ˜¯æ•´ä¸ªæ··åˆåº”ç”¨æœ€å…³é”®çš„éƒ¨åˆ†ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨è®¾ç½®å¾®ä¿¡åˆ†äº«æ—¶ç”¨åˆ°çš„ JS-SDKï¼Œwx å¯¹è±¡ä¾¿æ˜¯æˆ‘ä»¬æœ€å¸¸è§çš„ JSBridge: ä¸‰ã€æ–¹æ¡ˆé€‰å‹ä»»ä½•æŠ€æœ¯æ–¹æ¡ˆçš„é€‰å‹ï¼Œå…¶å®éƒ½åº”è¯¥åŸºäºä½¿ç”¨åœºæ™¯å’Œç°æœ‰æ¡ä»¶ã€‚åŸºäºå…¬å¸ç°æœ‰æƒ…å†µçš„å‡ ç‚¹è€ƒè™‘ï¼Œåœ¨æ–¹æ¡ˆä¸€ä¸Šè¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œæ›´åŠ é€‚åˆæˆ‘ä»¬çš„éœ€æ±‚ã€‚ éœ€æ±‚ Web æŠ€æœ¯ å¿«é€Ÿè¿­ä»£ã€çµæ´»å¼€å‘çš„ç‰¹ç‚¹å’Œçº¿ä¸Šçƒ­æ›´æ–°çš„æœºåˆ¶ã€‚ äº§å“çš„æ ¸å¿ƒèƒ½åŠ›æ˜¯å¼ºå¤§çš„æ‹ç…§ä¸åº•å±‚å›¾ç‰‡å¤„ç†èƒ½åŠ›ï¼Œå› æ­¤å•çº¯çš„ H5 æŠ€æœ¯èƒ½åšçš„äº‹éå¸¸æœ‰é™ï¼Œä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œé€šè¿‡ Hybrid æŠ€æœ¯æ¥å¼ºåŒ– H5 ï¼Œä¾¿æ˜¯ä¸€ç§å¿…éœ€ã€‚ å…¬å¸ä¸šåŠ¡ä¸Šï¼Œå¹¶æ²¡æœ‰éå¸¸å¤æ‚çš„ UI æ¸²æŸ“éœ€æ±‚ï¼Œè€Œä¸” App ä¸­çš„ä¸€ç³»åˆ—åŸç”Ÿ UI ç»„ä»¶ å·²ç»éå¸¸æˆç†Ÿï¼Œå› æ­¤æˆ‘ä»¬å¹¶ä¸å¼ºéœ€ç±»ä¼¼ RN è¿™æ ·çš„æ–¹æ¡ˆã€‚ å› æ­¤ï¼Œå¦‚ä½•æ—¢èƒ½åˆ©ç”¨ H5 å¼ºå¤§çš„å¼€å‘å’Œè¿­ä»£èƒ½åŠ›ï¼Œåˆèƒ½èµ‹äºˆ H5 å¼ºå¤§çš„åº•å±‚èƒ½åŠ›å’Œç”¨æˆ·ä½“éªŒï¼ŒåŒæ—¶èƒ½å¤ç”¨ç°æœ‰çš„æˆç†Ÿ Native ç»„ä»¶ï¼Œä¾¿æˆä¸ºäº†æˆ‘ä»¬æœ€å¤§çš„éœ€æ±‚ç‚¹ â€“ ä¸€å¥—å®Œæ•´åˆå¼ºå¤§çš„ Hybrid æŠ€æœ¯æ¶æ„æ–¹æ¡ˆã€‚ å››ã€Hybrid æŠ€æœ¯åŸç†Hybrid App çš„æœ¬è´¨ï¼Œå…¶å®æ˜¯åœ¨åŸç”Ÿçš„ App ä¸­ï¼Œä½¿ç”¨ WebView ä½œä¸ºå®¹å™¨ç›´æ¥æ‰¿è½½ Web é¡µé¢ã€‚å› æ­¤ï¼Œæœ€æ ¸å¿ƒçš„ç‚¹å°±æ˜¯ Native ç«¯ä¸ H5 ç«¯ä¹‹é—´çš„åŒå‘é€šè®¯å±‚ï¼Œå…¶å®è¿™é‡Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæˆ‘ä»¬éœ€è¦ä¸€å¥—è·¨è¯­è¨€é€šè®¯æ–¹æ¡ˆï¼Œæ¥å®Œæˆ Native(Java&#x2F;Objective-c&#x2F;â€¦) ä¸ JavaScript çš„é€šè®¯ã€‚è¿™ä¸ªæ–¹æ¡ˆå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ JSBridgeï¼Œè€Œå®ç°çš„å…³é”®ä¾¿æ˜¯ä½œä¸ºå®¹å™¨çš„ WebViewï¼Œä¸€åˆ‡çš„åŸç†éƒ½æ˜¯åŸºäº WebView çš„æœºåˆ¶ã€‚ 4.1 JavaScript é€šçŸ¥ NativeåŸºäº WebView çš„æœºåˆ¶å’Œå¼€æ”¾çš„ API , å®ç°è¿™ä¸ªåŠŸèƒ½æœ‰ä¸‰ç§å¸¸è§çš„æ–¹æ¡ˆï¼š API æ³¨å…¥ï¼ŒåŸç†å…¶å®å°±æ˜¯ Native è·å– JavaScript ç¯å¢ƒä¸Šä¸‹æ–‡ï¼Œå¹¶ç›´æ¥åœ¨ä¸Šé¢æŒ‚è½½å¯¹è±¡æˆ–è€…æ–¹æ³•ï¼Œä½¿ js å¯ä»¥ç›´æ¥è°ƒç”¨ï¼ŒAndroid ä¸ IOS åˆ†åˆ«æ‹¥æœ‰å¯¹åº”çš„æŒ‚è½½æ–¹å¼ã€‚ WebView ä¸­çš„ prompt&#x2F;console&#x2F;alert æ‹¦æˆªï¼Œé€šå¸¸ä½¿ç”¨ prompt ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•åœ¨å‰ç«¯ä¸­ä½¿ç”¨é¢‘ç‡ä½ï¼Œæ¯”è¾ƒä¸ä¼šå‡ºç°å†²çªï¼› WebView URL Scheme è·³è½¬æ‹¦æˆªï¼› ç¬¬äºŒä¸‰ç§æœºåˆ¶çš„åŸç†æ˜¯ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯é€šè¿‡å¯¹ WebView ä¿¡æ¯å†’æ³¡ä¼ é€’çš„æ‹¦æˆªï¼Œä»è€Œè¾¾åˆ°é€šè®¯çš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¸»è¦ä» åŸç†-å®šåˆ¶åè®®-æ‹¦æˆªåè®®-å‚æ•°ä¼ é€’-å›è°ƒæœºåˆ¶ 5 ä¸ªæ–¹é¢è¯¦ç»†é˜è¿°ä¸‹ç¬¬ä¸‰ç§æ–¹æ¡ˆ â€“ URL æ‹¦æˆªæ–¹æ¡ˆã€‚ 4.1.1 å®ç°åŸç†åœ¨ WebView ä¸­å‘å‡ºçš„ç½‘ç»œè¯·æ±‚ï¼Œå®¢æˆ·ç«¯éƒ½èƒ½è¿›è¡Œç›‘å¬å’Œæ•è· 4.1.2 åè®®çš„å®šåˆ¶æˆ‘ä»¬éœ€è¦åˆ¶å®šä¸€å¥— URL Scheme è§„åˆ™ï¼Œé€šå¸¸æˆ‘ä»¬çš„è¯·æ±‚ä¼šå¸¦æœ‰å¯¹åº”çš„åè®®å¼€å¤´ï¼Œä¾‹å¦‚å¸¸è§çš„ https://xxx.com æˆ–è€… file:&#x2F;&#x2F;1.jpg ï¼Œä»£è¡¨ç€ä¸åŒçš„å«ä¹‰ã€‚æˆ‘ä»¬è¿™é‡Œå¯ä»¥å°†åè®®ç±»å‹çš„è¯·æ±‚å®šåˆ¶ä¸º: xxcommand:&#x2F;&#x2F;xxxx?param1&#x3D;1&amp;param2&#x3D;2 è¿™é‡Œæœ‰å‡ ä¸ªéœ€è¦æ³¨æ„ç‚¹çš„æ˜¯: (1) xxcommand:&#x2F;&#x2F; åªæ˜¯ä¸€ç§è§„åˆ™ï¼Œå¯ä»¥æ ¹æ®ä¸šåŠ¡è¿›è¡Œåˆ¶å®šï¼Œä½¿å…¶å…·æœ‰å«ä¹‰ï¼Œä¾‹å¦‚æˆ‘ä»¬å®šä¹‰ xxcommand:&#x2F;&#x2F; ä¸ºå…¬å¸æ‰€æœ‰ App ç³»é€šç”¨ï¼Œä¸ºé€šç”¨å·¥å…·åè®®ï¼š xxcommand:&#x2F;&#x2F;getProxy?h&#x3D;1 è€Œå®šä¹‰ xxapp:&#x2F;&#x2F; ä¸ºæ¯ä¸ª App å•ç‹¬çš„ä¸šåŠ¡åè®®ã€‚ xxapp:&#x2F;&#x2F;openCamera?h&#x3D;2 ä¸åŒçš„åè®®å¤´ä»£è¡¨ç€ä¸åŒçš„å«ä¹‰ï¼Œè¿™æ ·ä¾¿èƒ½æ¸…æ¥šçŸ¥é“æ¯ä¸ªåè®®çš„é€‚ç”¨èŒƒå›´ã€‚ (2) è¿™é‡Œä¸è¦ä½¿ç”¨ location.href å‘é€ï¼Œå› ä¸ºå…¶è‡ªèº«æœºåˆ¶æœ‰ä¸ªé—®é¢˜æ˜¯åŒæ—¶å¹¶å‘å¤šæ¬¡è¯·æ±‚ä¼šè¢«åˆå¹¶æˆä¸ºä¸€æ¬¡ï¼Œå¯¼è‡´åè®®è¢«å¿½ç•¥ï¼Œè€Œå¹¶å‘åè®®å…¶å®æ˜¯éå¸¸å¸¸è§çš„åŠŸèƒ½ã€‚æˆ‘ä»¬ä¼šä½¿ç”¨åˆ›å»º iframe å‘é€è¯·æ±‚çš„æ–¹å¼ã€‚ (3) é€šå¸¸è€ƒè™‘åˆ°å®‰å…¨æ€§ï¼Œéœ€è¦åœ¨å®¢æˆ·ç«¯ä¸­è®¾ç½®åŸŸåç™½åå•æˆ–è€…é™åˆ¶ï¼Œé¿å…å…¬å¸å†…éƒ¨ä¸šåŠ¡åè®®è¢«ç¬¬ä¸‰æ–¹ç›´æ¥è°ƒç”¨ã€‚ 4.1.3 åè®®çš„æ‹¦æˆªå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ API å¯¹ WebView å‘å‡ºçš„è¯·æ±‚è¿›è¡Œæ‹¦æˆªï¼š IOS ä¸Š: shouldStartLoadWithRequest Android: shouldOverrideUrlLoading å½“è§£æåˆ°è¯·æ±‚ URL å¤´ä¸ºåˆ¶å®šçš„åè®®æ—¶ï¼Œä¾¿ä¸å‘èµ·å¯¹åº”çš„èµ„æºè¯·æ±‚ï¼Œè€Œæ˜¯è§£æå‚æ•°ï¼Œå¹¶è¿›è¡Œç›¸å…³åŠŸèƒ½æˆ–è€…æ–¹æ³•çš„è°ƒç”¨ï¼Œå®Œæˆåè®®åŠŸèƒ½çš„æ˜ å°„ã€‚ 4.1.4 åè®®å›è°ƒç”±äºåè®®çš„æœ¬è´¨å…¶å®æ˜¯å‘é€è¯·æ±‚ï¼Œè¿™å±äºä¸€ä¸ªå¼‚æ­¥çš„è¿‡ç¨‹ï¼Œå› æ­¤æˆ‘ä»¬ä¾¿éœ€è¦å¤„ç†å¯¹åº”çš„å›è°ƒæœºåˆ¶ã€‚è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨çš„æ–¹å¼æ˜¯ JS çš„äº‹ä»¶ç³»ç»Ÿï¼Œè¿™é‡Œæˆ‘ä»¬ä¼šç”¨åˆ° window.addEventListener å’Œ window.dispatchEvent è¿™ä¸¤ä¸ªåŸºç¡€ APIï¼› 1.å‘é€åè®®æ—¶ï¼Œé€šè¿‡åè®®çš„å”¯ä¸€æ ‡è¯†æ³¨å†Œè‡ªå®šä¹‰äº‹ä»¶ï¼Œå¹¶å°†å›è°ƒç»‘å®šåˆ°å¯¹åº”çš„äº‹ä»¶ä¸Šã€‚ 2.å®¢æˆ·ç«¯å®Œæˆå¯¹åº”çš„åŠŸèƒ½åï¼Œè°ƒç”¨ Bridge çš„ dispatch API ï¼Œç›´æ¥æºå¸¦ data è§¦å‘è¯¥åè®®çš„è‡ªå®šä¹‰äº‹ä»¶ã€‚ é€šè¿‡äº‹ä»¶çš„æœºåˆ¶ï¼Œä¼šè®©å¼€å‘æ›´ç¬¦åˆæˆ‘ä»¬å‰ç«¯çš„ä¹ æƒ¯ï¼Œä¾‹å¦‚å½“ä½ éœ€è¦ç›‘å¬å®¢æˆ·ç«¯çš„é€šçŸ¥æ—¶ï¼ŒåŒæ ·åªéœ€è¦åœ¨é€šè¿‡ addEventListener è¿›è¡Œç›‘å¬å³å¯ã€‚ Tips: è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåº”è¯¥é¿å…äº‹ä»¶çš„å¤šæ¬¡é‡å¤ç»‘å®šï¼Œå› æ­¤å½“å”¯ä¸€æ ‡è¯†é‡ç½®æ—¶ï¼Œéœ€è¦ removeEventListener å¯¹åº”çš„äº‹ä»¶ã€‚ 4.1.5 å‚æ•°ä¼ é€’æ–¹å¼ç”±äº WebView å¯¹ URL ä¼šæœ‰é•¿åº¦çš„é™åˆ¶ï¼Œå› æ­¤å¸¸è§„çš„é€šè¿‡ search å‚æ•° è¿›è¡Œä¼ é€’çš„æ–¹å¼ä¾¿å…·æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ—¢ å½“éœ€è¦ä¼ é€’çš„å‚æ•°è¿‡é•¿æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¢«æˆªæ–­ï¼Œä¾‹å¦‚ä¼ é€’ base64 æˆ–è€…ä¼ é€’å¤§é‡æ•°æ®æ—¶ã€‚ å› æ­¤æˆ‘ä»¬éœ€è¦åˆ¶å®šæ–°çš„å‚æ•°ä¼ é€’è§„åˆ™ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å‡½æ•°è°ƒç”¨çš„æ–¹å¼ã€‚è¿™é‡Œçš„åŸç†ä¸»è¦æ˜¯åŸºäº:Native å¯ä»¥ç›´æ¥è°ƒç”¨ JS æ–¹æ³•å¹¶ç›´æ¥è·å–å‡½æ•°çš„è¿”å›å€¼ã€‚ æˆ‘ä»¬åªéœ€è¦å¯¹æ¯æ¡åè®®æ ‡è®°ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œå¹¶æŠŠå‚æ•°å­˜å…¥å‚æ•°æ± ä¸­ï¼Œåˆ°æ—¶å®¢æˆ·ç«¯å†é€šè¿‡è¯¥å”¯ä¸€æ ‡è¯†ä»å‚æ•°æ± ä¸­è·å–å¯¹åº”çš„å‚æ•°å³å¯ã€‚ 4.2 Native é€šçŸ¥ Javascriptç”±äº Native å¯ä»¥ç®—ä½œ H5 çš„å®¿ä¸»ï¼Œå› æ­¤æ‹¥æœ‰æ›´å¤§çš„æƒé™ï¼Œä¸Šé¢ä¹Ÿæåˆ°äº† Native å¯ä»¥é€šè¿‡ WebView API ç›´æ¥æ‰§è¡Œ Js ä»£ç ã€‚è¿™æ ·çš„æƒé™ä¹Ÿå°±è®©è¿™ä¸ªæ–¹å‘çš„é€šè®¯å˜å¾—ååˆ†çš„ä¾¿æ·ã€‚ IOS: stringByEvaluatingJavaScriptFromString Android: loadUrl (4.4-) Tips: å½“ç³»ç»Ÿä½äº 4.4 æ—¶ï¼ŒevaluateJavascript æ˜¯æ— æ³•ä½¿ç”¨çš„ï¼Œå› æ­¤å•çº¯çš„ä½¿ç”¨ loadUrl æ— æ³•è·å– JS è¿”å›å€¼ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦ä½¿ç”¨å‰é¢æåˆ°çš„ prompt çš„æ–¹æ³•è¿›è¡Œå…¼å®¹ï¼Œè®© H5 ç«¯ é€šè¿‡ prompt è¿›è¡Œæ•°æ®çš„å‘é€ï¼Œå®¢æˆ·ç«¯è¿›è¡Œæ‹¦æˆªå¹¶è·å–æ•°æ®ã€‚ Android: evaluateJavascript (4.4+) åŸºäºä¸Šé¢çš„åŸç†ï¼Œæˆ‘ä»¬å·²ç»æ˜ç™½ JSBridge æœ€åŸºç¡€çš„åŸç†ï¼Œå¹¶ä¸”èƒ½å®ç° Native &lt;&#x3D;&gt; H5 çš„åŒå‘é€šè®¯æœºåˆ¶äº†ã€‚ 4.3 JSBridge çš„æ¥å…¥æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥ç†ä¸‹ä»£ç ä¸Šéœ€è¦çš„èµ„æºã€‚å®ç°è¿™å¥—æ–¹æ¡ˆï¼Œä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œå…¶å®å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†: JS éƒ¨åˆ†(bridge): åœ¨ JS ç¯å¢ƒä¸­æ³¨å…¥ bridge çš„å®ç°ä»£ç ï¼ŒåŒ…å«äº†åè®®çš„æ‹¼è£…&#x2F;å‘é€&#x2F;å‚æ•°æ± &#x2F;å›è°ƒæ± ç­‰ä¸€äº›åŸºç¡€åŠŸèƒ½ã€‚ Native éƒ¨åˆ†(SDK): åœ¨å®¢æˆ·ç«¯ä¸­ bridge çš„åŠŸèƒ½æ˜ å°„ä»£ç ï¼Œå®ç°äº† URL æ‹¦æˆªä¸è§£æ&#x2F;ç¯å¢ƒä¿¡æ¯çš„æ³¨å…¥&#x2F;é€šç”¨åŠŸèƒ½æ˜ å°„ç­‰åŠŸèƒ½ã€‚ æˆ‘ä»¬è¿™é‡Œçš„åšæ³•æ˜¯ï¼Œå°†è¿™ä¸¤éƒ¨åˆ†ä¸€èµ·å°è£…æˆä¸€ä¸ª Native SDKï¼Œç”±å®¢æˆ·ç«¯ç»Ÿä¸€å¼•å…¥ã€‚å®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–ä¸€ä¸ª WebView æ‰“å¼€é¡µé¢æ—¶ï¼Œå¦‚æœé¡µé¢åœ°å€åœ¨ç™½åå•ä¸­ï¼Œä¼šç›´æ¥åœ¨ HTML çš„å¤´éƒ¨æ³¨å…¥å¯¹åº”çš„ bridge.jsã€‚è¿™æ ·çš„åšæ³•æœ‰ä»¥ä¸‹çš„å¥½å¤„ï¼š åŒæ–¹çš„ä»£ç ç»Ÿä¸€ç»´æŠ¤ï¼Œé¿å…å‡ºç°ç‰ˆæœ¬åˆ†è£‚çš„æƒ…å†µã€‚æœ‰æ›´æ–°æ—¶ï¼Œåªè¦ç”±å®¢æˆ·ç«¯æ›´æ–° SDK å³å¯ï¼Œä¸ä¼šå‡ºç°ç‰ˆæœ¬å…¼å®¹çš„é—®é¢˜ï¼› App çš„æ¥å…¥ååˆ†æ–¹ä¾¿ï¼Œåªéœ€è¦æŒ‰æ–‡æ¡£æ¥å…¥æœ€æ–°ç‰ˆæœ¬çš„ SDK ï¼Œå³å¯ç›´æ¥è¿è¡Œæ•´å¥— Hybrid æ–¹æ¡ˆï¼Œä¾¿äºåœ¨å¤šä¸ª App ä¸­å¿«é€Ÿçš„è½åœ°ï¼› H5 ç«¯æ— éœ€å…³æ³¨ï¼Œè¿™æ ·æœ‰åˆ©äºå°† bridge å¼€æ”¾ç»™ç¬¬ä¸‰æ–¹é¡µé¢ä½¿ç”¨ã€‚ è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåè®®çš„è°ƒç”¨ï¼Œä¸€å®šæ˜¯éœ€è¦ç¡®ä¿æ‰§è¡Œåœ¨ bridge.js æˆåŠŸæ³¨å…¥åã€‚ç”±äºå®¢æˆ·ç«¯çš„æ³¨å…¥è¡Œä¸ºå±äºä¸€ä¸ªé™„åŠ çš„å¼‚æ­¥è¡Œä¸ºï¼Œä» H5 æ–¹å¾ˆéš¾å»æ•æ‰å‡†ç¡®çš„å®Œæˆæ—¶æœºï¼Œå› æ­¤è¿™é‡Œéœ€è¦é€šè¿‡å®¢æˆ·ç«¯ç›‘å¬é¡µé¢å®Œæˆåï¼ŒåŸºäºä¸Šé¢çš„äº‹ä»¶å›è°ƒæœºåˆ¶é€šçŸ¥ H5 ç«¯ï¼Œé¡µé¢ä¸­å³å¯é€šè¿‡ window.addEventListener(â€˜bridgeReadyâ€™, e &#x3D;&gt; {})è¿›è¡Œåˆå§‹åŒ–ã€‚ 4.4 App ä¸­ H5 çš„æ¥å…¥æ–¹å¼å°† H5 æ¥å…¥ App ä¸­é€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼šåœ¨çº¿ H5 å’Œå†…ç½®åŒ… H5ã€‚ (1) åœ¨çº¿ H5ï¼Œè¿™æ˜¯æœ€å¸¸è§çš„ä¸€ç§æ–¹å¼ã€‚æˆ‘ä»¬åªéœ€è¦å°† H5 ä»£ç éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šï¼Œåªè¦æŠŠå¯¹åº”çš„ URL åœ°å€ ç»™åˆ°å®¢æˆ·ç«¯ï¼Œç”¨ WebView æ‰“å¼€è¯¥ URLï¼Œå³å¯åµŒå…¥ã€‚è¯¥æ–¹å¼çš„å¥½å¤„åœ¨äº: ç‹¬ç«‹æ€§å¼ºï¼Œæœ‰éå¸¸ç‹¬ç«‹çš„å¼€å‘&#x2F;è°ƒè¯•&#x2F;æ›´æ–°&#x2F;ä¸Šçº¿èƒ½åŠ›ï¼› èµ„æºæ”¾åœ¨æœåŠ¡å™¨ä¸Šï¼Œå®Œå…¨ä¸ä¼šå½±å“å®¢æˆ·ç«¯çš„åŒ…ä½“ç§¯ï¼› æ¥å…¥æˆæœ¬å¾ˆä½ï¼Œå®Œå…¨çš„çƒ­æ›´æ–°æœºåˆ¶ã€‚ ä½†ç›¸å¯¹çš„ï¼Œè¿™ç§æ–¹å¼ä¹Ÿæœ‰å¯¹åº”çš„ç¼ºç‚¹: å®Œå…¨çš„ç½‘ç»œä¾èµ–ï¼Œåœ¨ç¦»çº¿çš„æƒ…å†µä¸‹æ— æ³•æ‰“å¼€é¡µé¢ï¼› é¦–å±åŠ è½½é€Ÿåº¦ä¾èµ–äºç½‘ç»œï¼Œç½‘ç»œè¾ƒæ…¢æ—¶ï¼Œé¦–å±åŠ è½½ä¹Ÿè¾ƒæ…¢ï¼› é€šå¸¸ï¼Œè¿™ç§æ–¹å¼æ›´é€‚ç”¨åœ¨ä¸€äº›æ¯”è¾ƒè½»é‡çº§çš„é¡µé¢ä¸Šï¼Œä¾‹å¦‚ä¸€äº›å¸®åŠ©é¡µã€æç¤ºé¡µã€ä½¿ç”¨æ”»ç•¥ç­‰é¡µé¢ã€‚è¿™äº›é¡µé¢çš„ç‰¹ç‚¹æ˜¯åŠŸèƒ½æ€§ä¸å¼ºï¼Œä¸å¤ªéœ€è¦å¤æ‚çš„åŠŸèƒ½åè®®ï¼Œä¸”ä¸éœ€è¦ç¦»çº¿ä½¿ç”¨ã€‚åœ¨ä¸€äº›ç¬¬ä¸‰æ–¹é¡µé¢æ¥å…¥ä¸Šï¼Œä¹Ÿä¼šä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œä¾‹å¦‚æˆ‘ä»¬çš„é¡µé¢è°ƒç”¨å¾®ä¿¡ JS-SDK ã€‚ (2) å†…ç½®åŒ… H5ï¼Œè¿™æ˜¯ä¸€ç§æœ¬åœ°åŒ–çš„åµŒå…¥æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦å°†ä»£ç è¿›è¡Œæ‰“åŒ…åä¸‹å‘åˆ°å®¢æˆ·ç«¯ï¼Œå¹¶ç”±å®¢æˆ·ç«¯ç›´æ¥è§£å‹åˆ°æœ¬åœ°å‚¨å­˜ä¸­ã€‚é€šå¸¸æˆ‘ä»¬è¿ç”¨åœ¨ä¸€äº›æ¯”è¾ƒå¤§å’Œæ¯”è¾ƒé‡è¦çš„æ¨¡å—ä¸Šã€‚å…¶ä¼˜ç‚¹æ˜¯: ç”±äºå…¶æœ¬åœ°åŒ–ï¼Œé¦–å±åŠ è½½é€Ÿåº¦å¿«ï¼Œç”¨æˆ·ä½“éªŒæ›´ä¸ºæ¥è¿‘åŸç”Ÿï¼› å¯ä»¥ä¸ä¾èµ–ç½‘ç»œï¼Œç¦»çº¿è¿è¡Œï¼› ä½†åŒæ—¶ï¼Œå®ƒçš„åŠ£åŠ¿ä¹Ÿååˆ†æ˜æ˜¾: å¼€å‘æµç¨‹&#x2F;æ›´æ–°æœºåˆ¶å¤æ‚åŒ–ï¼Œéœ€è¦å®¢æˆ·ç«¯ï¼Œç”šè‡³æœåŠ¡ç«¯çš„å…±åŒåä½œï¼› ä¼šç›¸åº”çš„å¢åŠ  App åŒ…ä½“ç§¯ï¼› è¿™ä¸¤ç§æ¥å…¥æ–¹å¼å‡æœ‰è‡ªå·±çš„ä¼˜ç¼ºç‚¹ï¼Œåº”è¯¥æ ¹æ®ä¸åŒåœºæ™¯è¿›è¡Œé€‰æ‹©ã€‚ äº”ã€æ€»ç»“æœ¬æ–‡ä¸»è¦è§£æäº†ç°åœ¨ Hybrid App çš„å‘å±•ç°çŠ¶å’Œå…¶åŸºç¡€åŸç†ï¼ŒåŒ…å«äº† JavaScript é€šçŸ¥ Native Native é€šçŸ¥ Javascript JSBridge çš„æ¥å…¥ H5 çš„æ¥å…¥ åªæœ‰åœ¨äº†è§£äº†å…¶æœ€æœ¬è´¨çš„å®ç°åŸç†åï¼Œæ‰èƒ½å¯¹è¿™å¥—æ–¹æ¡ˆè¿›è¡Œå®ç°ä»¥åŠè¿›ä¸€æ­¥çš„ä¼˜åŒ–ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åŸºäºä¸Šé¢çš„ç†è®ºï¼Œç»§ç»­æ¢è®¨å¦‚ä½•æŠŠè¿™å¥—æ–¹æ¡ˆçš„çœŸæ­£ä»£ç å®ç°ä»¥åŠæ–¹æ¡ˆä¼˜åŒ–æ–¹æ¡ˆï¼Œæ¬¢è¿å¤§å®¶ä¸€èµ·è®¨è®ºï¼","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"webview","slug":"webview","permalink":"http://example.com/tags/webview/"},{"name":"hybrid","slug":"hybrid","permalink":"http://example.com/tags/hybrid/"}]},{"title":"Android å®ç°æ°´å°èƒŒæ™¯æ•ˆæœ[è½¬]","slug":"Android å®ç°æ°´å°èƒŒæ™¯æ•ˆæœ","date":"2022-03-14T20:23:47.000Z","updated":"2022-05-13T00:19:38.000Z","comments":true,"path":"2022/03/15/Android å®ç°æ°´å°èƒŒæ™¯æ•ˆæœ/","link":"","permalink":"http://example.com/2022/03/15/Android%20%E5%AE%9E%E7%8E%B0%E6%B0%B4%E5%8D%B0%E8%83%8C%E6%99%AF%E6%95%88%E6%9E%9C/","excerpt":"","text":"[è½¬]Android å®ç°æ°´å°èƒŒæ™¯æ•ˆæœé¡¹ç›®ä¸­æœ‰éœ€è¦åŠ æ°´å°çš„éœ€æ±‚ï¼Œå®ç°å®Œæ•ˆæœå›¾æ˜¯è¿™æ ·çš„ ä»€ä¹ˆçœ‹ä¸æ¸…â€¦ ä¸ºäº†è®©å¤§å®¶çœ‹æ¸…æ•ˆæœï¼Œå­—ä½“æ”¹äº†ä¸€ä¸‹ï¼Œæ­£å¸¸åº”è¯¥æ˜¯æ–‡ç« æœ€ä¸Šé¢é‚£ä¸ªçš„æ•ˆæœã€‚è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332import android.annotation.SuppressLint;import android.content.Context;import android.content.res.TypedArray;import android.graphics.Canvas;import android.graphics.Color;import android.graphics.Paint;import android.graphics.Rect;import android.graphics.Typeface;import android.text.TextPaint;import android.util.AttributeSet;import android.view.MotionEvent;import android.view.View; import com.hkdc.commonlib.R; public class WaterMarkView extends View &#123; private static final String DEFAULT_SEPARATOR = &quot;///&quot;; private TextPaint mTextPaint = new TextPaint(); private String[] mText; private int mDegrees; private int mTextColor; private int mTextSize=35; private boolean mTextBold; private int mDx; private int mDy; private Paint.Align mAlign; private boolean mSync; private int textWidth, textHeight; public WaterMarkView(Context context) &#123; this(context, null); &#125; public WaterMarkView(Context context, AttributeSet attrs) &#123; super(context, attrs); TypedArray typedArray = context.obtainStyledAttributes(attrs, R.styleable.WaterMarkView); mDegrees = typedArray.getInt(R.styleable.WaterMarkView_water_mark_degree, WaterMarkManager.INFO != null ? WaterMarkManager.INFO.getDegrees() : -30); String text = typedArray.getString(R.styleable.WaterMarkView_water_mark_text); if (text != null) &#123; mText = text.split(DEFAULT_SEPARATOR); &#125; mTextColor = typedArray.getColor(R.styleable.WaterMarkView_water_mark_textColor, WaterMarkManager.INFO != null ? WaterMarkManager.INFO.getTextColor() : Color.parseColor(&quot;#33000000&quot;)); mTextSize = typedArray.getDimensionPixelSize(R.styleable.WaterMarkView_water_mark_textSize, WaterMarkManager.INFO != null ? WaterMarkManager.INFO.getTextSize() : 42); mTextBold = typedArray.getBoolean(R.styleable.WaterMarkView_water_mark_textBold, WaterMarkManager.INFO != null &amp;&amp; WaterMarkManager.INFO.isTextBold()); mDx = typedArray.getDimensionPixelSize(R.styleable.WaterMarkView_water_mark_dx, WaterMarkManager.INFO != null ? WaterMarkManager.INFO.getDx() : 100); mDy = typedArray.getDimensionPixelSize(R.styleable.WaterMarkView_water_mark_dy, WaterMarkManager.INFO != null ? WaterMarkManager.INFO.getDy() : 240); int align = typedArray.getInt(R.styleable.WaterMarkView_water_mark_align, WaterMarkManager.INFO != null ? WaterMarkManager.INFO.getAlignInt() : 1); mAlign = align == 0 ? Paint.Align.LEFT : align == 2 ? Paint.Align.RIGHT : Paint.Align.CENTER; mSync = typedArray.getBoolean(R.styleable.WaterMarkView_water_mark_sync, true); typedArray.recycle(); setBackgroundColor(Color.TRANSPARENT); mTextPaint.setAntiAlias(true); mTextPaint.setFlags(Paint.ANTI_ALIAS_FLAG); mTextPaint.setColor(mTextColor); mTextPaint.setTextSize(mTextSize); mTextPaint.setTypeface(mTextBold ? Typeface.DEFAULT_BOLD : Typeface.DEFAULT); mTextPaint.setTextAlign(mAlign); mText = mText == null &amp;&amp; mSync ? WaterMarkManager.CONTENT : mText; textWidth = 0; textHeight = 0; if (mText != null &amp;&amp; mText.length &gt; 0) &#123; for (String s : mText) &#123; Rect tvRect = new Rect(); mTextPaint.getTextBounds(s, 0, s.length(), tvRect); textWidth = textWidth &gt; tvRect.width() ? textWidth : tvRect.width(); textHeight += (tvRect.height() + 10); &#125; &#125; if (mSync) &#123; WaterMarkManager.LIST.add(this); &#125; &#125; @Override protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123; super.onMeasure(widthMeasureSpec, heightMeasureSpec); &#125; @Override protected void onDraw(Canvas canvas) &#123; super.onDraw(canvas); if (mText != null &amp;&amp; mText.length &gt; 0) &#123; int measuredWidth = getMeasuredWidth(); int measuredHeight = getMeasuredHeight(); if (measuredWidth == 0 || measuredHeight == 0) &#123; return; &#125; int canvasLength = measuredWidth &gt; measuredHeight ? measuredWidth : measuredHeight; canvas.save(); canvas.rotate(mDegrees, measuredWidth / 2, measuredHeight / 2); canvas.save(); int y = 0; boolean odd = true; while (y &lt; canvasLength + textHeight) &#123; int x = odd ? 0 : -(textWidth + mDx) / 2; while (x &lt; canvasLength + textWidth) &#123; drawTexts(mText, mTextPaint, canvas, x, y); x = x + textWidth + mDx; &#125; y = y + textHeight + mDy; odd = !odd; &#125; canvas.restore(); &#125; &#125; private void drawTexts(String[] ss, Paint paint, Canvas canvas, int x, int y) &#123; Paint.FontMetrics fontMetrics = paint.getFontMetrics(); float top = fontMetrics.top; float bottom = fontMetrics.bottom; int length = ss.length; float total = (length - 1) * (bottom - top) + (fontMetrics.descent - fontMetrics.ascent); float offset = total / 2 - bottom; for (int i = 0; i &lt; length; i++) &#123; float yAxis = -(length - i - 1) * (bottom - top) + offset; canvas.drawText(ss[i], x, y + yAxis + 10, paint); &#125; &#125; /** * è®¾ç½®æ°´å°æ–‡å­—å†…å®¹ * * @param text æ–‡å­—å†…å®¹ */ public void setText(String... text) &#123; mText = text; textWidth = 0; textHeight = 0; if (mText != null &amp;&amp; mText.length &gt; 0) &#123; for (String s : mText) &#123; Rect tvRect = new Rect(); mTextPaint.getTextBounds(s, 0, s.length(), tvRect); textWidth = textWidth &gt; tvRect.width() ? textWidth : tvRect.width(); textHeight += (tvRect.height() + 10); &#125; &#125; postInvalidate(); &#125; /** * åŒæ­¥è®¾ç½®æ°´å°æ–‡å­—å†…å®¹ * * @param text æ–‡å­—å†…å®¹ */ void setSyncText(String... text) &#123; if (mSync) &#123; setText(text); &#125; &#125; /** * è®¾ç½®æ°´å°å€¾æ–œè§’åº¦ * * @param degrees å€¾æ–œè§’åº¦(é»˜è®¤:-30) */ public void setDegrees(int degrees) &#123; mDegrees = degrees; postInvalidate(); &#125; /** * åŒæ­¥è®¾ç½®æ°´å°å€¾æ–œè§’åº¦ * * @param degrees å€¾æ–œè§’åº¦(é»˜è®¤:-30) */ void setSyncDegrees(int degrees) &#123; if (mSync) &#123; setDegrees(degrees); &#125; &#125; /** * è®¾ç½®æ°´å°å­—ä½“é¢œè‰² * * @param textColor å­—ä½“é¢œè‰²(é»˜è®¤:#33000000) */ public void setTextColor(int textColor) &#123; mTextColor = textColor; mTextPaint.setColor(mTextColor); postInvalidate(); &#125; /** * åŒæ­¥è®¾ç½®æ°´å°å­—ä½“é¢œè‰² * * @param textColor å­—ä½“é¢œè‰²(é»˜è®¤:#33000000) */ void setSyncTextColor(int textColor) &#123; if (mSync) &#123; setTextColor(textColor); &#125; &#125; /** * è®¾ç½®æ°´å°å­—ä½“å¤§å°ï¼ˆå•ä½ï¼špxï¼‰ * * @param textSize å­—ä½“å¤§å°(é»˜è®¤:42px) */ public void setTextSize(int textSize) &#123; mTextSize = textSize; mTextPaint.setTextSize(30); postInvalidate(); &#125; /** * åŒæ­¥è®¾ç½®æ°´å°å­—ä½“å¤§å°ï¼ˆå•ä½ï¼špxï¼‰ * * @param textSize å­—ä½“å¤§å°(é»˜è®¤:42px) */ void setSyncTextSize(int textSize) &#123; if (mSync) &#123; setTextSize(30); &#125; &#125; /** * è®¾ç½®æ°´å°å­—ä½“æ˜¯å¦ç²—ä½“ * * @param textBold æ˜¯å¦ç²—ä½“(é»˜è®¤:false) */ public void setTextBold(boolean textBold) &#123; mTextBold = textBold; mTextPaint.setTypeface(mTextBold ? Typeface.DEFAULT_BOLD : Typeface.DEFAULT); postInvalidate(); &#125; /** * åŒæ­¥è®¾ç½®æ°´å°å­—ä½“æ˜¯å¦ç²—ä½“ * * @param textBold æ˜¯å¦ç²—ä½“(é»˜è®¤:false) */ void setSyncTextBold(boolean textBold) &#123; if (mSync) &#123; setTextBold(textBold); &#125; &#125; /** * è®¾ç½®æ°´å°Xè½´åç§»é‡ï¼ˆå•ä½ï¼špxï¼‰ * * @param dx Xè½´åç§»é‡(é»˜è®¤:100px) */ public void setDx(int dx) &#123; this.mDx = dx; postInvalidate(); &#125; /** * åŒæ­¥è®¾ç½®æ°´å°Xè½´åç§»é‡ï¼ˆå•ä½ï¼špxï¼‰ * * @param dx Xè½´åç§»é‡(é»˜è®¤:100px) */ void setSyncDx(int dx) &#123; if (mSync) &#123; setDx(dx); &#125; &#125; /** * è®¾ç½®æ°´å°Yè½´åç§»é‡ï¼ˆå•ä½ï¼špxï¼‰ * * @param dy Yè½´åç§»é‡(é»˜è®¤:240px) */ public void setDy(int dy) &#123; this.mDy = dy; postInvalidate(); &#125; /** * åŒæ­¥è®¾ç½®æ°´å°Yè½´åç§»é‡ï¼ˆå•ä½ï¼špxï¼‰ * * @param dy Yè½´åç§»é‡(é»˜è®¤:240px) */ void setSignDy(int dy) &#123; if (mSync) &#123; setDy(dy); &#125; &#125; /** * è®¾ç½®æ°´å°å¯¹é½æ–¹å¼ * * @param align å¯¹é½æ–¹å¼(é»˜è®¤:Center) */ public void setAlign(Paint.Align align) &#123; this.mAlign = align; postInvalidate(); &#125; /** * åŒæ­¥è®¾ç½®æ°´å°å¯¹é½æ–¹å¼ * * @param align å¯¹é½æ–¹å¼(é»˜è®¤:Center) */ void setSignAlign(Paint.Align align) &#123; if (mSync) &#123; setAlign(align); &#125; &#125; /** * é”€æ¯ç›¸å…³é¡µé¢æ—¶è°ƒç”¨ï¼ˆåˆ‡è®°ï¼‰ */ public void onDestroy() &#123; if (mSync) &#123; WaterMarkManager.LIST.remove(this); &#125; &#125; @Override public boolean dispatchTouchEvent(MotionEvent event) &#123; return false; &#125; @SuppressLint(&quot;ClickableViewAccessibility&quot;) @Override public boolean onTouchEvent(MotionEvent event) &#123; return false; &#125;&#125; 123456789101112131415&lt;declare-styleable name=&quot;WaterMarkView&quot;&gt; &lt;attr name=&quot;water_mark_degree&quot; format=&quot;integer|reference&quot; /&gt; &lt;attr name=&quot;water_mark_text&quot; format=&quot;string|reference&quot; /&gt; &lt;attr name=&quot;water_mark_textColor&quot; format=&quot;color|reference&quot; /&gt; &lt;attr name=&quot;water_mark_textSize&quot; format=&quot;dimension|reference&quot; /&gt; &lt;attr name=&quot;water_mark_textBold&quot; format=&quot;boolean&quot; /&gt; &lt;attr name=&quot;water_mark_dx&quot; format=&quot;dimension|reference&quot; /&gt; &lt;attr name=&quot;water_mark_dy&quot; format=&quot;dimension|reference&quot; /&gt; &lt;attr name=&quot;water_mark_align&quot; format=&quot;dimension&quot;&gt; &lt;enum name=&quot;LEFT&quot; value=&quot;0&quot; /&gt; &lt;enum name=&quot;CENTER&quot; value=&quot;1&quot; /&gt; &lt;enum name=&quot;RIGHT&quot; value=&quot;2&quot; /&gt; &lt;/attr&gt; &lt;attr name=&quot;water_mark_sync&quot; format=&quot;boolean&quot; /&gt; &lt;/declare-styleable&gt; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187package com.hkdc.commonlib.warkmark; import android.annotation.SuppressLint;import android.app.Activity;import android.graphics.Paint;import android.view.LayoutInflater; import com.hkdc.commonlib.R; import java.util.ArrayList;import java.util.List; /** * @author Leon (wshk729@163.com) * @date 2018/8/24 * &lt;p&gt; */public class WaterMarkManager &#123; static WaterMarkInfo INFO = null; static String[] CONTENT = null; static List&lt;WaterMarkView&gt; LIST = new ArrayList&lt;&gt;(); /** * è®¾ç½®æ°´å°å…¨å±€é…ç½®ä¿¡æ¯ * * @param info é…ç½®ä¿¡æ¯ */ public static void setInfo(WaterMarkInfo info) &#123; INFO = info; &#125; /** * è·å–ä¸€ä¸ªæ»¡å±æ°´å°View * * @param activity activity */ @SuppressLint(&quot;InflateParams&quot;) public static WaterMarkView getView(Activity activity) &#123; return (WaterMarkView) LayoutInflater.from(activity).inflate(R.layout.view_water_mark, null); &#125; /** * WaterMarkInfoåˆå§‹åŒ–åˆ¤æ–­ */ private static void assertInitialized() &#123; if (INFO == null) &#123; INFO = WaterMarkInfo.create().generate(); &#125; &#125; /** * åŒæ­¥è®¾ç½®å…¨éƒ¨æ°´å°æ–‡å­—ä¿¡æ¯ * * @param content æ–‡å­—ä¿¡æ¯ */ public static void setText(String... content) &#123; assertInitialized(); CONTENT = content; if (LIST.size() &gt; 0) &#123; for (WaterMarkView view : LIST) &#123; if (view != null) &#123; view.setSyncText(content); &#125; &#125; &#125; &#125; /** * åŒæ­¥è®¾ç½®å…¨éƒ¨æ°´å°å€¾æ–œè§’åº¦ * * @param degrees å€¾æ–œè§’åº¦(é»˜è®¤:-30) */ public static void setDegrees(int degrees) &#123; assertInitialized(); INFO.setDegrees(degrees); if (LIST.size() &gt; 0) &#123; for (WaterMarkView view : LIST) &#123; if (view != null) &#123; view.setSyncDegrees(degrees); &#125; &#125; &#125; &#125; /** * åŒæ­¥è®¾ç½®å…¨éƒ¨æ°´å°å­—ä½“é¢œè‰² * * @param textColor å­—ä½“é¢œè‰²(é»˜è®¤:#33000000) */ public static void setTextColor(int textColor) &#123; assertInitialized(); INFO.setTextColor(textColor); if (LIST.size() &gt; 0) &#123; for (WaterMarkView view : LIST) &#123; if (view != null) &#123; view.setSyncTextColor(textColor); &#125; &#125; &#125; &#125; /** * åŒæ­¥è®¾ç½®å…¨éƒ¨æ°´å°å­—ä½“å¤§å°ï¼ˆå•ä½ï¼špxï¼‰ * * @param textSize å­—ä½“å¤§å°(é»˜è®¤:42px) */ public static void setTextSize(int textSize) &#123; assertInitialized(); INFO.setTextSize(textSize); if (LIST.size() &gt; 0) &#123; for (WaterMarkView view : LIST) &#123; if (view != null) &#123; view.setSyncTextSize(textSize); &#125; &#125; &#125; &#125; /** * åŒæ­¥è®¾ç½®å…¨éƒ¨æ°´å°å­—ä½“æ˜¯å¦ç²—ä½“ * * @param textBold æ˜¯å¦ç²—ä½“(é»˜è®¤:false) */ public static void setTextBold(boolean textBold) &#123; assertInitialized(); INFO.setTextBold(textBold); if (LIST.size() &gt; 0) &#123; for (WaterMarkView view : LIST) &#123; if (view != null) &#123; view.setSyncTextBold(textBold); &#125; &#125; &#125; &#125; /** * åŒæ­¥è®¾ç½®å…¨éƒ¨æ°´å°Xè½´åç§»é‡ï¼ˆå•ä½ï¼špxï¼‰ * * @param dx Xè½´åç§»é‡(é»˜è®¤:100px) */ public static void setDx(int dx) &#123; assertInitialized(); INFO.setDx(dx); if (LIST.size() &gt; 0) &#123; for (WaterMarkView view : LIST) &#123; if (view != null) &#123; view.setSyncDx(dx); &#125; &#125; &#125; &#125; /** * åŒæ­¥è®¾ç½®å…¨éƒ¨æ°´å°Yè½´åç§»é‡ï¼ˆå•ä½ï¼špxï¼‰ * * @param dy Yè½´åç§»é‡(é»˜è®¤:240px) */ public static void setDy(int dy) &#123; assertInitialized(); INFO.setDy(dy); if (LIST.size() &gt; 0) &#123; for (WaterMarkView view : LIST) &#123; if (view != null) &#123; view.setSignDy(dy); &#125; &#125; &#125; &#125; /** * åŒæ­¥è®¾ç½®å…¨éƒ¨æ°´å°å¯¹é½æ–¹å¼ * * @param align å¯¹é½æ–¹å¼(é»˜è®¤:Center) */ public static void setAlign(Paint.Align align) &#123; assertInitialized(); INFO.setAlign(align); if (LIST.size() &gt; 0) &#123; for (WaterMarkView view : LIST) &#123; if (view != null) &#123; view.setSignAlign(align); &#125; &#125; &#125; &#125;&#125; view_water_mark.xml 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;com.commonlib.WaterMarkView xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot;/&gt; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206import android.graphics.Color;import android.graphics.Paint; /** * @author Leon (wshk729@163.com) * @date 2018/8/24 * &lt;p&gt; */public class WaterMarkInfo &#123; private int mDegrees; private int mTextColor; private int mTextSize; private boolean mTextBold; private int mDx; private int mDy; private Paint.Align mAlign; private WaterMarkInfo(int degrees, int textColor, int textSize, boolean textBold, int dx, int dy, Paint.Align align) &#123; mDegrees = degrees; mTextColor = textColor; mTextSize = textSize; mTextBold = textBold; mDx = dx; mDy = dy; mAlign = align; &#125; public int getDegrees() &#123; return mDegrees; &#125; public int getTextColor() &#123; return mTextColor; &#125; public int getTextSize() &#123; return mTextSize; &#125; public int getDx() &#123; return mDx; &#125; public int getDy() &#123; return mDy; &#125; public Paint.Align getAlign() &#123; return mAlign; &#125; public int getAlignInt() &#123; switch (mAlign) &#123; case LEFT: return 0; case RIGHT: return 2; default: return 1; &#125; &#125; public boolean isTextBold() &#123; return mTextBold; &#125; void setDegrees(int degrees) &#123; mDegrees = degrees; &#125; void setTextColor(int textColor) &#123; mTextColor = textColor; &#125; void setTextSize(int textSize) &#123; mTextSize = textSize; &#125; void setTextBold(boolean textBold) &#123; mTextBold = textBold; &#125; void setDx(int dx) &#123; mDx = dx; &#125; void setDy(int dy) &#123; mDy = dy; &#125; void setAlign(Paint.Align align) &#123; this.mAlign = align; &#125; public static Builder create() &#123; return new Builder(); &#125; public static class Builder &#123; private int mDegrees; private int mTextColor; private int mTextSize; private boolean mTextBold; private int mDx; private int mDy; private Paint.Align mAlign; private Builder() &#123; mDegrees = -30; mTextColor = Color.parseColor(&quot;#33000000&quot;); mTextSize = 35; mTextBold = false; mDx = 100; mDy = 240; mAlign = Paint.Align.CENTER; &#125; /** * è®¾ç½®æ°´å°æ–‡å­—å€¾æ–œåº¦ * * @param degrees æ–‡å­—å€¾æ–œåº¦(é»˜è®¤:-30) * @return Builder */ public Builder setDegrees(int degrees) &#123; mDegrees = degrees; return this; &#125; /** * è®¾ç½®æ°´å°æ–‡å­—é¢œè‰² * * @param textColor æ–‡å­—é¢œè‰²(é»˜è®¤:#33000000) * @return Builder */ public Builder setTextColor(int textColor) &#123; mTextColor = textColor; return this; &#125; /** * è®¾ç½®æ°´å°æ–‡å­—å¤§å°ï¼ˆå•ä½ï¼špxï¼‰ * * @param textSize æ–‡å­—å¤§å°(é»˜è®¤:42px) * @return Builder */ public Builder setTextSize(int textSize) &#123; mTextSize = textSize; return this; &#125; /** * è®¾ç½®æ°´å°æ–‡å­—æ˜¯å¦åŠ ç²— * * @param textBold æ–‡å­—åŠ ç²—(é»˜è®¤:false) * @return Builder */ public Builder setTextBold(boolean textBold) &#123; mTextBold = textBold; return this; &#125; /** * è®¾ç½®æ°´å°æ–‡å­—Xè½´é—´è·ï¼ˆå•ä½ï¼špxï¼‰ * * @param dx æ–‡å­—Xè½´é—´è·(é»˜è®¤:100px) * @return Builder */ public Builder setDx(int dx) &#123; mDx = dx; return this; &#125; /** * è®¾ç½®æ°´å°æ–‡å­—Yè½´é—´è·ï¼ˆå•ä½ï¼špxï¼‰ * * @param dy æ–‡å­—Yè½´é—´è·(é»˜è®¤:240px) * @return Builder */ public Builder setDy(int dy) &#123; mDy = dy; return this; &#125; /** * è®¾ç½®æ°´å°æ–‡å­—å¯¹é½æ–¹å¼ * * @param align å¯¹é½æ–¹å¼(é»˜è®¤:Center) * @return Builder */ public Builder setAlign(Paint.Align align) &#123; mAlign = align; return this; &#125; /** * ç”Ÿæˆæ°´å°å…¨å±€é…ç½®ä¿¡æ¯ * * @return é…ç½®ä¿¡æ¯ */ public WaterMarkInfo generate() &#123; return new WaterMarkInfo(mDegrees, mTextColor, mTextSize, mTextBold, mDx, mDy, mAlign); &#125; &#125; &#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485import android.content.Context;import android.graphics.Canvas;import android.graphics.Color;import android.graphics.ColorFilter;import android.graphics.Paint;import android.graphics.PixelFormat;import android.graphics.drawable.Drawable;import android.support.annotation.IntRange;import android.support.annotation.NonNull;import android.support.annotation.Nullable; import java.util.List; public class WaterMarkBg extends Drawable &#123; private Paint paint = new Paint(); private List&lt;String&gt; labels; private Context context; private int degress;//è§’åº¦ private int fontSize;//å­—ä½“å¤§å° å•ä½sp /** * åˆå§‹åŒ–æ„é€  * @param context ä¸Šä¸‹æ–‡ * @param labels æ°´å°æ–‡å­—åˆ—è¡¨ å¤šè¡Œæ˜¾ç¤ºæ”¯æŒ * @param degress æ°´å°è§’åº¦ * @param fontSize æ°´å°æ–‡å­—å¤§å° */ public WaterMarkBg(Context context, List&lt;String&gt; labels, int degress, int fontSize) &#123; this.labels = labels; this.context = context; this.degress = degress; this.fontSize = fontSize; &#125; @Override public void draw(@NonNull Canvas canvas) &#123; int width = getBounds().right; int height = getBounds().bottom; canvas.drawColor(Color.parseColor(&quot;#40F3F5F9&quot;)); paint.setColor(Color.parseColor(&quot;#50AEAEAE&quot;)); paint.setAntiAlias(true); paint.setTextSize(sp2px(context,fontSize)); canvas.save(); canvas.rotate(degress); float textWidth = paint.measureText(labels.get(0)); int index = 0; for (int positionY = height / 10; positionY &lt;= height; positionY += height / 10+80) &#123; float fromX = -width + (index++ % 2) * textWidth; for (float positionX = fromX; positionX &lt; width; positionX += textWidth * 2) &#123; int spacing = 0;//é—´è· for(String label:labels)&#123; canvas.drawText(label, positionX, positionY+spacing, paint); spacing = spacing+50; &#125; &#125; &#125; canvas.restore(); &#125; @Override public void setAlpha(@IntRange(from = 0, to = 255) int alpha) &#123; &#125; @Override public void setColorFilter(@Nullable ColorFilter colorFilter) &#123; &#125; @Override public int getOpacity() &#123; return PixelFormat.UNKNOWN; &#125; public static int sp2px(Context context, float spValue) &#123; final float fontScale = context.getResources().getDisplayMetrics().scaledDensity; return (int) (spValue * fontScale + 0.5f); &#125;&#125; xmlä¸­ å¼•ç”¨ 1234567891011121314&lt;com.commonlib.WaterMarkView android:singleLine=&quot;false&quot; android:id=&quot;@+id/wm&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; app:water_mark_align=&quot;CENTER&quot; app:water_mark_degree=&quot;-30&quot; app:water_mark_dx=&quot;100px&quot; app:water_mark_dy=&quot;240px&quot; app:water_mark_sync=&quot;true&quot; app:water_mark_text=&quot;å†è§å­™æ‚Ÿç©º&quot; app:water_mark_textBold=&quot;false&quot; app:water_mark_textColor=&quot;@color/black&quot; app:water_mark_textSize=&quot;30px&quot; /&gt; activityä¸­ 12345678910private WaterMarkView wm; wm = (WaterMarkView) findViewById(R.id.wm); private void water() &#123; SharedPreferences jobcede = getSharedPreferences(&quot;jobcede&quot;, MODE_PRIVATE); String userName = jobcede.getString(&quot;username&quot;, &quot;&quot;); String name = jobcede.getString(&quot;name&quot;, &quot;&quot;); wm.setText(name,userName);&#125; â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œå†è§å­™æ‚Ÿç©º_ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/shaoyezhangliwei/article/details/109849305","categories":[{"name":"UI","slug":"UI","permalink":"http://example.com/categories/UI/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://example.com/tags/Android/"}]},{"title":"Temp","slug":"Temp","date":"2022-03-04T00:54:24.000Z","updated":"2022-03-14T09:12:09.000Z","comments":true,"path":"2022/03/04/Temp/","link":"","permalink":"http://example.com/2022/03/04/Temp/","excerpt":"","text":"RecycleViewè®¾ç½®æ»‘åŠ¨ç›‘å¬ï¼šmRecycleView.addOnScrollListener(new RecyclerView.OnScrollListener() {undefined @Override public void onScrollStateChanged(@NonNull RecyclerView recyclerView, int newState) {undefined super.onScrollStateChanged(recyclerView, newState); } @Override public void onScrolled(@NonNull RecyclerView recyclerView, int dx, int dy) &#123;undefined super.onScrolled(recyclerView, dx, dy); &#125; }); åˆ¤æ–­æ»‘åŠ¨æ–¹å‘ï¼š @Override public void onScrolled(@NonNull RecyclerView recyclerView, int dx, int dy) {undefined if (dy &gt; 0) {&#x2F;&#x2F;ä¸‹æ»‘åŠ¨ä½œ } if (dy &lt; 0) &#123;//ä¸Šæ»‘åŠ¨ä½œ &#125; super.onScrolled(recyclerView, dx, dy); &#125; åˆ¤æ–­æ˜¯å¦æ»‘åŠ¨åˆ°é¡¶éƒ¨ã€åº•éƒ¨ï¼š@Overridepublic void onScrollStateChanged(@NonNull RecyclerView recyclerView, int newState) { if(newState &#x3D;&#x3D; RecyclerView.SCROLL_STATE_IDLE){&#x2F;&#x2F;åœæ­¢æ»‘åŠ¨ if(recyclerView.canScrollVertically(1)){ Toast.show(â€œæ»‘åŠ¨åˆ°é¡¶éƒ¨â€); } if(recyclerView.canScrollVertically(-1)){ Toast.show(â€œæ»‘åŠ¨åˆ°åº•éƒ¨â€); } } super.onScrollStateChanged(recyclerView, newState);} recyclerView.canScrollVertically(1); falseè¡¨ç¤ºä¸èƒ½å¾€ä¸Šæ»‘åŠ¨ï¼Œå³ä»£è¡¨åˆ°é¡¶éƒ¨äº†ï¼›recyclerView.canScrollVertically(-1); falseè¡¨ç¤ºä¸èƒ½å¾€ä¸‹æ»‘åŠ¨ï¼Œå³ä»£è¡¨åˆ°åº•éƒ¨äº†ï¼› controller é€šè¿‡service æ¥æ“ä½œæ•°æ®çš„å¢åˆ æ”¹æŸ¥ service é€šè¿‡ mapperæ¥å£æ¥æ“ä½œæ•°æ®åº“ æ¯ä¸€ä¸ªmapperçš„å®ä½“æ¥å£ç±»å¯¹åº”ä¸€ä¸ªxml ä¸­çš„mapper ä¸­çš„sqlçš„è¯­å¥æ¥å…·ä½“çš„æ“ä½œæ•°æ®åº“ redisé«˜é€Ÿç¼“å­˜ç”¨æˆ·ä¿¡æ¯ lsof -i :5088 create-react-app https://create-react-app.dev/docs/getting-started antdesign https://ant.design/docs/react/use-with-create-react-app-cn 3.9vscodeä¸‹å‡½æ•°è‡ªåŠ¨è¡¥å…¨æ‹¬å·https://www.jianshu.com/p/676d1833db5e JavaScript ä¸­ call()ã€apply()ã€bind() çš„ç”¨æ³•https://www.runoob.com/w3cnote/js-call-apply-bind.html JavaScript this å…³é”®å­—https://www.runoob.com/js/js-this.html Linux find å‘½ä»¤https://www.runoob.com/linux/linux-comm-find.html 1. VMessVMess åè®®æ˜¯ç”± V2Ray åŸåˆ›å¹¶ä½¿ç”¨äº V2Ray çš„åŠ å¯†ä¼ è¾“åè®®ï¼Œå¦‚åŒ Shadowsocks ä¸€æ ·ä¸ºäº†å¯¹æŠ—å¢™çš„æ·±åº¦åŒ…æ£€æµ‹è€Œç ”å‘çš„ã€‚åœ¨ V2Ray ä¸Šå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„é€šä¿¡ä¸»è¦æ˜¯é€šè¿‡ VMess åè®®é€šä¿¡ã€‚ æœ¬å°èŠ‚ç»™å‡ºäº† VMess çš„é…ç½®æ–‡ä»¶ï¼Œå…¶å®ä¹Ÿå°±æ˜¯æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„åŸºæœ¬é…ç½®æ–‡ä»¶ï¼Œè¿™æ˜¯ V2Ray èƒ½å¤Ÿè¿è¡Œçš„æœ€ç®€å•çš„é…ç½®ã€‚ V2Ray ä½¿ç”¨ inbound(ä¼ å…¥) å’Œ outbound(ä¼ å‡º) çš„ç»“æ„ï¼Œè¿™æ ·çš„ç»“æ„éå¸¸æ¸…æ™°åœ°ä½“ç°äº†æ•°æ®åŒ…çš„æµåŠ¨æ–¹å‘ï¼ŒåŒæ—¶ä¹Ÿä½¿å¾— V2Ray åŠŸèƒ½å¼ºå¤§å¤æ‚çš„åŒæ—¶è€Œä¸æ··ä¹±ï¼Œæ¸…æ™°æ˜äº†ã€‚å½¢è±¡åœ°è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ V2Ray å½“ä½œä¸€ä¸ªç›’å­ï¼Œè¿™ä¸ªç›’å­æœ‰å…¥å£å’Œå‡ºå£(å³ inbound å’Œ outbound)ï¼Œæˆ‘ä»¬å°†æ•°æ®åŒ…é€šè¿‡æŸä¸ªå…¥å£æ”¾è¿›è¿™ä¸ªç›’å­é‡Œï¼Œç„¶åè¿™ä¸ªç›’å­ä»¥æŸç§æœºåˆ¶ï¼ˆè¿™ä¸ªæœºåˆ¶å…¶å®å°±æ˜¯è·¯ç”±ï¼Œåé¢ä¼šè®²åˆ°ï¼‰å†³å®šè¿™ä¸ªæ•°æ®åŒ…ä»å“ªä¸ªå‡ºå£åå‡ºæ¥ã€‚ä»¥è¿™æ ·çš„è§’åº¦ç†è§£çš„è¯ï¼ŒV2Ray åšå®¢æˆ·ç«¯ï¼Œåˆ™ inbound æ¥æ”¶æ¥è‡ªæµè§ˆå™¨æ•°æ®ï¼Œç”± outbound å‘å‡ºå»(é€šå¸¸æ˜¯å‘åˆ° V2Ray æœåŠ¡å™¨)ï¼›V2Ray åšæœåŠ¡å™¨ï¼Œåˆ™ inbound æ¥æ”¶æ¥è‡ª V2Ray å®¢æˆ·ç«¯çš„æ•°æ®ï¼Œç”± outbound å‘å‡ºå»(é€šå¸¸æ˜¯å¦‚ Google ç­‰æƒ³è¦è®¿é—®çš„ç›®æ ‡ç½‘ç«™)ã€‚ V2Rayé«˜çº§æŠ€å·§ï¼šæµé‡ä¼ªè£…https://v2xtls.org/v2ray%E9%AB%98%E7%BA%A7%E6%8A%80%E5%B7%A7%EF%BC%9A%E6%B5%81%E9%87%8F%E4%BC%AA%E8%A3%85/ Android åŠ¨ç”»ä¹‹LottieåŠ¨ç”»ä½¿ç”¨https://segmentfault.com/a/1190000039131272 AndroidçŸ¢é‡åŠ¨ç”»å®è·µhttps://juejin.cn/post/6844903491652026375 çŸ¢é‡åŠ¨ç”» svg çŸ¢é‡å›¾å½¢ å¤§å‰ç«¯è®­ç»ƒè¥ æ¨¡å—ä¸€ å‡½æ•°å¼ç¼–ç¨‹ä¸JSå¼‚æ­¥ç¼–ç¨‹ï¼Œæ‰‹å†™Promise 1.ä¸ºä»€ä¹ˆè¯´å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Ÿ 2.å¦‚ä½•æŠŠä¸€ä¸ªå‡½æ•°èµ‹å€¼ç»™å˜é‡ï¼Ÿ 3.å¦‚ä½•æŠŠä¸€ä¸ªå‡½æ•°èµ‹å€¼ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Ÿ æ³¨æ„ï¼šèµ‹å€¼çš„æ˜¯å‡½æ•°å®šä¹‰è€Œä¸æ˜¯è°ƒç”¨ 4.ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°ï¼Ÿ 5.æ‰‹å†™ æ•°ç»„ forEach å’Œ filter? 6.ä»€ä¹ˆæ˜¯å‡½æ•°å¼ç¼–ç¨‹ï¼Ÿæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ 7.ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ 8.é—­åŒ…çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿ 9.é—­åŒ…çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ 10.ä»€ä¹ˆæ˜¯çº¯å‡½æ•°ï¼Ÿ 3.111.JSJSæ•°ç»„reduce()æ–¹æ³•è¯¦è§£åŠé«˜çº§æŠ€å·§https://www.jianshu.com/p/e375ba1cfc47 å¤§å‰ç«¯è®­ç»ƒè¥ 1.å‡½æ•°å¼ç¼–ç¨‹è§„èŒƒ 1.ç»„åˆå‡½æ•° 2.lodash ä¸­çš„ç»„åˆå‡½æ•° 3.ç»„åˆå‡½æ•°çš„åŸç†åŠå®ç° 4.ç»„åˆå‡½æ•°çš„ç»“åˆç‡ 5.å¦‚ä½•è°ƒè¯•ç»„åˆå‡½æ•°ï¼Ÿ 6.lodashä¸­çš„fp 2.kotlinKotlinä¸­ï¼Œå‡½æ•°ä½œä¸ºå‚æ•°ï¼ŒT.()-&gt;Unit å’Œ ()-&gt;Unit çš„åŒºåˆ«https://blog.csdn.net/weixin_33676492/article/details/92520157?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_default&amp;utm_relevant_index=1 å‡½æ•°ç±»å‹Kotlin ä½¿ç”¨ç±»ä¼¼ (Int) -&gt; String çš„ä¸€ç³»åˆ—å‡½æ•°ç±»å‹æ¥å¤„ç†å‡½æ•°çš„å£°æ˜ï¼š val onClick: () -&gt; Unit = â€¦â€¦ã€‚ è¿™äº›ç±»å‹å…·æœ‰ä¸å‡½æ•°ç­¾åç›¸å¯¹åº”çš„ç‰¹æ®Šè¡¨ç¤ºæ³•ï¼Œå³å®ƒä»¬çš„å‚æ•°å’Œè¿”å›å€¼ï¼š æ‰€æœ‰å‡½æ•°ç±»å‹éƒ½æœ‰ä¸€ä¸ªåœ†æ‹¬å·æ‹¬èµ·æ¥çš„å‚æ•°ç±»å‹åˆ—è¡¨ä»¥åŠä¸€ä¸ªè¿”å›ç±»å‹ï¼š(A, B) -&gt; C è¡¨ç¤ºæ¥å—ç±»å‹åˆ†åˆ«ä¸º A ä¸ B ä¸¤ä¸ªå‚æ•°å¹¶è¿”å›ä¸€ä¸ª C ç±»å‹å€¼çš„å‡½æ•°ç±»å‹ã€‚ å‚æ•°ç±»å‹åˆ—è¡¨å¯ä»¥ä¸ºç©ºï¼Œå¦‚ () -&gt; Aã€‚Unit è¿”å›ç±»å‹ä¸å¯çœç•¥ã€‚ å‡½æ•°ç±»å‹å¯ä»¥æœ‰ä¸€ä¸ªé¢å¤–çš„æ¥æ”¶è€…ç±»å‹ï¼Œå®ƒåœ¨è¡¨ç¤ºæ³•ä¸­çš„ç‚¹ä¹‹å‰æŒ‡å®šï¼š ç±»å‹ A.(B) -&gt; C è¡¨ç¤ºå¯ä»¥åœ¨ A çš„æ¥æ”¶è€…å¯¹è±¡ä¸Šä»¥ä¸€ä¸ª B ç±»å‹å‚æ•°æ¥è°ƒç”¨å¹¶è¿”å›ä¸€ä¸ª C ç±»å‹å€¼çš„å‡½æ•°ã€‚ å¸¦æœ‰æ¥æ”¶è€…çš„å‡½æ•°å­—é¢å€¼é€šå¸¸ä¸è¿™äº›ç±»å‹ä¸€èµ·ä½¿ç”¨ã€‚ 3.121.JS1.å˜é‡å£°æ˜æå‡ 2.å½¢å‚ä¹Ÿæ˜¯å±€éƒ¨å˜é‡ 3.ä½œç”¨åŸŸé“¾ å‡½æ•°åªæœ‰åœ¨è°ƒç”¨çš„æ—¶å€™æ‰ä¼šå½¢æˆä½œç”¨åŸŸï¼Œå£°æ˜çš„æ—¶é—´ä¸ä¼šå½¢æˆä½œç”¨åŸŸ æ•°ç»„çš„è§£æ„å¯¹åº”ä½ç½®å£°æ˜å˜é‡ åªè¦ç¬¬ä¸‰ä¸ªæˆå‘˜ å‰©ä½™æ‰€æœ‰çš„éƒ½è§£æ„å‡ºæ¥ å°äºé•¿åº¦ï¼ŒæŒ‰é¡ºåºæå– å¤§äºé•¿åº¦ï¼Œundifined å’Œè®¾ç½®é»˜è®¤å€¼ åº”ç”¨ å¯¹è±¡çš„è§£æ„ å†²çª é‡å‘½åè§£å†³ åº”ç”¨ æ¨¡æ¿å­—ç¬¦ä¸²ä¹Ÿç”¨Â· è¦è½¬ä¹‰ å¸¦æ ‡ç­¾çš„æ¨¡æ¿å­—ç¬¦ä¸² å­—ç¬¦ä¸²æ‹“å±• å‚æ•°é»˜è®¤å€¼ å‰©ä½™å‚æ•° å±•å¼€æ•°ç»„å‚æ•° ç®­å¤´å‡½æ•° ç®­å¤´å‡½æ•°ä¸this å¯¹è±¡å­—é¢é‡ Object.assign æ–¹æ³• Object.assign æ˜¯æµ…æ‹·è´è¿˜æ˜¯æ·±æ‹·è´ï¼Ÿå®ç°æ·±æ‹·è´çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿhttps://juejin.cn/post/6844903895550918669 3.131.jsProxy å¯¹è±¡ Proxyå’ŒObject.defineProperty()çš„åŒºåˆ« deleteProperty æ–¹æ³•è°ƒç”¨ç­‰ä¹Ÿèƒ½ç›‘å¬åˆ° defineProperty åªèƒ½ç›‘å¬å±æ€§çš„è®¾ç½®å’Œè®¿é—® Reflect é¿å…ä½¿ç”¨å„ç§ä¹±ä¸ƒå…«ç³Ÿçš„æ–¹æ³•ï¼Œè€Œæ˜¯æŠŠè¿™äº›æ–¹æ³•è¿›è¡Œç»Ÿä¸€ç®¡ç† PromiseClasses6ä»¥å‰ es6 é™æ€æ–¹æ³• ç»§æ‰¿ superæŒ‡çš„å°±æ˜¯çˆ¶ç±»ï¼Œå¯ä»¥è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³• Set Map 3.141.jsfor of éå† æ•°ç»„ éå† Set éå† Map ES2015ä¹‹å¯¹è±¡è®¡ç®—å±æ€§å€¼http://liunian.github.io/blog/es2015-computed-property-name/ JavaScript Node let const","categories":[],"tags":[]},{"title":"Jetpackç³»åˆ—â€”pagingæ¡†æ¶ä½¿ç”¨å’ŒåŸç†(åŸºäºpaging-runtime-2.1.0ç‰ˆæœ¬)","slug":"Jetpackç³»åˆ—â€”pagingæ¡†æ¶åŸç†","date":"2022-02-24T20:23:47.000Z","updated":"2022-05-12T07:38:45.000Z","comments":true,"path":"2022/02/25/Jetpackç³»åˆ—â€”pagingæ¡†æ¶åŸç†/","link":"","permalink":"http://example.com/2022/02/25/Jetpack%E7%B3%BB%E5%88%97%E2%80%94paging%E6%A1%86%E6%9E%B6%E5%8E%9F%E7%90%86/","excerpt":"","text":"Jetpackç³»åˆ—â€”pagingæ¡†æ¶ä½¿ç”¨å’ŒåŸç†(åŸºäºpaging-runtime-2.1.0ç‰ˆæœ¬) åŸºäºpaging-runtime-2.1.0ç‰ˆæœ¬ å…ˆçœ‹ä¸‹pageingçš„åŸºæœ¬ä½¿ç”¨ 1.æ„é€ ä¸€ä¸ªpageDataå¯¹è±¡ 1234567LiveData&lt;PagedList&lt;T&gt;&gt; pageData = new LivePagedListBuilder(factory, config) //åŠ è½½åˆå§‹åŒ–æ•°æ®æ—¶éœ€è¦ä¼ é€’çš„å‚æ•°ï¼Œé¦–é¡µå°±ç»™ä¼ ä¸ª0å°±è¡Œäº†ï¼Œå¦‚æœæ˜¯å¤šä¸ªå‚æ•°ï¼Œéœ€è¦æŠŠå¤šä¸ªå‚æ•°ç»„è£…æˆä¸€ä¸ª javabeanå¯¹è±¡ .setInitialLoadKey(0) //.setFetchExecutor() //è¿™ä¸ªcallbackå¯ä»¥çŸ¥é“pageliståŠ è½½æ•°æ®çš„çŠ¶æ€ï¼Œå¯ä»¥åˆ¤å®šç•Œé¢ä¸Šæœ‰æ²¡æœ‰æ•°æ®ç­‰å¼‚å¸¸çš„çŠ¶æ€,çœ‹åå­—å°±çŸ¥é“ï¼Œæ˜¯è¾¹ç•Œæƒ…å†µå›è°ƒï¼Œä½† ä¸æ˜¯æ¯ä¸€æ¬¡åˆ†é¡µ éƒ½ä¼šå›è°ƒè¿™é‡Œ .setBoundaryCallback(callback) .build(); 2.å…ˆçœ‹æ›´æ–°æ•°æ®æ¥æ”¶å’Œæ›´æ–°çš„åœ°æ–¹ 12345//è§¦å‘é¡µé¢åˆå§‹åŒ–æ•°æ®åŠ è½½çš„é€»è¾‘mViewModel.getPageData().observe(this, pagedList -&gt; submitList(pagedList));//ç›‘å¬åˆ†é¡µæ—¶æœ‰æ— æ›´å¤šæ•°æ®,ä»¥å†³å®šæ˜¯å¦å…³é—­ä¸Šæ‹‰åŠ è½½çš„åŠ¨ç”»mViewModel.getBoundaryPageData().observe(this, hasData -&gt; finishRefresh(hasData)); æœ¬è´¨é€šè¿‡è¿™ä¸ªpageDataå»observeè¿›è¡Œæ•°æ®çš„åˆ†å‘äº‹ä»¶é€šçŸ¥ï¼Œè¿›è€Œåˆ·æ–°é¡µé¢æ•°æ®ï¼Œæœ¬è´¨ä¸Šæ˜¯ä½¿ç”¨äº†livedataçš„èƒ½åŠ›ã€‚ 3.çœ‹å…·ä½“æ„é€ pageDataå¯¹è±¡æ—¶è¿˜éœ€è¦ä¸€ä¸ªfactory config callbackè¿™äº›éƒ½æ˜¯ä»€ä¹ˆ config 1234567891011PagedList.Config config = new PagedList.Config.Builder() //ä¸€é¡µåŠ è½½å¤šå°‘æ¡æ•°æ® .setPageSize(10) //è®¾ç½®é»˜è®¤åŠ è½½å¤šå°‘æ¡æ•°æ® .setInitialLoadSizeHint(12) //çŸ¥é“åˆ—è¡¨ä¸€å…±å¤šå°‘æ¡æ•°æ® //.setMaxSize(100) //è¿˜æœ‰å¤šå°‘æ¡çš„æ—¶å€™çš„é¢„åŠ è½½ï¼Œé»˜è®¤æ˜¯pageSize å¦‚æœä¸æƒ³æœ‰è¿™ä¸ªåŠŸèƒ½ï¼Œå°±è®©setInitialLoadSizeHint å¤§äºpageSize //è¦ä¸ä¸€å¼€å§‹å®ƒåŠ è½½äº†10æ¡ï¼Œå®ƒé©¬ä¸Šå°±æ‰§è¡ŒloadMoreäº† //.setPrefetchDistance(4) .build(); factory 12345678910DataSource.Factory factory = new DataSource.Factory() &#123; @NonNull @Override public DataSource create() &#123; if (dataSource == null || dataSource.isInvalid()) &#123; dataSource = createDataSource(); &#125; return dataSource; &#125;&#125;; callback è¾¹ç•Œ 123456789101112131415161718PagedList.BoundaryCallback&lt;T&gt; callback = new PagedList.BoundaryCallback&lt;T&gt;() &#123; @Override public void onZeroItemsLoaded() &#123; //æ–°æäº¤çš„PagedListä¸­æ²¡æœ‰æ•°æ® boundaryPageData.postValue(false); &#125; @Override public void onItemAtFrontLoaded(@NonNull T itemAtFront) &#123; //æ–°æäº¤çš„PagedListä¸­ç¬¬ä¸€æ¡æ•°æ®è¢«åŠ è½½åˆ°åˆ—è¡¨ä¸Š boundaryPageData.postValue(true); &#125; @Override public void onItemAtEndLoaded(@NonNull T itemAtEnd) &#123; //æ–°æäº¤çš„PagedListä¸­æœ€åä¸€æ¡æ•°æ®è¢«åŠ è½½åˆ°åˆ—è¡¨ä¸Š &#125;&#125;; çœ‹åˆ°äº†å§ï¼Œåœ¨ç¬¬ä¸€æ¬¡æ—¶æ²¡æœ‰æ•°æ®ï¼Œåœ¨onZeroItemsLoadedä¼šå‘é€ä¸€æ¡boundaryPageData.postValue(false) è¿™ä¹Ÿæ˜¯livedata.postValue æ‰€ä»¥è§¦å‘ç¬¬ä¸€æ¬¡åŠ è½½æ—¶é¡µé¢æ›´æ–°ï¼Œåç»­åŠ è½½æ›´å¤š é‚£ä¹ˆå…·ä½“çš„å®ç°é€»è¾‘ï¼Œçœ‹ä¸‹åŸä»£ç  åŸºäºpaging-runtime-2.1.0ç‰ˆæœ¬ 1234public LiveData&lt;PagedList&lt;Value&gt;&gt; build() &#123; return create(mInitialLoadKey, mConfig, mBoundaryCallback, mDataSourceFactory, ArchTaskExecutor.getMainThreadExecutor(), mFetchExecutor);&#125; mInitialLoadKeyâ€”â€”ç¬¬ä¸€æ¬¡åŠ è½½æ•°æ®æ—¶çš„å…¥å‚ mConfigâ€”â€”é…ç½®äº†maxsize pagesize PrefetchDistance ç­‰ç­‰å‚æ•° mBoundaryCallbackâ€”â€”æ•°æ®åŠ è½½è¾¹ç•Œçš„å›è°ƒ mDataSourceFactoryâ€”â€”æä¾›æ•°æ®æº ArchTaskExecutor.getMainThreadExecutor()â€”â€”ä¸»çº¿ç¨‹ mFetchExecutorâ€”â€”å¼‚æ­¥çº¿ç¨‹ é™æ€æ–¹æ³•create 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849private static &lt;Key, Value&gt; LiveData&lt;PagedList&lt;Value&gt;&gt; create( @Nullable final Key initialLoadKey, @NonNull final PagedList.Config config, @Nullable final PagedList.BoundaryCallback boundaryCallback, @NonNull final DataSource.Factory&lt;Key, Value&gt; dataSourceFactory, @NonNull final Executor notifyExecutor, @NonNull final Executor fetchExecutor) &#123; //å®é™…ä¸Šreturnçš„æ˜¯ComputableLiveData.getLiveData return new ComputableLiveData&lt;PagedList&lt;Value&gt;&gt;(fetchExecutor) &#123; @Nullable private PagedList&lt;Value&gt; mList; @Nullable private DataSource&lt;Key, Value&gt; mDataSource; private final DataSource.InvalidatedCallback mCallback = new DataSource.InvalidatedCallback() &#123; @Override public void onInvalidated() &#123; invalidate(); &#125; &#125;; @SuppressWarnings(&quot;unchecked&quot;) // for casting getLastKey to Key @Override protected PagedList&lt;Value&gt; compute() &#123; @Nullable Key initializeKey = initialLoadKey; if (mList != null) &#123; initializeKey = (Key) mList.getLastKey(); &#125; do &#123; if (mDataSource != null) &#123; mDataSource.removeInvalidatedCallback(mCallback); &#125; mDataSource = dataSourceFactory.create(); mDataSource.addInvalidatedCallback(mCallback); mList = new PagedList.Builder&lt;&gt;(mDataSource, config) .setNotifyExecutor(notifyExecutor) .setFetchExecutor(fetchExecutor) .setBoundaryCallback(boundaryCallback) .setInitialKey(initializeKey) .build(); &#125; while (mList.isDetached()); return mList; &#125; &#125;.getLiveData();&#125; çœ‹çœ‹ComputableLiveDataé‡Œéƒ½åšäº†å•¥ æ„é€ æ–¹æ³• 1234567891011public ComputableLiveData(@NonNull Executor executor) &#123; mExecutor = executor; //newäº†livedata å¹¶ä¸”å¤å†™äº†onActiveæ–¹æ³• mLiveData = new LiveData&lt;T&gt;() &#123; @Override protected void onActive() &#123; //onActiveæ–¹æ³•æ‰§è¡Œæ—¶æœºï¼Ÿå½“ä¸”ä»…å½“ç¬¬ä¸€ä¸ªæ´»è·ƒçš„observerè¢«æ³¨å†Œåˆ°livedataé‡Œçš„æ—¶å€™å°±ä¼šè§¦å‘activie mExecutor.execute(mRefreshRunnable); &#125; &#125;;&#125; ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦ç”¨è°ƒç”¨äº†pageData.observe(Observer) å°±ä¼šç«‹é©¬è§¦å‘ ComputableLiveDataé‡Œçš„livedataçš„onActiveçš„å›è°ƒ çœ‹ä¸‹mRefreshRunnable é‡Œåšäº†ä»€ä¹ˆï¼Œåˆ·æ–°äº†æ•°æ® 123456789101112131415161718192021222324252627final Runnable mRefreshRunnable = new Runnable() &#123; @WorkerThread @Override public void run() &#123; boolean computed; do &#123; computed = false; if (mComputing.compareAndSet(false, true)) &#123; // as long as it is invalid, keep computing. try &#123; T value = null; while (mInvalid.compareAndSet(true, false)) &#123; computed = true; value = compute(); &#125; if (computed) &#123; mLiveData.postValue(value); &#125; &#125; finally &#123; // release compute lock mComputing.set(false); &#125; &#125; &#125; while (computed &amp;&amp; mInvalid.get()); &#125;&#125;; 1protected abstract T compute(); æ˜¯ä¸€ä¸ªæŠ½è±¡ï¼Œå…·ä½“å®ç°åœ¨ComputeLiveDataçš„åŒ¿åå®ç°é‡Œ 12345678910111213141516171819protected PagedList&lt;Value&gt; compute() &#123; Key initializeKey = initialLoadKey; if (this.mList != null) &#123; initializeKey = this.mList.getLastKey(); &#125; do &#123; if (this.mDataSource != null) &#123; this.mDataSource.removeInvalidatedCallback(this.mCallback); &#125; //é€šè¿‡createæ–¹æ³•ï¼Œç”Ÿæˆäº†ä¸€ä¸ªdatasourceå¯¹è±¡ æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç”±ç”¨æˆ·åœ¨ä¸Šå±‚å®ç° this.mDataSource = dataSourceFactory.create(); this.mDataSource.addInvalidatedCallback(this.mCallback); this.mList = (new androidx.paging.PagedList.Builder(this.mDataSource, config)).setNotifyExecutor(notifyExecutor).setFetchExecutor(fetchExecutor).setBoundaryCallback(boundaryCallback).setInitialKey(initializeKey).build(); &#125; while(this.mList.isDetached()); return this.mList;&#125; ç”±ç”¨æˆ·åœ¨ä¸Šå±‚å®ç° 1public abstract DataSource&lt;Key, Value&gt; create(); æˆ‘ä»¬åœ¨viewmodelä¸­çš„å®ç° 12345678910DataSource.Factory factory = new DataSource.Factory() &#123; @NonNull @Override public DataSource create() &#123; if (dataSource == null || dataSource.isInvalid()) &#123; dataSource = createDataSource(); &#125; return dataSource; &#125;&#125;; è¿›è€Œç”±æ¯ä¸ªå…·ä½“çš„viewmodelä¸­çš„newçš„datasourceå¯¹è±¡ 12345678910111213141516171819202122232425262728class FeedDataSource extends ItemKeyedDataSource&lt;Integer, Feed&gt; &#123; @Override public void loadInitial(@NonNull LoadInitialParams&lt;Integer&gt; params, @NonNull LoadInitialCallback&lt;Feed&gt; callback) &#123; //åŠ è½½åˆå§‹åŒ–æ•°æ®çš„ Log.e(&quot;homeviewmodel&quot;, &quot;loadInitial: &quot;); loadData(0, params.requestedLoadSize, callback); witchCache = false; &#125; @Override public void loadAfter(@NonNull LoadParams&lt;Integer&gt; params, @NonNull LoadCallback&lt;Feed&gt; callback) &#123; //å‘ååŠ è½½åˆ†é¡µæ•°æ®çš„ Log.e(&quot;homeviewmodel&quot;, &quot;loadAfter: &quot;); loadData(params.key, params.requestedLoadSize, callback); &#125; @Override public void loadBefore(@NonNull LoadParams&lt;Integer&gt; params, @NonNull LoadCallback&lt;Feed&gt; callback) &#123; callback.onResult(Collections.emptyList()); //èƒ½å¤Ÿå‘å‰åŠ è½½æ•°æ®çš„ &#125; @NonNull @Override public Integer getKey(@NonNull Feed item) &#123; return item.id; &#125;&#125; æ¥ç€å¾€ä¸‹çœ‹ 1this.mDataSource.addInvalidatedCallback(this.mCallback); ä¸ºä»€ä¹ˆè¦ç»™datasourceæ³¨å†Œä¸€ä¸ªcallbackå‘¢ï¼Ÿå…ˆå¾€ä¸‹çœ‹ï¼Œè¿™ä¸ªcallbackå¹²äº†ä»€ä¹ˆ 12345678public void invalidate() &#123; //é€šè¿‡åŸå­çš„æ–¹å¼ï¼ŒæŠŠmInvalideæ ‡å¿—ä½è®¾ä¸ºtrue if (mInvalid.compareAndSet(false, true)) &#123; for (InvalidatedCallback callback : mOnInvalidatedCallbacks) &#123; callback.onInvalidated(); &#125; &#125;&#125; è¿™å°±ä¼šèµ°åˆ° 12345private final InvalidatedCallback mCallback = new InvalidatedCallback() &#123; public void onInvalidated() &#123; invalidate(); &#125;&#125;; èµ°åˆ° ComputableLivedata.invalidate() 123public void invalidate() &#123; ArchTaskExecutor.getInstance().executeOnMainThread(mInvalidationRunnable);&#125; 123456789101112final Runnable mInvalidationRunnable = new Runnable() &#123; @MainThread @Override public void run() &#123; boolean isActive = mLiveData.hasActiveObservers(); if (mInvalid.compareAndSet(false, true)) &#123; if (isActive) &#123; mExecutor.execute(mRefreshRunnable); &#125; &#125; &#125;&#125;; è¿™ä¸ªmRefreshRunnableåŒæ ·åœ¨onActiveæ–¹æ³•ä¸­è¢«æ‰§è¡Œè¿‡ å¦‚ä½•é€šè¿‡ä¸‹æ‹‰åˆ·æ–°å»è§¦å‘ æ‰§è¡ŒmRefreshRunnableå‘¢ï¼Ÿ ä¸Šå±‚æ‰§è¡Œ 1mViewModel.getDataSource().invalidate(); å°±ä¼šå†æ¬¡è§¦å‘æˆ‘ä»¬åˆ›å»ºçš„ComputableLiveDataä¸­çš„mCallbackä¸­çš„onInvalidatedæ–¹æ³•è¿›è€Œå®ç°invalidateçš„è°ƒç”¨ï¼Œå¹¶æ‰§è¡Œé‡Œé¢çš„mRefreshRunnableå»åˆ·æ–°æ•°æ®ï¼Œæ‰€ä»¥ æˆ‘ä»¬ç¬¬ä¸€æ¬¡åˆ›å»ºæ—¶ä¼šåˆ·æ–°ä¸€æ¬¡ï¼Œåé¢å°±å¯ä»¥é€šè¿™ä¸ªæ³¨å†Œçš„callback ä¸Šå±‚è°ƒç”¨ å»ä¸»åŠ¨åˆ·æ–°æ•°æ® å†çœ‹mRefreshRunnableçš„åé¢ 1234567891011121314151617181920212223242526272829final Runnable mRefreshRunnable = new Runnable() &#123; @WorkerThread @Override public void run() &#123; boolean computed; do &#123; computed = false; // compute can happen only in 1 thread but no reason to lock others. if (mComputing.compareAndSet(false, true)) &#123; // as long as it is invalid, keep computing. try &#123; T value = null; while (mInvalid.compareAndSet(true, false)) &#123; computed = true; //æ‹¿åˆ°value pagedlist value = compute(); &#125; if (computed) &#123; //é€šè¿‡livedataå‘é€pageliståˆ†å‘æ•°æ®ï¼Œè¿™æ ·æ³¨å†Œçš„åœ°æ–¹å°±å¯ä»¥æ¥æ”¶åˆ°æ•°æ®äº† mLiveData.postValue(value); &#125; &#125; finally &#123; // release compute lock mComputing.set(false); &#125; &#125; &#125; while (computed &amp;&amp; mInvalid.get()); &#125;&#125;;","categories":[{"name":"Jetpackç³»åˆ—","slug":"Jetpackç³»åˆ—","permalink":"http://example.com/categories/Jetpack%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://example.com/tags/Android/"},{"name":"Jetpack","slug":"Jetpack","permalink":"http://example.com/tags/Jetpack/"}]},{"title":"Socketç½‘ç»œç¼–ç¨‹-UDP","slug":"Socketç½‘ç»œç¼–ç¨‹-UDP","date":"2022-02-22T20:02:51.000Z","updated":"2022-02-22T20:49:17.000Z","comments":true,"path":"2022/02/23/Socketç½‘ç»œç¼–ç¨‹-UDP/","link":"","permalink":"http://example.com/2022/02/23/Socket%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B-UDP/","excerpt":"socketç½‘ç»œç¼–ç¨‹ç³»åˆ—ä¹‹äºŒ","text":"socketç½‘ç»œç¼–ç¨‹ç³»åˆ—ä¹‹äºŒ Socketç½‘ç»œç¼–ç¨‹-UDP1.UPDæ˜¯ä»€ä¹ˆé‚£ä¹ˆå‰é¢ä¸€ä¸ªç« èŠ‚å‘¢å’±ä»¬ç®—æ˜¯è¿‡å¾—è½»æ¾åˆæ„‰å¿«ï¼Œå› ä¸ºå‰é¢ä¸€ä¸ªç« èŠ‚æ˜¯ä¸€ä¸ªåŸºç¡€çš„ç« èŠ‚ï¼Œé‚£æœ¬ç« èŠ‚å‘¢å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªåŸºç¡€ç« èŠ‚ï¼Œæœ¬ç« èŠ‚åå­—å«åšsocket - u d på¿«é€Ÿå…¥é—¨ã€‚é‚£ä¹ˆåœ¨æœ¬ç« èŠ‚å½“ä¸­å‘¢æœ€ä¸»è¦çš„æ”¶è·æ˜¯ ç¬¬ä¸€ï¼Œå¸¦é¢†å¤§å®¶æ˜ç™½u d pæ˜¯ä»€ä¹ˆã€‚äºŒã€udpçš„ä¸»è¦ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿä¸‰ã€udpçš„ç®€è¦ç”¨æ³•åŠå…¶apiçš„å­¦ä¹ ã€‚ç¬¬å››ã€å°±æ˜¯ç†è§£ç½‘ç»œå½“ä¸­çš„å•æ’­ã€å¹¿æ’­ä»¥åŠå¤šæ’­çš„æ¦‚å¿µã€‚ å½“ç„¶äº†ï¼Œå…³äºapiçš„å­¦ä¹ ä»¥åŠå¹¿æ’­ã€å¤šæ’­çš„æ¦‚å¿µå’Œè¿ç®—ï¼Œé‚£ä¹ˆè¿™æ˜¯é‡ç‚¹ï¼Œä¹Ÿæ˜¯æœ¬ç« èŠ‚éœ€è¦æŒæ¡çš„é‡ç‚¹çŸ¥è¯†ç‚¹ã€‚å¥½çš„ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬è¿›å…¥åˆ°ç¬¬ä¸€ä¸ªç« èŠ‚ï¼Œudpæ˜¯ä»€ä¹ˆï¼Ÿudpçš„è‹±æ–‡å•è¯æ˜¯user datagram Protocolï¼Œç¼©å†™ä¸ºudpã€‚é‚£ä¹ˆudpæ˜¯ä¸€ç§ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼Œåˆç§°ä¸ºç”¨æˆ·æ•°æ®æŠ¥æ–‡åè®®ã€‚å®ƒæ˜¯ä¸€ç§åŸºäºæŠ¥æ–‡çš„åè®®ï¼Œè€Œä¸æ˜¯é¢å‘é“¾æ¥çš„ä¸€ç§åè®®ï¼Œå®ƒä¸tcpä¸åŒã€‚tcpæ˜¯åŸºäºé“¾æ¥çš„åè®®ï¼Œè€Œudpæ˜¯åŸºäºä¸€ç§ç”¨æˆ·æ•°æ®æŠ¥çš„åè®®ï¼Œå®ƒæ˜¯ä¸€ä¸ªç®€å•çš„é¢å‘æ•°æ®æŠ¥çš„ä¼ è¾“å±‚çš„åè®®ï¼Œæ­£å¼çš„è§„èŒƒä¸ºrfc 768ã€‚é‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å‘¢æˆ‘ä»¬ä¸åšç»†ç©¶ã€‚å¥½äº†ï¼Œæˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨æˆ·æ•°æ®åè®®ï¼Œéè¿æ¥åè®®ï¼Œè¿™æ˜¯é‡ç‚¹ï¼Œå®ƒä¸æ˜¯è¿æ¥åè®®ã€‚udpçš„å‘èµ·å’Œæ¥æ”¶æ˜¯ä¸éœ€è¦è¿›é€šè¿‡è¿æ¥ï¼Œä»…ä»…åªéœ€è¦ç›´æ¥å‘é€ä»¥åŠä½ åœ¨å¯¹åº”ç«¯å£ä¸Šè¿›è¡Œç›‘å¬æ¥æ”¶å³å¯ï¼Œå®ƒä¸éœ€è¦ä¸¤ä¸ªå®¢æˆ·ç«¯ä¸€å®šæ˜¯è¿æ¥çš„ã€‚ å¸¸å¸¸æˆ‘ä»¬ä¼šè¯´tcpå’Œudpæœ€å¤§çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿtcpæ˜¯é¢å‘è¿æ¥çš„ï¼Œç„¶åtcpæ˜¯ä¼ è¾“å¯é çš„ï¼Œè€Œudpæ˜¯é¢å‘æ•°æ®æŠ¥çš„ï¼Œé‚£ä¹ˆä»–ä»¬ä¸¤ä¸ªæ˜¯ä¸ä¸€æ ·çš„ï¼Œä»è€Œä¹Ÿå¯¼è‡´äº†udpåœ¨å¤§å®¶çš„è®¤çŸ¥å½“ä¸­æ˜¯ä¸å¯é çš„ã€‚é‚£æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹å®ƒä¸ºä»€ä¹ˆä¸å¯é ã€‚ç¬¬ä¸€ç‚¹ï¼Œå®ƒä¸€æ—¦æŠŠåº”ç”¨ç¨‹åºç»™åˆ°åº”ç”¨å±‚çš„æ•°æ®å‘é€å‡ºå»ä¹‹åï¼Œå°±ä¸è¿›è¡Œä¿ç•™æ•°æ®å¤‡ä»½æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯è¯´åœ¨udpçš„æ•°æ®å±‚é¢ï¼Œä»–åªç®¡å‘é€æˆ–è€…æ˜¯æ¥æ”¶æ•°æ®ï¼Œè€Œä¸å¯¹è¿™ä¸ªæ•°æ®è¿›è¡Œä¿å­˜ã€å¤‡ä»½ã€é‡å‘ç­‰ç­‰ã€‚ud påœ¨ipæ•°æ®æŠ¥çš„å¤´éƒ¨ï¼Œä»…ä»…åŠ å…¥äº†å¤ç”¨å’Œæ•°æ®æ ¡éªŒçš„å­—æ®µ. é‚£ä¹ˆåœ¨åé¢å‘¢æˆ‘ä»¬ä¼šç»™å¤§å®¶è®²è§£ä¸€ä¸‹å®ƒå…·ä½“åŠ äº†ä¸€äº›ä»€ä¹ˆæ ·çš„ä¸œè¥¿ã€‚åœ¨å‘é€ç«¯æ˜¯äº§ç”Ÿæ•°æ®ï¼Œè€Œåœ¨æ¥æ”¶ç«¯ä»ç½‘ç»œå½“ä¸­å»æŠ“å–æ•°æ®ï¼Œæ‰€ä»¥è¯´å®ƒä»¬ä¸¤è€…æ˜¯ä¸éœ€è¦è¿›è¡Œè¿æ¥çš„ã€‚ ä½†æ˜¯ä¹Ÿæ­£å› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªè¿æ¥çš„åè®®ï¼Œå®ƒæ˜¯é å®¢æˆ·ç«¯å‘é€åè®®ï¼ŒæœåŠ¡å™¨ç«¯ä»ç½‘ç»œå½“ä¸­å»æŠ“å–åè®®ï¼Œå®ƒæŠ“å–çš„æ—¶é—´ä»¥åŠä½ å‘é€çš„æ—¶æœºå¦‚æœè¯´ä¸ç›¸åŒï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå¯¼è‡´å®¢æˆ·ç«¯å‘é€çš„æ•°æ®æœåŠ¡å™¨ç«¯æ²¡æœ‰æ¥æ”¶åˆ°ã€‚ åœ¨udpå½“ä¸­å…¶å®æ˜¯æ²¡æœ‰æ ‡å‡†çš„å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯çš„ã€‚ udpç»“æ„ç®€å•ã€æ²¡æœ‰æ ¡éªŒé€Ÿåº¦å¿«ã€å®¹æ˜“ä¸¢åŒ…ã€‚ä½†æ˜¯å‘¢å®ƒæœ‰ä¸€ä¸ªä¼˜ç‚¹å¯ä»¥å¹¿æ’­ï¼Œé‚£ä¹ˆå¹¿æ’­å‘¢ä¹Ÿæ˜¯æˆ‘ä»¬åé¢è®²è§£çš„ä¸€ä¸ªé‡ç‚¹ã€‚ å¥½çš„ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹udpå®ƒçš„ä¸»è¦èŒèƒ½æ˜¯ä»€ä¹ˆï¼Œudpèƒ½å¤Ÿåšäº›ä»€ä¹ˆè¿™æ ·çš„äº‹æƒ…ã€‚é‚£ä¹ˆç¬¬ä¸€ç‚¹æ˜¯å¯ä»¥ä½œä¸ºdnsã€tftpã€snmpå½“ç„¶è¯´ä¸€ä¸‹æœ€åä¸€ç‚¹ï¼Œs n m på°±æ˜¯æˆ‘ä»¬ä¹‹å‰è¯´çš„ä¸€ä¸ªç½‘ç»œæ•°æ®åè®®ä¼ è¾“å½“ä¸­çš„ä¸€ä¸ªç›‘æ§çš„ä¸€ä¸ªåè®®ã€‚t f t på‘¢è·Ÿf t på·®ä¸äº†å¤ªå¤šï¼Œå…¶å®ä¹Ÿå°±æ˜¯ç”¨ä¸€ç§æ–‡ä»¶ä¼ è¾“çš„åè®®dnsï¼Œè¿™æ˜¯éå¸¸å¸¸è§çš„ä¸€ä¸ªä¸œè¥¿ã€‚åœ¨å’±ä»¬è®¿é—®ä¸€ä¸ªç½‘ç«™é˜²ç™¾åº¦ã€è®¿é—®è°·æ­Œçš„æ—¶å€™ï¼Œå…¶å®è¦è¿›è¡Œçš„ç¬¬ä¸€æ­¥æ“ä½œå°±æ˜¯dnsè§£æã€‚é‚£ä¹ˆdnsè§£æå‘¢å…¶å®å®åˆ™å°±æ˜¯ç”¨çš„udpæ¥å®Œæˆçš„çš„ç›¸å…³åŠŸèƒ½ã€‚é‚£ä¹ˆè¿˜å¯ä»¥åšä»€ä¹ˆäº‹æƒ…å‘¢å¯ä»¥ç”¨äºè§†é¢‘ã€éŸ³é¢‘çš„ä¼ è¾“ä»¥åŠæ™®é€šçš„æ•°æ®ã€‚é‚£ä¹ˆè¿™ä¸ªæ™®é€šæ•°æ®å‘¢è¦æ±‚çš„æ˜¯æ— å…³ç´§è¦çš„æ•°æ®ï¼Œå› ä¸ºå’±ä»¬å‰é¢ä¹Ÿè¯´äº†ï¼Œudpæ˜¯ä¸ä¿è¯ä¼ è¾“çš„å¯é æ€§çš„ï¼Œudpå­˜åœ¨ä¸€å®šçš„ä¸¢åŒ…ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨udpçš„æ•°æ®æ··ä¹±çš„ä¸€ä¸ªé—®é¢˜ã€‚é‚£ä¹ˆæ‰€ä»¥è¿™é‡Œçš„æ™®é€šæ•°æ®ä¸€å®šè¦æ˜¯ä¸€ä¸ªæ— å…³ç´§è¦çš„æ•°æ®ã€‚é‚£ä¹ˆéŸ³é¢‘ç„¶åè§†é¢‘å‘¢è¿™ä¸ªå°±ä¸å¤šè¯´äº†ï¼Œå› ä¸ºéŸ³é¢‘å’Œè§†é¢‘æœ¬èº«å°±æ¯”è¾ƒå¤§ã€‚å½“ç„¶äº†ï¼ŒéŸ³é¢‘å’Œè§†é¢‘ä¸€èˆ¬è€Œè¨€æ˜¯ç”¨äºå’±ä»¬çš„ä¸€ä¸ªå®é™…çš„ç›´æ’­ï¼Œæˆ–è€…æ˜¯ç”¨äºä¸€ä¸ªæˆ‘ä»¬å®¶é‡Œé¢çš„æœ‰çº¿ç”µè§†ä¹‹ç±»çš„ï¼Œé‚£ä¹ˆå°±æ˜¯ç”¨äºudpè¿›è¡Œä¼ è¾“ã€‚ è€Œå¦‚æœè¯´ä½ è¦ä¸‹è½½ä¸€ä¸ªè§†é¢‘æˆ–è€…æ˜¯ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™è¿˜ç”¨udpå—ï¼Ÿè‚¯å®šä¸æ˜¯ï¼Œä»–ä½¿ç”¨çš„tcpï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¼ è¾“ï¼Œä¹Ÿè¦ä¿è¯å®ƒçš„å¯é æ€§ï¼Œæ‰€ä»¥è¯´è¿™ä¸ªæ—¶å€™æ˜¯ä½¿ç”¨çš„tcpã€‚ å¥½çš„ï¼Œæˆ‘ä»¬è¿™ä¸ªæ¥çœ‹ä¸€ä¸‹å’±ä»¬çš„è¿™ä¸ªudpçš„å‰é¢çš„ä¸€ä¸ªæŠ¥æ–‡å¤´ï¼Œä»–åšäº†äº›ä»€ä¹ˆæ ·çš„äº‹æƒ…ï¼Œä¹Ÿå°±æ˜¯å’±ä»¬çš„ä¸€ä¸ªæ•°æ®åè®®å‰é¢udpåŠ äº†ä»€ä¹ˆä¸œè¥¿ã€‚ ç„¶åæˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸‹å®ƒä¸€å…±æœ‰å¤šå°‘ä¸ªä½ä¸€å…±æœ‰64ä½å¯¹ä¸å¯¹ï¼Ÿ64ä½æ€ä¹ˆçœ‹å‰é¢çš„ç¬¬ä¸€è¡Œæ˜¯32ä½ï¼Œç¬¬äºŒè¡Œ32ä½åŠ åœ¨ä¸€èµ·ä¹Ÿå°±æ˜¯64ä½ã€‚å› ä¸ºå››ä½å‘¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å‰é¢çš„è¿™ä¸€ä¸ªéƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯0åˆ°15çš„è¿™ä¸ªéƒ¨åˆ†ï¼Œå®ƒä¸€å…±æ˜¯å¤šå°‘æ˜¯16ä½ã€‚16ä½å‘¢çš„è¯å®ƒå­˜å‚¨çš„æ˜¯ä»€ä¹ˆå­˜å‚¨çš„æ˜¯å‘é€æºçš„ipåœ°å€ï¼Œé‚£ä¹ˆåé¢çš„16ä½æ¥å­˜å‚¨çš„æ˜¯å’±ä»¬çš„ä¸€ä¸ªæ¥æ”¶è€…çš„ï¼Œä¹Ÿå°±æ˜¯ç›®æ ‡çš„ä¸€ä¸ªç«¯å£å·ï¼Œå¯¹ä¸å¯¹ï¼Ÿè€Œå‰é¢å‘¢16ä½å­˜å‚¨çš„æ˜¯æˆ‘ä»¬å‘é€çš„ç«¯å£å·ï¼Œå¯¹å§ï¼Ÿç´§è·Ÿç€åé¢çš„16ä½å­˜å‚¨çš„æ˜¯ä»€ä¹ˆæ˜¯ä¸€ä¸ªå­—èŠ‚é•¿åº¦ï¼Œå¯¹ä¸å¯¹å­˜å‚¨çš„æ˜¯ä¸€ä¸ªå­—èŠ‚é•¿åº¦ï¼Œä»¥åŠå†åˆ°åé¢è¿™ä¸ªä½ç½®ï¼Œæ˜¯å’±ä»¬çš„ä¸€ä¸ªå¤´éƒ¨ä»¥åŠæ•°æ®çš„ä¸€ä¸ªæ ¡éªŒå­—æ®µï¼Œæ‰€ä»¥è¯´éƒ½åœ¨è¿™é‡Œäº†éƒ½åœ¨è¿™é‡Œï¼Œå®ƒä¸€å…±æ˜¯16ä½ã€‚é‚£ä¹ˆåŠ åœ¨ä¸€èµ·å‘¢ä¹Ÿå°±æ˜¯64ä½ã€‚å¥½äº†ï¼Œè¿™é‡Œå‘¢æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€å®šçš„ç»†åŒ–ï¼Œç»™å¤§å®¶è®²è§£ä¸€äº›ä»å›¾ä¸Šé¢ä¸èƒ½ç›´æ¥çœ‹å‡ºçš„ä¸€äº›ä¸œè¥¿ã€‚é¦–å…ˆæˆ‘ä»¬çœ‹ç¬¬ä¸€ç‚¹ï¼Œç«¯å£å·çš„ä¿å­˜ã€‚å‰é¢åˆ†åˆ«ç”¨äº†32ä½ä¿å­˜ç«¯å£å·ï¼Œé‚£ä¹ˆè¿™é‡Œå‘¢å…¶å®æœ‰ä¸€ä¸ªç‚¹éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œç¬¬ä¸€ä¸ª0åˆ°15æ˜¯å¤šå°‘ï¼Ÿæ˜¯16ä½ï¼Œ16ä½çš„è¯å®ƒå…¶å®æ˜¯å¤šå°‘ä¸ªå­—èŠ‚æ˜¯2ä¸ªå­—èŠ‚å¯¹ä¸å¯¹ï¼Ÿä¸¤ä¸ªå­—èŠ‚å…¶å®å°±æ˜¯ä¸€ä¸ªçŸ­æ•´å‹ã€‚é‚£ä¹ˆç´§æ¥ç€æˆ‘ä»¬å¾€åé¢çœ‹ä¸€ç‚¹ï¼Œè¿™å‰é¢çš„ç«¯å£ç”¨çŸ­æ•´å‹æ¥å­˜å‚¨ï¼Œè¿™æ˜¯å¤Ÿçš„ï¼Œå¯¹å§ï¼Ÿå› ä¸ºå’±ä»¬ç«¯å£æ˜¯å¤šå°‘0åˆ°65535ï¼Œå¯¹ä¸å¯¹ï¼Ÿå¥½çš„ã€‚å¾€åé¢çœ‹ä¸€ä¸‹ï¼Œç´§è·Ÿç€çš„å®ƒçš„å­˜å‚¨çš„ï¼Œå’±ä»¬ä¼ è¾“çš„è¿™ä¸ªåé¢çš„æ•°æ®çš„é•¿åº¦æ˜¯å¤šå°‘æ•°æ®çš„é•¿åº¦æ˜¯æ”¾åœ¨è¿™16ä¸ªä½å½“ä¸­ï¼Œè€Œè¿™16ä¸ªä½å‘¢ä¹Ÿæ˜¯ç›¸å½“å…³äºä¸€ä¸ªçŸ­æ•´å‹ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªçŸ­æ•´å‹çš„ä¸€ä¸ªé•¿åº¦ï¼Œç”¨æ¥å­˜å‚¨æˆ‘ä»¬çš„åé¢çš„æ•°æ®éƒ¨åˆ†çš„é•¿åº¦ï¼Œå¯¹ä¸å¯¹ç”¨ä¸€ä¸ªçŸ­ç‚¹å‹å­˜å‚¨ã€‚é‚£ä¹ˆåé¢æ˜¯ä¸€ä¸ªæ ¡éªŒçš„æ•™ç ”çš„éƒ¨åˆ†å‘¢ï¼Œæˆ‘ä»¬å°±ä¸å¤šè¯´ï¼Œæˆ‘ä»¬æ¥è¯´ä¸€ä¸‹ï¼Œæˆ‘ä»¬å‘é€ä¸€ä¸ªudpç©¶ç«Ÿèƒ½å¤Ÿå¸¦å¤šå¤§çš„æ•°æ®å‡ºå»å®ƒç©¶ç«Ÿèƒ½å¤Ÿå‘å¤šå¤§çš„åŒ…ä¸€æ¬¡udpæœ€å¤šèƒ½å¤Ÿå‘å¤šé•¿çš„æ•°æ®å‡ºå»ï¼Ÿä¸€ä¸ªudpåŒ…æœ€å¤§çš„é•¿åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œ16ä½ï¼Œä¹Ÿå°±æ˜¯2ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯å’±ä»¬è¯´çš„ä¸€ä¸ªçŸ­æ•´å‹å­˜å‚¨çš„é•¿åº¦ä¿¡æ¯å¯¹å§å­˜å‚¨é•¿åº¦ä¿¡æ¯ï¼Œé‚£ä¹ˆå®ƒçš„äºŒäº†16ä½å‡å»ä¸€ä¹Ÿå°±æ˜¯ç­‰äº64kå‡å»ä¸€ä¹Ÿå°±ç­‰äº65536å‡1å…¶å®ä¹Ÿå°±ç­‰äº65535ä¸ªå­—èŠ‚é•¿åº¦ã€‚é‚£ä¹ˆæ˜¯ä¸æ˜¯æˆ‘ä»¬å°±å¯ä»¥å‘å…­äº”ä¸‰äº”ä¸ªå­—èŠ‚é•¿åº¦å‘¢ï¼Ÿå…¶å®ä¸æ˜¯ï¼Œå› ä¸ºå’±ä»¬å‰é¢çš„å¤´éƒ¨è¿˜å ç”¨äº†ä¸€éƒ¨åˆ†çš„ä¿¡æ¯ã€‚å¤´éƒ¨ã€‚è¯¶æˆ‘ä»¬è¯´æˆ‘ä»¬å‰é¢çš„å¤´éƒ¨æœ‰å¤šå°‘ï¼Œæœªæ¥çš„64ä¸ªä½ï¼Œå¯¹å§ï¼Ÿè‡ªèº«åè®®å…¶å®æ˜¯å ç”¨äº†å¤šå°‘64ä½æ˜¯å¤šå°‘å•Šï¼Ÿ32åŠ 32ä½ç­‰äº64ä½ï¼Œå…¶å®ä¹Ÿå°±ç­‰äºå’±ä»¬çš„8å­—èŠ‚å¯¹å§å…«å­—èŠ‚çš„é•¿åº¦ï¼Œ65535å‡å»å…«ä¸ªå­—ï¼Œä¹Ÿå°±ç­‰äºå…­äº”é›¶ä¸ƒä¸ªå­—èŠ‚ã€‚æ‰€ä»¥è¯´å’±ä»¬æœ€å¤šå‘é€çš„æ•°æ®é•¿åº¦æ˜¯å…­äº”äº”é›¶ä¸ƒï¼Œè¿™ä¸ªç‚¹ä¸€å®šè¦è®°ä½ã€‚ å½“ä½ è¦å‘é€çš„æ•°æ®é•¿åº¦å¤§äºå…­äº”é›¶ä¸ƒçš„æ—¶å€™ï¼Œä¸€å®šè¦è®°ä½è‡ªå·±è¦è¿›è¡Œä¸€æ¬¡åˆ†åŒ…ç„¶åäº¤ç»™udpè¿›è¡Œä¼ è¾“ï¼Œudpæœ€å¤§çš„ä¼ è¾“ä¸€æ¬¡åŒ…çš„ä¸€ä¸ªå¤§å°æœ€å¤šæ˜¯å…­äº”é›¶ä¸ƒä¸ªå­—èŠ‚é•¿åº¦ã€‚å¥½çš„ï¼Œå½“æœ¬ç« èŠ‚çš„å†…å®¹å°±åˆ°æ­¤ç»“æŸï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªç« èŠ‚å‘¢ä¼šç»™å¤§å®¶è®²è§£ä¸€ä¸‹å’±ä»¬u d pçš„æ ¸å¿ƒapiä¿¡æ¯ã€‚è¯·å¤§å®¶ã€‚ 2.UDPæ ¸å¿ƒAPIå’±ä»¬æ¥ç€å¾€ä¸‹è®²ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨æœ¬å°èŠ‚æ¥è®²è§£ä¸€ä¸‹u d p çš„ä¸€äº›æ ¸å¿ƒa p i è®²è§£ä¸ºä»€ä¹ˆè¦æœ‰è¿™ä¸ªç« èŠ‚å‘¢ï¼Ÿä¸»è¦æ˜¯å› ä¸ºä¸ºäº†å’±ä»¬åé¢å†™ä»£ç çš„æ—¶å€™ï¼Œä¸è‡³äºè®©å¤§å®¶ä¸€ä¸‹å°±æ‡µé€¼äº†ã€‚æ‰€ä»¥è¯´æˆ‘ä»¬ä¸“é—¨æœ‰ä¸€ä¸ªå°èŠ‚è®²è§£ä¸€ä¸‹æ ¸å¿ƒçš„a p i ä¿¡æ¯ã€‚å½“ç„¶äº†ï¼Œè¿™ä¸ªç« èŠ‚æ˜¯ä¸€ä¸ªæ¯”è¾ƒå°çš„ç« èŠ‚ï¼Œå› ä¸ºæ¯•ç«Ÿä¸æ˜¯è·³ä»£ç ï¼Œæ‰€ä»¥è¯´å’±ä»¬åªæ˜¯åœ¨p p t å½“ä¸­è¿‡ä¸€éå’±ä»¬çš„a p i å³å¯ã€‚å¥½çš„ï¼Œæˆ‘ä»¬è¿›å…¥åˆ°è¯¾ç¨‹å†…å®¹ã€‚é¦–å…ˆå’±ä»¬æ¥çœ‹ä¸€ä¸‹a p i å½“ä¸­çš„ç¬¬ä¸€ä¸ªç±»datagramsocketã€‚ è¿™ä¸ªå‘¢æ˜¯ç”¨äºæ¥æ”¶ä¸å‘é€u d p çš„ä¸€ä¸ªç±»ã€‚è¿™ä¸ªç±»æ˜¯å’±ä»¬u d p å½“ä¸­æœ€é‡è¦çš„ä¸€ä¸ªç±»ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨ä¸èŒè´£æ˜¯ç”¨äºæ¥æ”¶å’Œå‘é€u d p ä¿¡æ¯çš„ä¸€ä¸ªç±»ã€‚æ‰€æœ‰çš„u d p ä¿¡æ¯ï¼Œå¯ä»¥è¯´éƒ½æ˜¯ç»è¿‡disagrees socket å‘é€å‡ºå»ä»¥åŠæ¥æ”¶u d p çš„ä¸€ä¸ªåŒ…çš„åè®®ã€‚ä¹Ÿæ˜¯é€šè¿‡data grasp çš„æ¥æ”¶åˆ°äº†ã€‚è´Ÿè´£å‘é€æŸä¸€ä¸ªudp åŒ…æˆ–è€…æ¥æ”¶ä¸€ä¸ªud p åŒ…ä¸åŒäºt c p, u d p çš„åè®®ï¼Œå¹¶æ²¡æœ‰è¢«åˆå¹¶åˆ°socket a p i å½“ä¸­ã€‚å› ä¸ºåœ¨å’±ä»¬çš„t c p å½“ä¸­ï¼Œæˆ‘ä»¬çš„t c p çš„æ“ä½œå…¶å®æ˜¯æœ‰åˆå¹¶åˆ°å’±ä»¬çš„ä¸€ä¸ªsocket åè®®å½“ä¸­å»ã€‚å’±ä»¬çš„å¼€å¤´å°±æ˜¯æŸæŸä»€ä¹ˆä»€ä¹ˆsocketã€‚é‚£ä¹ˆæˆ‘ä»¬æœ‰ä¸€ä¸ªsocket çš„ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä»¥åŠæœ‰ä¸€ä¸ªsocket çš„ä¸€ä¸ªå®¢æˆ·ç«¯çš„å­˜åœ¨ã€‚ ä½†æ˜¯åœ¨å’±ä»¬çš„u d p å½“ä¸­æ˜¯æ²¡æœ‰æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯çš„æ¦‚å¿µã€‚ä½ çš„datagramsocketæ—¢æ˜¯ä½ çš„æœåŠ¡å™¨ï¼Œä¹Ÿæ˜¯ä½ çš„å®¢æˆ·ç«¯ï¼Œä»–å¯ä»¥å‘é€ï¼Œä¹Ÿå¯ä»¥æ¥å—ã€‚ä»–ä¸éœ€è¦å»ç›‘å¬æŸä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå› ä¸ºä»–ä¸æ¶‰åŠå®¢æˆ·ç«¯è·Ÿä»–çš„è¿æ¥ï¼Œæ‰€ä»¥è¯´ä»–ä¸åƒt c p ä¸€æ ·ï¼Œéœ€è¦å…ˆå»ç›‘å¬ä¸€ä¸ªt c p çš„ä¸€ä¸ªæ¥æºï¼Œç„¶åè¿æ¥t c pï¼Œç„¶åå†è¿›è¡Œé€šè®¯ã€‚è¿™é‡Œé¢ç›¸å½“äºå…¶å®å°±æ˜¯ç›´æ¥ä¸¤ä¸ªæœåŠ¡å™¨ä¹‹é—´çš„å‚æ•°äº†ã€‚æˆ–è€…è¯´ä½ å¯ä»¥ç†è§£ä¸ºå°±æ˜¯ä¸¤ä¸ªå®¢æˆ·ç«¯ä¹‹é—´çš„ä¼ è¾“ï¼Œå®ƒæ²¡æœ‰æœåŠ¡å™¨ç«¯ï¼Œä¹Ÿæ²¡æœ‰å®¢æˆ·ç«¯ï¼Œå®ƒæ—¢æ˜¯æœåŠ¡å™¨ä¹Ÿæ˜¯å®¢æˆ·ç«¯ã€‚æ¥ç€å¾€ä¸‹è¯´ä¸€ä¸‹datagramsocketå°±æ˜¯å®ƒçš„æ„é€ å‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªç®€å•çš„å®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹å½“ä¸­æ²¡æœ‰ä¼ é€’ä»»ä½•å‚æ•°ï¼Œæ‰€ä»¥è¯´å®ƒä¸æŒ‡å®šç«¯å£ i pã€‚å¦‚æœè¯´è¿™ä¸ªæ—¶å€™ä½ ç”¨è¿™ä¸ªdatagramsocketè¿›è¡Œå‘é€ï¼Œé‚£ä¹ˆå®ƒä¼šè‡ªåŠ¨å¤ç”¨ä½ æœ¬åœ°çš„å¯ç”¨çš„ä¸€ä¸ªç«¯å£è¿›è¡Œå‘é€æ•°æ®ã€‚å½“ç„¶äº†ï¼Œi p å°±æ˜¯ä½ è‡ªå·±æœ¬æœºçš„i p äº†ï¼Œdatagramsocket(int port) æŒ‡å®šç«¯å£ï¼Œé‚£ä¹ˆå°±æ˜¯åˆ›å»ºä¸€ä¸ªç›‘å¬å›ºå®šç«¯å£çš„ä¸€ä¸ªå®ä¾‹ã€‚è¿™æ˜¯ç”¨äºç›‘å¬æŸä¸€ä¸ªç«¯å£çš„å®ä¾‹ï¼Œå°±æ˜¯è¯´ä½ çš„æ•°æ®æ¥æºå¯ä»¥é€šè¿‡è¿™ä¸ªç«¯å£è¿›è¡Œæ”¶åˆ°ä¿¡æ¯ã€‚ä½†æ˜¯ä½ çš„å‘é€å¹¶ä¸æ˜¯è¿™é‡ŒæŒ‡å®šçš„è¿™ä¸ªç«¯å£ã€‚å‡å¦‚è¯´ä½ æƒ³è¦é€šè¿‡datagramsocket å‘é€ä¸€ä¸ªæ•°æ®åŒ…å‡ºå»ï¼Œä½ å°±ç®—åœ¨è¿™é‡ŒæŒ‡å®šäº†ä¸¤åƒçš„ç«¯å£ã€‚é‚£ä¹ˆä½ æƒ³æŠŠä¸€ä¸ªæ•°æ®å‘é€å‡ºå»çš„æ—¶å€™ï¼Œæ˜¯å‘é€åˆ°å“ªå‘¢ï¼Ÿæ˜¯å‘é€åˆ°è¿™ä¸ªä¸¤åƒå—ï¼Ÿå…¶å®å¹¶ä¸æ˜¯ä½ å¹¶ä¸æ˜¯å‘é€åˆ°è¿™é‡ŒæŒ‡å®šçš„é‚£ä¸ªport è¿™ä¸ªç«¯å£ä¸Šé¢ã€‚è¿™ä¸ªport ç«¯å£å…¶å®åªæ˜¯æŒ‡ä½ æ¥æ”¶æ•°æ®çš„ç«¯å£ã€‚datagramsocket(int port,inetaddress localaddr)è¿™ä¸ªæ—¶å€™æ˜¯ä¸€ä¸ªä¸¤ä¸ªæ„é€ å‚æ•°çš„ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚é‚£ä¹ˆå®ƒåˆ›å»ºçš„æ˜¯ä¸€ä¸ªå›ºå®šç«¯å£ä»¥åŠæŒ‡å®ši p çš„ä¸€ä¸ªå®ä¾‹ã€‚å½“ä½ çš„è®¡ç®—æœºæœ¬åœ°æœ‰å¤šä¸ªi p åœ°å€çš„æ—¶å€™ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™æœ‰æ•ˆä½ å¯ä»¥æŒ‡å®šåªç›‘å¬ä½ çš„ç»ç½‘çš„æŸä¸€ä¸ªç«¯å£ï¼Œæˆ–è€…æ˜¯ä½ æƒ³ç›‘å¬ä½ çš„ä¸€ä¸ªäº’è”ç½‘çš„ä¸€ä¸ªi p åœ°å€çš„ä¸€ä¸ªç«¯å£ã€‚å› ä¸ºä½ çš„ç”µè„‘å¯èƒ½å…·å¤‡å¤šä¸ªi p åœ°å€ï¼Œå› ä¸ºä½ å¯èƒ½å¤„äºæŸä¸€ä¸ªå­ç½‘ã€‚åŒæ—¶ä½ çš„ç”µè„‘ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªå­ç½‘ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä½ å…¶å®æ˜¯æœ‰ä¸¤ä¸ªæœºå™¨ä»¥ä¸Šçš„i p åœ°å€å­˜åœ¨çš„ã€‚æ¥ç€å¾€ä¸‹è¯´ã€‚æˆ‘ä»¬è°ƒç”¨datagramsocket.receive(DatagramPacket d) çš„æ—¶å€™ã€‚è¿™ä¸ªæ—¶å€™å°±æ˜¯ä½ æ¥æ”¶ä¸€ä¸ªä»€ä¹ˆï¼Œæ¥æ”¶ä¸€ä¸ªDatagramPacket è¿™å°±æ˜¯ä¸€ä¸ªå’±ä»¬u d p æŠ¥æ–‡çš„ä¸€ä¸ªå°è£…ç±»ã€‚ä»–å®Œæˆäº†å·¥ä½œå‘¢ï¼Œå’±ä»¬åé¢å†è®²è§£å‘é€ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå°±æ˜¯DatagramPacket ä¼ è¾“è¿›å»çš„ä¹Ÿå°±æ˜¯ä¸€ä¸ªDatagramPacket ã€‚å¯ä»¥çœ‹åˆ°è¿™é‡Œæˆ‘ä»¬å‘é€å’Œæ¥æ”¶å…¶å®éƒ½æ˜¯ä¼ å…¥çš„ä¸€ä¸ªDatagramPacket è¿™æ ·çš„ä¸€ä¸ªå®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹æ—¢å¯ä»¥ç”¨äºæ¥æ”¶ï¼Œä¹Ÿå¯ä»¥ç”¨å‘é€æ•°æ®ã€‚é‚£ä¹ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸€äº›è®¾ç½®é¡¹did so turn outã€‚é‚£ä¹ˆè®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œè¿™æ˜¯ç”¨äºå’±ä»¬è¿›è¡Œä¼ è¾“æˆ–è€…æ˜¯ç›‘å¬çš„æ—¶å€™çš„ä¸€ä¸ªè¶…æ—¶æ—¶é—´ã€‚å½“ç„¶è¿˜æœ‰ä¸€ä¸ªæœ€é‡è¦çš„å°±æ˜¯close å…³é—­ä»¥åŠé‡Šæ”¾èµ„æºã€‚å¥½äº†ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å‰é¢æ‰€è¯´çš„describe packet disagreementã€‚packet æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†æŠ¥æ–‡ã€‚ åŒæ—¶å°†byteæ•°ç»„ç›®æ ‡åœ°å€ã€ç›®æ ‡çš„ç«¯å£ç­‰æ•°æ®åŒ…å°è£…æˆæŠ¥æ–‡ï¼Œæˆ–è€…å°†æŠ¥æ–‡æ‹†æˆbyteæ•°ç»„çš„ä¸€ä¸ªå°è£…ç±»ã€‚ å®ƒçš„è¿™ä¸ªç±»ä¸»è¦ä½œç”¨æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå°±æ˜¯å°†å’±ä»¬çš„è¿™ä¸ªbyteæ•°ç»„ï¼Œbyteæ•°ç»„æ˜¯ä»€ä¹ˆï¼Ÿå°±æ˜¯å’±ä»¬è¦ä¼ è¾“çš„å†…å®¹ï¼Œè¿™ä¸ªæ•°å­—çš„é•¿åº¦æ˜¯å¤šå°‘ï¼Ÿæˆ‘ä»¬ä¹‹å‰å‰é¢æœ‰è®²è¿‡65507ï¼Œé‚£ä¹ˆè¿™ä¸ªä¸œè¥¿å‘¢å°±æ˜¯æˆ‘ä»¬è¦ä¼ è¾“çš„å®é™…çš„ä¸€ä¸ªæ•°æ®ï¼Œå°†è¿™ä¸ªæ•°æ®ä»¥åŠå’±ä»¬ç›®æ ‡çš„ä¸€ä¸ªç«¯å£åœ°å€ã€‚å…¶å®è¿™ä¸ªåœ°æ–¹æ²¡æœ‰ç›®æ ‡åœ°å€ï¼Œè¿™ä¸ªç›®æ ‡åœ°å€è™½ç„¶æˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸€ä¸ªç›®æ ‡åœ°å€ï¼Œä½†æ˜¯å‘¢å®ƒå…¶å®æ˜¯ç”¨äºå‘é€å½“ä¸­çš„ä¸€ä¸ªä¼ è¾“åè®®å»åšçš„ã€‚è€Œå®é™…çš„å’±ä»¬çš„ä¸€ä¸ªæŠ¥æ–‡å‘¢æ˜¯æ²¡æœ‰ç›®æ ‡åœ°å€çš„ã€‚é‚£ä¹ˆå…¶å®ç›¸å½“äºå°±æ˜¯å°†byte æ•°ç»„ä»¥åŠç›®æ ‡ç«¯å£æ··è£…æˆå’±ä»¬çš„æŠ¥æ–‡ï¼Œæˆ–è€…æ˜¯å°†æŠ¥æ–‡åå‘æ‹†è§£æˆä¸ºä¸€ä¸ªbad æ•°æ®ï¼Œä»¥åŠå’±ä»¬çš„ä¸€ä¸ªç›®æ ‡ç«¯å£ã€‚ä½†ç›®æ ‡åœ°å€å°±æ˜¯å±äºå’±ä»¬ä¼ è¾“å½“ä¸­çš„ä¸€ä¸ªå¦å¤–çš„ä¸€ä¸ªã€‚i p å±‚é¢çš„ä¸€ä¸ªä¼ è¾“åœ°å€çš„åè®®ã€‚data ground package æ˜¯u d p çš„ä¸€ä¸ªå‘é€å®ä½“ï¼Œä¹Ÿæ˜¯æ¥æ”¶å®ä½“ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®ƒçš„ä¸€äº›æ„é€ å‡½æ•°ï¼Œè¿™æ˜¯ground packetã€‚è¿™é‡Œå‘¢æ˜¯ä¼ é€’è¿›å»çš„ä¸€ä¸ªbad æ•°ç»„ï¼Œä»¥åŠä¸€ä¸ªbad æ•°ç»„å¯ç”¨çš„ä¸€ä¸ªåŒºé—´çš„æŒ‡å®šã€‚è¿™ä¸¤ä¸ªå‚æ•°å°±æ˜¯ç”¨äºæŒ‡å®šå’±disagree packet é‡Œé¢çš„è¿™ä¸ªbuffer è¿™ä¸ªå†…å®¹ï¼Œå®ƒå…·ä½“çš„å¯ç”¨åŒºé—´ã€‚é‚£ä¹ˆåé¢é‚£ä¸¤ä¸ªå‚æ•°æ˜¯ç”¨äºæŒ‡å®šå’±ä»¬çš„æ¥æ”¶è€…çš„ä¸€ä¸ªåœ°å€ä¿¡æ¯ã€‚å‰ä¸‰ä¸ªå‚æ•°æŒ‡å®šçš„æ˜¯buffer ä»¥åŠbuffer çš„ä¸€ä¸ªä½¿ç”¨ã€‚åé¢ä¸¤ä¸ªå‚æ•°ä¸»è¦æŒ‡å®šæ˜¯ç›®æ ‡æœºå™¨åœ°å€ä¸ç«¯å£ã€‚é‚£ä¹ˆè¿™ä¸ªç›®æ ‡æœºå™¨åœ°å€ä¸ç«¯å£ä»…ä»…ç”¨äºå‘é€æ—¶æœ‰æ•ˆã€‚é‚£ä¹ˆåœ¨å’±ä»¬å‘é€ä¸€ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œæ˜¯é€šè¿‡data grand package è¿™ä¸ªä¸œè¥¿æ¥æŒ‡å®šä½ å…·ä½“çš„æ¥æ”¶è€…çš„ä¸€ä¸ªä¿¡æ¯ã€‚ä»–çš„ä¿¡æ¯æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯é€šè¿‡è¿™äº›grand packet æ¥è¿›è¡Œè®¾ç½®å®ƒæ¥æ”¶çš„ä¿¡æ¯ã€‚æˆ‘ä»¬æƒ³è¦æ¥æ”¶åˆ«äººå‘è¿‡æ¥çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦ç”¨çš„æ˜¯è¿™æ˜¯grand socketï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å‰é¢ç”¨çš„è¿™æ˜¯grand socket å»è¿›è¡Œä¸€ä¸ªç›‘å¬ï¼Œè¿™ä¹Ÿæ˜¯è¿™ä¸ªgrand packet çš„ä¸€ä¸ªå„è‡ªå‡½æ•°ã€‚å‰é¢ä¸‰ä¸ªä¸ç”¨å¤šè¯´æ˜¯ä¸€æ ·çš„ã€‚é‚£ä¹ˆåé¢ä¼ é€’çš„æ˜¯ä¸€ä¸ªsocket addressã€‚å…¶å®socket address å…¶å®å°±ç›¸å½“äºelectorates åŠ quite electoratesï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªä»€ä¹ˆå‘€ç›®æ ‡ä¸»æœºçš„åœ°å€ï¼Œå†åŠ ä¸Šä¸€ä¸ªç«¯å£ï¼Œsocket å…¶å®ç›¸å¯¹ä¸¤è€…çš„ä¸€ä¸ªå°è£…ï¼Œä»¥åŠå®ƒçš„ä¸€äº›åè®®çš„å°è£…ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹data ground package çš„ä¸€äº›ä½¿ç”¨æ–¹é¢çš„ä¸€äº›ä¿¡æ¯ã€‚é‚£ä¹ˆé¦–å…ˆç¬¬ä¸€ç‚¹shed dataã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨æ„é€ å‡½æ•°åˆ›å»ºçš„æ—¶å€™ä¼ å…¥ä¸€ä¸ªå§ã€‚åŒç†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­ä¸ä¼ é€’ä»»ä½•ä¸œè¥¿ã€‚æˆ‘ä»¬ä¼ é€’æ— å‚æ„é€ å‡½æ•°ï¼Œç„¶ååœ¨åé¢çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬set data ç”¨äºæ›¿æ¢ä¸€ä¸ªbuffer éŸ³å¾‹ã€‚buffer å‘¢å¯ä»¥ä¼ é€’ä¸€ä¸ªbuffer è¿›å»ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªbad æ•°ç»„ã€‚ç„¶ååŒæ—¶æŒ‡å®šè¿™ä¸ªbad æ•°ç»„å½“ä¸­çš„ä¸€ä¸ªé•¿åº¦ä¿¡æ¯ã€‚æˆ‘ä»¬ç©¶ç«Ÿå“ªéƒ¨åˆ†æ•°æ®æ˜¯æœ‰æ•ˆçš„ï¼Ÿé‚£æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡ŒæŒ‡å®šï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸æŒ‡å®šä¿¡æ¯ã€‚é‚£ä¹ˆè‡ªç„¶ä¹Ÿå°±æ˜¯ä»é›¶å¼€å§‹åˆ°ä½ æ•´ä¸ªbuffer ç»“æŸï¼Œå°±ç”¨äºå•ç‹¬è®¾ç½®ä½ è¿™ä¸ªbuffer ç•™ä¸‹çš„åŒºé—´æœ‰å¤šé•¿å•Šï¼Ÿget data, get off, fit, get lunch. é‚£ä¹ˆè¿™ä¸‰ä¸ªæ–¹æ³•å‘¢å°±æ˜¯å‰é¢å®ƒçš„ä¸‰ä¸ªä¿¡æ¯çš„ä¸€ä¸ªè¿”å›ã€‚ç´§æ¥ç€æˆ‘ä»¬å¾€ä¸‹çœ‹ä¸€ä¸‹ä¸€äº›è®¾ç½®çš„ä¿¡æ¯ï¼Œsit to s å½“ç„¶è¿™é‡Œä¹Ÿæ˜¯ä¸€æ ·ï¼Œå°±æ˜¯è®¾ç½®ç›®æ ‡çš„åœ°å€ç«¯å£ä»¥åŠç›®æ ‡åœ°å€çš„ä¸€ä¸ªi p åœ°å€ä¿¡æ¯ã€‚get å‘¢ä¹Ÿæ˜¯ä¸€æ ·ï¼Œget address, get pot æ˜¯ä¸€æ ·çš„ã€‚åé¢å°±æ˜¯set scott dress å‰é¢æˆ‘ä»¬è¯´äº†scottish å…¶å®å°±ç›¸å½“äºæˆ‘ä»¬å‰é¢çš„i like dress å’Œpot çš„ä¸€ä¸ªå°è£…ã€‚å½“ç„¶äº†get socket dress å…¶å®ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ã€‚é‚£ä¹ˆè¿™é‡Œæˆ‘å†æ¬¡é‡ç”³ä¸€ä¸‹å’±ä»¬data grand package è¿™ä¸ªå½“ä¸­è®¾ç½®çš„è¿™ä¸ªç›®æ ‡åœ°å€ä»¥åŠç«¯å£ï¼Œå…¶å®æ˜¯ç”¨äºå‘é€æ—¶æœ‰æ•ˆã€‚åœ¨æˆ‘ä»¬æ¥æ”¶çš„æ—¶å€™å…¶å®æ˜¯æ— æ•ˆçš„ã€‚ä½ æŒ‡å®šçš„ç«¯å£æˆ–è€…æ˜¯ç›®æ ‡åœ°å€å…¶å®æ˜¯æ— æ•ˆçš„ã€‚åªæœ‰ä»…ä»…ç”¨äºä½ è¦æŠŠä¸€ä¸ªdescribe packet è¿™ä¸ªä¿¡æ¯å‘é€å‡ºå»çš„æ—¶å€™ï¼Œé‚£ä¹ˆè¿™ä¸ªæ˜¯æœ‰æ•ˆçš„ã€‚è€Œä½ æ¥å—çš„æ—¶å€™ï¼Œè¿™äº›ä¸œè¥¿æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿè¿™ä¸ªåœ¨ä½ æ¥è§¦çš„æ—¶å€™ï¼Œå…¶å®è¿™ä¸ªæ“ä½œæ˜¯ç”±ç³»ç»Ÿå¸®ä½ å®Œæˆçš„ã€‚å½“ä½ æ¥æ”¶åˆ°ä¸€ä¸ªæ•°æ®æŠ¥çš„æ—¶å€™ï¼Œç›¸å½“äºæ˜¯ä»–ä¼šæŠŠæŠ¥æ–‡è§£æä¹‹åç»™ä½ set è¿™ä¸ªä¿¡æ¯ï¼Œä»¥åŠset äº†ä½ çš„è¿™ä¸ªå…«ä»½ä¿¡æ¯ã€‚é‚£ä¹ˆä½ å°±å¯ä»¥æ‹¿åˆ°ä½ æ¥æ”¶åˆ°çš„å‘é€è¿‡æ¥çš„å°±æ˜¯è¯´ä½ æ˜¯ã€‚ä½ çš„ç”µè„‘æˆ‘çš„ç”µè„‘ç»™ä½ å‘çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥æ”¶åˆ°æˆ‘çš„ç”µè„‘çš„i p ä»¥åŠæˆ‘çš„ç”µè„‘çš„ç«¯å£ã€‚é‚£ä¹ˆä½ å°±èƒ½çŸ¥é“é‚£è¿™ä¸ªdata grandpa æ˜¯ä»å“ªä¸ªç”µè„‘çš„å“ªä¸ªç«¯å£ä¼ è¾“è¿‡æ¥çš„ã€‚é‚£ä¹ˆæˆ‘æƒ³è¦ç›‘å¬åˆ«äººå‘é€è¿‡æ¥æ•°æ®è‚¯å®šè¦æœ‰ä¸€ä¸ªç«¯å£ã€‚è¿™ä¸ªç«¯å£å‘¢å°±æ˜¯åœ¨å’±ä»¬çš„data grass socket å½“ä¸­æŒ‡å®šçš„ã€‚é‚£ä¹ˆæœ¬ç« èŠ‚è®²è§£äº†ä¸¤ä¸ªï¼Œæœ€ä¸»è¦çš„ç±»ä¹Ÿå°±æ˜¯data ground socket å’Œdata ground packet ä¸¤ä¸ªã€‚é€‚ç”¨äºå’±ä»¬u d p ä¼ è¾“å½“ä¸­çš„ä¸€ä¸ªä¸»è¦çš„a p iã€‚æˆ‘ä»¬ä¸»è¦çš„a p i è®²è§£ã€‚æœ€åå•Šæˆ‘ä»¬ä¸‹ä¸€ä¸ªç« èŠ‚è®²è§£ä¸€ä¸‹å’±ä»¬çš„ä¸€ä¸ªå¹¿æ’­ä»¥åŠå¤šæ’­çš„æ¦‚å¿µã€‚å¥½çš„ï¼Œè°¢è°¢å¤§å®¶ã€‚ 3.UDPå•æ’­ã€å¹¿æ’­ã€å¤šæ’­æˆ‘ä»¬å‰é¢å‘¢è¿›è¡Œäº†ä¸€äº›åŸºç¡€çš„ä¸€äº›ä¿¡æ¯çš„ä¸€äº›è®²è§£ï¼Œä»¥åŠå’±ä»¬a p içš„ä¸€ä¸ªè®²è§£ã€‚è¿™ä¸ªç« èŠ‚å‘¢ç»™å¤§å®¶è®²è§£ä¸€ä¸‹å’±ä»¬u d på½“ä¸­çš„ä¸€ä¸ªå•æ’­ã€å¤šæ’­ä»¥åŠå¹¿æ’­ä¸‰ä¸ªæ¦‚å¿µæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¦ç»™å¤§å®¶è®²è§£ä¸€ä¸‹ã€‚è¿™ä¹Ÿæ˜¯u d pæœ€åŒºåˆ«äºtcpçš„ä¸€ä¸ªåœ°æ–¹ï¼Œå°±æ˜¯å•æ’­ã€å¤šæ’­æˆ–è€…æ˜¯å¹¿æ’­ã€‚ç„¶åé¦–å…ˆç¬¬ä¸€ç‚¹ï¼Œå•æ’­ã€‚å’±ä»¬çš„å•æ’­ç©¶ç«Ÿæ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿå°±æ˜¯ç‚¹å¯¹ç‚¹ã€‚å‡å¦‚æˆ‘çš„ç”µè„‘å’Œä½ çš„ç”µè„‘ä¹‹é—´å‘ç”Ÿæ•°æ®ï¼Œä½ çš„ç”µè„‘ä¹Ÿå’Œæˆ‘çš„ç”µè„‘ä¹‹é—´å›é€æ•°æ®ï¼Œæˆ‘ä»¬ä¸¤ä¸ªæ•°æ®ä¸è¢«å…¶ä»–äººçš„ç”µè„‘æ‰€æ„ŸçŸ¥ï¼Œé‚£ä¹ˆè¿™å°±ç§°ä¹‹ä¸ºå•æ’­ã€‚ é¡¾åæ€ä¹‰ï¼Œå‡å¦‚ä½ åœ¨å…¬å¸ï¼Œä½ çš„è€æ¿å•ç‹¬æ¥è¯´ï¼Œæˆ‘æƒ³è¦æ‰¾ç¼–å·ä¸º89757çš„è¿™ä¸ªäººï¼Œå«ä»–æ¥æˆ‘æ¥åŠå…¬å®¤ä¸€è¶Ÿï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ç¼–å·89757ä¸€å®šæ˜¯ä¸€ä¸ªæŒ‡å®šçš„äººï¼Œä¸€å®šæ˜¯ä¸€ä¸ªå›ºå®šçš„äººï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±æ˜¯ä¸€ä¸ªå•æ’­ï¼Œé‚£ä¹ˆå°±ç›´æ¥æ‰¾åˆ°ä½ å¯¹å§ï¼Ÿä½ å°±æ˜¯89757ã€‚é‚£ä¹ˆæ‰¾åˆ°ä¸€ã€‚å°±æ˜¯ä½ æ‰€ä»¥è¯´è¿™å°±æ˜¯å•æ’­ç”¨äºå•çº¿ï¼Œä¸¤è€…ä¹‹é—´ä¸å…¶ä»–äººæ— å…³ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯å•æ’­çš„ä¸€ä¸ªæ¦‚å¿µã€‚è¦æ¥è¯´ä¸€ä¸‹ç¬¬äºŒç‚¹ï¼Œå¤šæ’­ã€‚ å¤šå¤šæ˜¯ä»€ä¹ˆæ„æ€å•Šå°±æ˜¯è¯´æˆ‘ä»¬ä»è¿™ä¸ªå›¾å½“ä¸­å¯ä»¥çœ‹å¾—å‡ºï¼Œçº¢è‰²çš„ç‚¹æ˜¯å’±ä»¬çš„ä¸€ä¸ªå‘é€è€…ï¼Œå¯¹å§ï¼Ÿæ¥å—çš„æ˜¯ä»€ä¹ˆæ¥å—è€…æœ‰é»„ç‚¹å’Œå’±ä»¬çš„ä¸€ä¸ªç»¿ç‚¹ï¼Œè€Œç»¿ç‚¹å‘¢ä¸‰ä¸ªéƒ½æ˜¯ç»¿ç‚¹é»„ç‚¹ä¸‰ä¸ªéƒ½æ˜¯é»„ç‚¹ã€‚å¤šæ’­æ˜¯ä»€ä¹ˆæ„æ€å•Šï¼Ÿå…¶å®å¤šæ’­å®ƒå¹¶ä¸å«å¤šæ’­ï¼Œå…¶å®åº”è¯¥å«åšç»„æ’­ï¼Œå®ƒæ˜¯ç»™ä¸€ç»„è®¾å¤‡å‘é€ã€‚è¿™ä¸ªå½“ä¸­å…¶å®å°±åˆ†ä¸ºäº†ä¸¤ä¸ªç»„ï¼Œä¸€ä¸ªç»„å‘¢æ˜¯å’±ä»¬çš„ä¸€ä¸ªç»¿è‰²ç»„æˆçš„ä¸€ä¸ªç»„ï¼Œè¿˜æœ‰ä¸€ä¸ªç»„å‘¢æ˜¯å’±ä»¬çš„è¿™ä¸ªé»„è‰²ç»„æˆçš„ç»„ã€‚é‚£ä¹ˆæˆ‘ç°åœ¨å‘å‡ºæ¥å°±æ˜¯ç»™æ‰€æœ‰ç»¿è‰²çš„è¿™äº›è®¾å¤‡å‘é€ä¿¡æ¯ï¼Œé‚£ä¹ˆé»„è‰²çš„è®¾å¤‡è‡ªç„¶å®ƒæ— æ³•æ¥æ”¶åˆ°è¿™ä¸ªä¿¡æ¯ï¼Œè¿™å°±ç§°ä¹‹ä¸ºå¤šæ’­ï¼Œæˆ–è€…æ˜¯å«åšç»„æ’­ï¼Œç»„æ’­æ›´ä¸ºæ°å½“ä¸€ç‚¹ã€‚å› ä¸ºå®ƒä¸æ˜¯è¯´ä½ ç»™å¤šä¸ªäººå‘çš„æ„æ€ï¼Œå®ƒå…¶å®æ˜¯ç»™ä¸€ä¸ªç»„å‘çš„ä¸€ä¸ªæ„æ€ã€‚é‚£ä¹ˆè¿™ä¸ªä¸œè¥¿ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œåœ¨ä½ åœ¨è¡—ä¸Šä½ ç›´æ¥è¯´ä¸€ä¸‹ï¼Œæ‰€æœ‰çš„ç”·ç”Ÿè¯·è¿‡æ¥ã€‚é‚£ä¹ˆè¿™æ—¶å€™ç”·ç”Ÿå’Œå¥³ç”Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œç”·ç”Ÿæ˜¯ä¸€ä¸ªç»„ï¼Œå¥³ç”Ÿä»¥åŠå…¶ä»–ä½ç½®æ€§åˆ«çš„ä¸€äº›äººï¼Œé‚£ä¹ˆå°±æ˜¯æ— å…³çš„ï¼Œå¯¹å§ï¼Ÿé‚£ä¹ˆä½ è¦çš„å…¶å®å°±æ˜¯æ˜¯ä¸€éƒ¨åˆ†ç”·æ€§çš„ä¸œè¥¿ï¼Œä½ è¦ç»™ä»–ä»¬ä¼ è¾“ä»€ä¹ˆã€è¯´ä»€ä¹ˆï¼Œè¿™æ˜¯ä½ çš„ä¿¡æ¯ï¼Œä½ è¦åšçš„äº‹æƒ…ä¸å…¶ä»–äººæ— å…³ï¼Œä»–ä»¬ä¹Ÿä¸ä¼šæ”¶åˆ°è¿™æ ·çš„ä¿¡æ¯ï¼Œè¿™å°±ç§°ä¹‹ä¸ºå¤šæ’­ã€‚ é‚£ä¹ˆæœ€åä¸€ç‚¹ä¹Ÿå°±æ˜¯å’±ä»¬çš„å¹¿æ’­ï¼Œå¹¿æ’­æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ å°±æ˜¯ç»™æ‰€æœ‰çš„è®¾å¤‡éƒ½å‘é€ä¿¡æ¯ï¼Œé‚£ä¹ˆè¿™å°±ç§°ä¹‹ä¸ºå¹¿æ’­ã€‚å°±æ˜¯ä¸€ä¸ªå±€åŸŸç½‘å†…çš„æ‰€è°“è®¾å¤‡ï¼Œæˆ–è€…æ˜¯ä½ ç»™ä½ å±€åŸŸç½‘ä»¥å¤–çš„è®¾å¤‡å‘é€ä¸€ä¸ªå¹¿æ’­ã€‚é‚£ä¹ˆè¿™é‡Œè¦è¯´çš„ï¼Œå’±ä»¬çš„å¹¿æ’­ä¸€å®šæ¯”å¤šæ’­æ›´å¼ºå˜›ï¼Ÿå…¶å®ä¸æ˜¯çš„ï¼Œå…¶å®æœ€å…ˆå‡ºæ¥çš„æ¦‚å¿µæ˜¯å•æ’­ï¼Œç„¶åæ˜¯å¹¿æ’­ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå’±ä»¬çš„titleå«åšå•æ’­å¹¿æ’­ï¼Œæœ€åæ‰æ˜¯å¤šæ’­ã€‚å…¶å®å¤šæ’­æ˜¯åé¢å‡ºæ¥çš„æ¦‚å¿µï¼Œè€Œå¤šæ’­è¿™ä¸ªæ¦‚å¿µå®ƒå…¶å®æ¶µç›–äº†å•æ’­ä¸å¹¿æ’­çš„ä¼˜ç‚¹ã€‚å¹¿æ’­æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿå¹¿æ’­å°±æ˜¯ä½ åœ¨å®ƒå¹¿åœºä¸Šæ‹¿ç€ä¸€ä¸ªå–‡å­ç›´æ¥å¼äº†ä¸€å¥ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„äººï¼Œæ— è®ºç”·å¥³è€å°‘ï¼Œå…¨éƒ¨éƒ½èƒ½æ”¶åˆ°ä½ çš„è¿™ä¸ªä¿¡æ¯å¯¹å§ï¼Ÿé‚£ä¹ˆè‡³äºç©¶ç«Ÿæœ‰å“ªäº›äººçœŸæ­£æœ‰ç”¨ï¼Œé‚£è¿™å°±æ˜¯æ— å¹²çš„äº†ã€‚å°±æ¯”å¦‚ä½ åœ¨å¹¿åœºä¸Šç›´æ¥æ‹¿ç€å¹¿æ’­ï¼Œå¼äº†ä¸€å¥ï¼Œæ‰€æœ‰çš„å¹´è½»äººè¯·è¿‡æ¥ä¸€ä¸‹ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™è™½ç„¶è¯´ä½ è¦çš„æ˜¯å¹´è½»äººï¼Œä½†æ˜¯ä½ åœ¨å¹¿åœºä¸Šç›´æ¥ç”¨å–‡å­å»å¼çš„ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„å¹´è½»äººã€è€å¹´äººæˆ–è€…æ˜¯å°å­©ã€æˆ–è€…æ˜¯ç”·ç”Ÿã€å¥³ç”Ÿéƒ½èƒ½æ”¶åˆ°ä½ çš„ä¿¡æ¯ã€‚è€Œä¹‹æ‰€ä»¥åªæœ‰è¿™éƒ¨åˆ†å¹´è½»äººè¿‡æ¥äº†ï¼Œæ˜¯å› ä¸ºå…¶ä»–è®¾å¤‡è®¤ä¸ºè¿™ä¸ªä¿¡æ¯ä¸æˆ‘æ— å…³ï¼Œæ‰€ä»¥è¯´ä»–å°±é€‰æ‹©äº†ä¸å¤„ç†ã€‚é‚£ä¹ˆè¿™å°±æ˜¯å¹¿æ’­ï¼Œå¹¿æ’­å°±æ˜¯è¯´ä½ å¯¹ä½ æ‰€åœ¨çš„ã€‚ç½‘æ®µä¹‹å†…çš„æ‰€æœ‰è®¾å¤‡ç›´æ¥å‘é€ä¸€æ¡ä¿¡æ¯ï¼Œç©¶ç«Ÿè¿™ä¸ªç½‘æ®µä¹‹å†…å“ªäº›è®¾å¤‡å¯¹ä½ è¿™ä¸ªä¿¡æ¯æ„Ÿå…´è¶£ï¼Œé‚£ä¹ˆå°±æ˜¯å¯¹ä½ çš„è®¾å¤‡åº”è¯¥è¦åšçš„äº‹æƒ…çš„ä¸€ä¸ªå¤„ç†äº†ã€‚é‚£ä¹ˆå½“ç„¶è¿™ä¼šæ‰¾åˆ°é€ æˆçš„é—®é¢˜ï¼Œå°±æ˜¯å¦‚æœè¯´ä¸€æ—¦æŸä¸€ä¸ªè®¾å¤‡æˆ–è€…æ˜¯æŸä¸€æ‰¹è®¾å¤‡ä¸€ç›´å‘é€å¹¿æ’­çš„è¯ï¼Œä¼šå¯¼è‡´å’±ä»¬çš„ä¸€ä¸ªå±€åŸŸç½‘æˆ–è€…æ˜¯æŸä¸€ä¸ªç½‘ç»œæ®µä¹‹ç±»çš„ä¸€äº›ä¿¡æ¯å¸¦å®½è¢«å æ»¡ï¼Œä¹Ÿå°±å¯¼è‡´äº†å’±ä»¬çš„ä¸€ä¸ªä¿¡æ¯çš„ä¸€ä¸ªæ··ä¹±ã€‚æ‰€ä»¥è¯´å’±ä»¬ç°åœ¨çš„è·¯ç”±å™¨éƒ½å…·å¤‡ä¸€ä¸ªæ‹’ç»å‘é€å¹¿æ’­çš„ä¸€ä¸ªç­–ç•¥ã€‚å½“ä½ çš„å¹¿æ’­å‘é€å‡ºå»ä¹‹åï¼Œä¸€èˆ¬è€Œè¨€ä»…ä»…åªèƒ½å¤Ÿåœ¨ä½ çš„è·¯ç”±å™¨å†…éƒ¨è¿›è¡Œå¹¿æ’­ï¼Œè€Œä¸èƒ½åœ¨ä½ è·¯ç”±å™¨ä»¥å¤–çš„åœ°æ–¹å»å¹¿æ’­ã€‚æˆ‘ç°åœ¨åœ¨æˆ‘å®¶é‡Œé¢æˆ‘å‘ä¸€ä¸ªå¹¿æ’­ï¼Œä½ å®¶é‡Œé¢çš„ç”µè„‘èƒ½æ”¶åˆ°å—ï¼Ÿè‚¯å®šä¸èƒ½å•Šï¼Œè¿™å°±æ˜¯å› ä¸ºæˆ‘çš„å¹¿æ’­å‘é€ä¹‹åï¼Œåœ¨æˆ‘å®¶çš„è·¯ç”±å™¨ä¸Šé¢å·²ç»è¢«æ‹¦æˆªäº†ï¼Œä»…ä»…åªåœ¨å’±ä»¬å®¶é‡Œé¢çš„è¿™ä¸ªè·¯ç”±å™¨ä¸‹é¢çš„è¿™ã€‚è®¾å¤‡ä¹‹é—´è¿›è¡Œå¹¿æ’­ï¼Œè€Œè·¯ç”±å™¨ä»¥å¤–çš„è®¾å¤‡æ˜¯æ— æ³•æ„ŸçŸ¥çš„ã€‚è€Œå¤šæ’­çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ å®ƒèƒ½å¤Ÿç›´æ¥ç»™æŒ‡å®šçš„è®¾å¤‡å‘é€è¿™äº›ä¿¡æ¯ã€‚é‚£åŒç†ï¼Œæˆ‘ä»¬ä¸¾çš„å¹¿åœºä¸Šå¼å–‡å­çš„è¿™ä¸ªä¾‹å­æ¥è¯´ï¼Œæˆ‘ä»¬ä¹‹å‰è¯´çš„æ˜¯æˆ‘ä»¬ç›´æ¥å»å¼å–‡å­ï¼Œè¿™ä¸ªæ—¶å€™å‘¢æˆ‘ä»¬æ¢ä¸€ç§ä¸œè¥¿ã€‚æˆ‘çœ‹è§ä¸‹é¢æœ‰ç”·ç”Ÿã€æœ‰å¥³ç”Ÿã€æœ‰å¹´è½»äººå¯¹å§ï¼Œæˆ‘è¿™æ—¶å€™ç›´æ¥è¿‡å»ï¼Œæˆ‘æŠŠæ‰€æœ‰çš„ç”·æ€§å…¨éƒ¨æŒ‘å‡ºæ¥ï¼ŒæŒ‘å‡ºæ¥ä¹‹åæˆ‘ç›´æ¥å¯¹è¿™ä¸€éƒ¨åˆ†ç”·æ€§è¯´ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘è™½ç„¶ä¹Ÿæ˜¯ç›´æ¥å¯¹ä¸€æ‰¹äººè¯´ï¼Œä½†æ˜¯æˆ‘æå‰ä¼šè¿›è¡Œä¸€æ­¥ä»€ä¹ˆç­›é€‰ï¼Œæˆ‘èƒ½å¤Ÿæå–å‡ºæˆ‘çœŸæ­£æœ‰ç”¨çš„è¿™ä¸€éƒ¨åˆ†çš„è®¾å¤‡ï¼Œç„¶åæˆ‘å†å¯¹è¿™ä¸€éƒ¨åˆ†è®¾å¤‡è¿›è¡Œå‘é€ä¿¡æ¯ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å‘¢æˆ‘è¿™ä¸€æ‰¹è®¾å¤‡ä¸€å®šæ˜¯å¯¹è¿™ä¸ªä¸œè¥¿æ„Ÿå…´è¶£ã€‚æˆ‘å¯¹æ¥ä¿¡çš„è¿™éƒ¨åˆ†äººè¯´ï¼Œæˆ‘ç»™ä½ ä»¬ä»‹ç»ä¸€ä¸ªæ‰¾å¥³æœ‹å‹çš„æœºä¼šå¯¹å§ï¼Œé‚£ä¹ˆè¿™ä¸ªäº‹å°±æ˜¯æˆ‘å¯¹ä»–ä»¬è¯´çš„å¿ƒï¼Œä»–ä»¬éƒ½æ˜¯æ„Ÿå…´è¶£çš„ã€‚è¿™å°±æ˜¯å¤šæ’­ä¸å¹¿æ’­ä¹‹é—´çš„åŒºåˆ«ï¼Œå¤šæ’­ä»–ä¸€å®šæ˜¯èƒ½å¤Ÿå…ˆè¿›è¡Œä¸€å®šçš„åˆ†ç»„ä»¥åŠç­›é€‰ä¹‹åæˆ‘ç›´æ¥å¯¹è¿™ä¸€éƒ¨åˆ†æ•°æ®å‘é€æ•°æ®ã€‚å®ƒçš„ä¼˜åŠ¿æ˜¯æ¯”å¹¿æ’­æ›´å¥½ï¼Œæ€§èƒ½ä¹Ÿæ›´ä¼˜è¶Šï¼Œä½†æ˜¯å®ƒç›¸å¯¹å®ç°èµ·æ¥è¦å¤æ‚ä¸€ç‚¹ã€‚å½“ç„¶å¤šæ’­å…¶å®æœ‰ä¸“é—¨çš„å¤šæ’­çš„ä¸€ä¸ªåœ°å€å¹¿æ’­æœ‰å¹¿æ’­çš„åœ°å€ï¼Œè€Œæˆ‘ä»¬å¸¸ç”¨çš„å…¶å®è¿™ä¸ªå¹¿æ’­ã€‚æ‰€ä»¥è¯´å’±ä»¬åé¢æœ‰ä¸ªä¾‹å­å‘¢å…¶å®ä¹Ÿæ˜¯ç”¨çš„ä¸€ä¸ªå¹¿æ’­ã€‚å¤šæ’­å‘¢å¤§å®¶å¯ä»¥äº†è§£ä¸€ä¸‹ï¼Œåœ¨ä»Šåçš„ä¸€äº›å®ç°å½“ä¸­å‘¢ï¼Œè‡ªå·±å»å®ç°ä¸€ä¸‹å’±ä»¬çš„ä¸€ä¸ªå¤šæ’­ï¼Œå…¶å®å¤šæ’­æ¯”å¹¿æ’­æ›´ä¼˜è¶Šã€‚å½“ç„¶å•æ’­å…¶å®è¿™ä¸ªä¸œè¥¿ä½ åªæ˜¯è¯´ç‚¹å¯¹ç‚¹ä¹‹é—´æ˜¯éå¸¸ä¼˜è¶Šçš„ã€‚å¦‚æœè¯´ä½ æƒ³è¦ä¸€æ¬¡æ€§å¯¹å…­ä¸ªäººå‘æ¶ˆæ¯ï¼Œé‚£ä¹ˆä½ é‡‡ç”¨ç‚¹å¯¹ç‚¹çš„è¯ï¼Œä½ éœ€è¦ç»™å…­ä¸ªç›®æ ‡åœ°å€é‡å¤å‘ï¼Œé‚£ä¹ˆè¿™æ˜¯ä½ éœ€è¦å‘å…­æ¬¡ã€‚è€Œå¤šä¹ˆå’Œå¹¿æ’­å‘¢å…¶å®ä½ åªéœ€è¦å‘ä¸€æ¬¡ï¼Œä½ å¹¶ä¸æ˜¯è¯´ä½ ç»™è¿™äº›äººå‘äº†è¿™ä¹ˆå¤šæ¬¡ï¼Œä½ ä»…ä»…åªéœ€è¦å‘ä¸€æ¬¡ã€‚è‡³äºä»–ä»¬æ€ä¹ˆæ”¶åˆ°è¿™ä¸ªä¿¡æ¯ï¼Œæ˜¯ç”±è·¯ç”±å™¨æ¥è´Ÿè´£è½¬æ’­çš„é‚£ä¹ˆã€‚è¿™ä¸ªæ“ä½œè¿‡ç¨‹å½“ä¸­ä¸éœ€è¦ä½ è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥è¯´ä½ ç”µè„‘çš„så¸¦å®½ä»¥åŠä½ ç”µè„‘cpuçš„æ€§èƒ½æ¶ˆè€—æ˜¯éå¸¸ä½çš„ã€‚å‰é¢è¯´äº†å•æ’­å¹¿æ’­ä»¥åŠå’±ä»¬çš„å¤šæ’­ã€‚é‚£ä¹ˆæ¥è¯´ä¸€ä¸‹ï¼Œå…·ä½“è¿™å‡ è€…ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¿™å°±æ¶‰åŠåˆ°ipåœ°å€ä¸€ä¸ªç±»åˆ«çš„ä¸€ä¸ªé€‰æ‹©äº†ã€‚ è¿™æ˜¯ä¸€ä¸ªabc deäº”ä¸ªç½‘ç»œipåœ°å€çš„ä¸€ä¸ªç±»åˆ«çš„ä¸€ä¸ªå›¾ï¼Œaç±»åœ°å€å‘¢ä¹Ÿå°±æ˜¯å’±ä»¬æœ€å¤–å›´çš„ä¸€éƒ¨åˆ†çš„åœ°å€ã€‚é‚£ä¹ˆè¿™éƒ¨åˆ†ç‚¹å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œå·²ç»è¢«åˆ†é…å®Œæˆäº†ï¼Œå¯¹å§ï¼Ÿå•Šbç±»ä»¥åŠå’±ä»¬çš„cç±»ï¼Œå…¶å®æˆ‘ä»¬å¸¸è§„ä½¿ç”¨çš„å®¶åº­é‡Œé¢çš„è¿™éƒ¨åˆ†è®¾å¤‡éƒ½æ˜¯å±äºcç±»çš„ã€‚æˆ‘ä»¬çš„å­ç½‘æºç ä¸€èˆ¬è€Œè¨€éƒ½æ˜¯äºŒäº”äº”ç‚¹äºŒäº”ç‚¹é›¶ã€‚å…¶å®æˆ‘ä»¬å¯ä»¥çœ‹å¾—å‡ºï¼ŒæŒ‡å¾€å¹´å˜›ï¼Œabcåˆ†åˆ«æ˜¯å‰é¢æ¯åˆ°åé¢å°±å¤šäº†ä¸€ä¸ªäºŒäº”ï¼Œå¯¹å§ï¼Ÿé‚£ä¹ˆåˆ°æˆ‘ä»¬çš„cnçš„æ—¶å€™ï¼Œå…¶å®äºŒäº”äº”åé¢æ˜¯ç‚¹åï¼Œç„¶åæˆ‘ä»¬çš„ipåœ°å€ä¸€èˆ¬è€Œè¨€æ˜¯å¹ºä¹ã€‚äºŒç‚¹å¹ºå…­å…«ç‚¹å¤šå°‘å¤šå°‘ï¼Œå¯¹å§ï¼Ÿæ‰€ä»¥è¯´è¿™å°±æ˜¯å¹ºä¹äºŒåˆ°äºŒäºŒä¸‰ä¹‹é—´ï¼Œè¿™å°±æ˜¯å±äºå’±ä»¬cç±»çš„ä¸€ä¸ªåœ°å€ã€‚ç¬¬ä¸€ç±»å‘¢æ˜¯ä»äºŒäºŒå››åˆ°äºŒä¸‰ä¹ä¹‹é—´çš„ä¸€ä¸ªåŸºå‡†ã€‚è¿™ä¸ªåœ°å€å‘¢æ˜¯ä¸“é—¨ä¸ºå¤šæ’­é¢„ç•™çš„ï¼Œæ‰€ä»¥è¯´å¤šæ’­ä¹‹æ‰€ä»¥æ¯”å¹¿æ’­æ›´ä¼˜è¶Šï¼Œä¹Ÿæ˜¯å› ä¸ºå¤šæ’­å®ƒæ˜¯ä¸“é—¨æœ‰ä¸€éƒ¨åˆ†åœ°å€ç”¨äºå¤šæ’­çš„ï¼Œè¿™éƒ¨åˆ†åœ°å€æ˜¯ä¸€ä»½é¢„ç•™çš„åœ°å€ï¼Œè¿™æ˜¯èƒ½å¤Ÿè¢«æ‰€æœ‰çš„è·¯ç”±å™¨æ‰€æ„ŸçŸ¥çš„ï¼Œæ‰€ä»¥å¤šæ’­å…¶å®æ˜¯æ›´ä¸ºä¼˜è¶Šçš„ã€‚é‚£ä¹ˆä¸€ç±»åœ°å€å‘¢æ˜¯å®éªŒæ€§çš„ï¼Œç”¨äºç ”ç©¶çš„ï¼Œé‚£ä¹ˆè¿™éƒ¨åˆ†åœ°å€æˆ‘ä»¬ä¸åšè€ƒç©¶ã€‚ æ¥è¯´ä¸€ä¸‹æˆ‘ä»¬æ€ä¹ˆæ ·å»å¾—åˆ°ä¸€ä¸ªå¹¿æ’­åœ°å€ã€‚é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹äºŒäº”ï¼Œäº”ç‚¹äºŒäº”ç‚¹äºŒäº”ï¼Œå››ä¸ªäºŒäº”å…¶å®æ˜¯ä¸€ä¸ªå—é™çš„å¹¿æ’­åœ°å€ã€‚å‡å¦‚ä½ å¾€è¿™ä¸ªäºŒäº”äº”ç‚¹äºŒäº”ç‚¹äºŒäº”è¿™ä¸‹é¢çš„ä¸¤åƒç«¯å£å·å‘é€ä¸€ä¸ªä¿¡æ¯ï¼Œå…¶å®åªæœ‰ä½ çš„å±€åŸŸç½‘å†…çš„è®¾å¤‡èƒ½å¤Ÿæ”¶åˆ°ä½ å‘é€è¿™ä¸ªä¿¡æ¯ã€‚è‡³äºä»–ç©¶ç«Ÿå¯¹è¿™ä¸ªä¿¡æ¯æ„Ÿä¸æ„Ÿå…´è¶£ï¼Œå°±çœ‹ä»–å¯¹æ²¡å¯¹ä¸¤åƒçš„è¿™ä¸ªç«¯å£è¿›è¡Œç›‘å¬ã€‚é‚£ä¹ˆcç½‘çš„ä¸€ä¸ªå¹¿æ’­åœ°å€ä¸€èˆ¬è€Œè¨€æ˜¯å‰é¢ä¸‰ä½å½“ç„¶æ˜¯ä¸å›ºå®šçš„ï¼Œé‚£å½“ç„¶äº†ç¬¬ä¸€ä½æ˜¯å›ºå®šçš„å¹ºä¹äºŒå¯¹å§ï¼Œç¬¬ä¸€ä½æ˜¯å’±ä»¬çš„å¹ºä¹äºŒåˆ°äºŒäºŒä¸‰ï¼Œè‡³äºåé¢ä¸¤ä¸ªå‘¢æ˜¯ä¸å›ºå®šçš„ã€‚å’±ä»¬åé¢çš„ä¸€ä¸ªå°±æ˜¯äºŒäº”äº”ï¼Œè¿™æ˜¯å’±ä»¬çš„ä¸€ä¸ªéç½‘çš„ä¸€ä¸ªå¹¿æ’­åœ°å€ã€‚ä¸€èˆ¬è€Œè¨€å°±æ˜¯å¹ºä¹äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºç‚¹äºŒäº”äº”ã€‚å¦‚æœè¯´ä½ æƒ³è¦ä¸ºä½ å®¶é‡Œé¢çš„è·¯ç”±å™¨ä¸‹é¢çš„æ‰€æœ‰è®¾å¤‡å‘é€ä¸€ä¸ªå¹¿æ’­å‘¢ï¼Œä¸¤ä¸ªåŠæ³•ã€‚ä¸€ä¸ªå‘¢æ˜¯å‘é€å…¨äºŒäº”äº”çš„ä¸€ä¸ªæˆæƒå¹¿æ’­åœ°å€ï¼Œæˆ–è€…æ˜¯ç›´æ¥å‘é€å¹ºä¹äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºç‚¹äºŒäº”ï¼Œè¿™å°±æ˜¯ç»™ä½ ä¸‹é¢çš„è®¾å¤‡å‘é€ä¸€ä¸ªå¹¿æ’­ã€‚å½“ä½ é™¤äº†ç»™cç½‘ï¼Œè¿˜å¯ä»¥ç»™bç½‘çš„ä¸€ä¸ªå­ç½‘æ®µä¸‹é¢çš„è®¾å¤‡å‘é€ä¸€ä¸ªå¹¿æ’­ï¼Œé‚£ä¹ˆè¿™å°±æ¶‰åŠåˆ°ä½ ä¸åŒçš„å¹¿æ’­åœ°å€çš„è¿ç®—äº†ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå’±ä»¬çš„å¹¿æ’­åœ°å€å°±æ˜¯æœ€åä¸€ä½ä¸ºäºŒäº”äº”ã€‚ç¬¬ä¸€ç±»çš„ipåœ°å€ä¸ºå¤šæŠ¥é¢„ç•™ï¼Œè¿™æ˜¯æˆ‘ä»¬å‰é¢è®²è¿‡çš„ã€‚æ¥çœ‹ä¸€ä¸‹å’±ä»¬çš„ä¸€ä¸ªå¯»å¸¸çš„ä¸€ä¸ªç½‘ç»œä¿¡æ¯ã€‚è¿™æ˜¯æˆ‘çš„ç”µè„‘çš„ä¸€ä¸ªä¿¡æ¯ã€‚ å¯ä»¥çœ‹å‡ºæˆ‘çš„ç”µè„‘çš„ä¸€ä¸ªä¿¡æ¯æ˜¯ipvå››åœ°å€å¯¹å§ï¼Œå¹ºä¹äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºäºŒã€å››ç‚¹ä¸ƒï¼Œè¿™æ˜¯æˆ‘çš„ipåœ°å€ã€‚é‚£ä¹ˆæˆ‘çš„è·¯ç”±å™¨çš„åœ°å€æ˜¯å¤šå°‘å‘¢ï¼Ÿå¹ºä¹äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºäºŒå››ç‚¹å¹ºï¼Œå¯¹å§ã€‚æˆ‘çš„æŒ‡æœ›é¢œç æ˜¯äºŒäº”äº”ç‚¹äºŒäº”ç‚¹äºŒäº”äº”ç‚¹é›¶ï¼Œè¿™æ˜¯æˆ‘çš„æŒ‡æœ›é‡é©¬ã€‚è€ŒæŒ‡æœ›é‡é©¬å‘¢ä¸€èˆ¬ã€‚è€Œè¨€ï¼Œæœ€åä¸€ä½æ˜¯æ‚¨ï¼Œä½†æ˜¯æ‚¨å¹¶ä¸æ˜¯ç™¾åˆ†ç™¾çš„ã€‚æˆ‘ä»¬å‰é¢çš„ä¸‰ä½æ˜¯å›ºå®šçš„äºŒäº”äº”ç‚¹äºŒäº”ç‚¹äºŒäº”ï¼Œé‚£ä¹ˆåé¢ä¸€ä½å¹¶ä¸ä¸€å®šå°±æ˜¯é›¶ï¼Œå‰é¢ä¸‰ä½éƒ½æ˜¯äºŒäº”ï¼Œå°±æ˜¯cç½‘åœ°å€ã€‚é‚£ä¹ˆæœ€åä¸€ä¸ªå‘¢å–å†³äºå’±ä»¬çš„ä¸€ä¸ªè·¯ç”±å™¨çš„ä¸€ä¸ªåˆ†é…ç­–ç•¥ã€‚æˆ‘ä»¬åé¢æ¥çœ‹ä¸€ä¸‹ipåœ°å€çš„ä¸€ä¸ªæ„æˆã€‚ è¿™æ˜¯ä¸€ä¸ªipåœ°å€ï¼Œå¹ºä¹äºŒç‚¹å¹ºå…­å…«ç‚¹ä¸€ç™¾ç‚¹ä¸€ï¼Œæˆ‘ä»¬æŠŠå®ƒåˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼Œå…¶å®å››ä¸ªéƒ¨åˆ†åŠ åœ¨ä¸€èµ·ï¼Œæ¯ä¸€ä¸ªéƒ¨åˆ†å‘¢æ˜¯ä¸€ä¸ªintï¼Œå¯¹å§ï¼Ÿå…¶å®å‘¢æ­£æ–¹æˆ‘ä»¬ç”¨çš„ä¸æ˜¯ä¸€ä¸ªç¡¬çš„å»å­˜å‚¨è¿™ä¸ªå€¼ï¼Œè¿™ä¸€ä¸ªæ•´ä½“å‘¢æ˜¯ç”¨äº†ä¸€ä¸ªä»€ä¹ˆçŸ­ç‚¹å‹å»å­˜å‚¨çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªå…«ä½è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå…«ä½ã€‚å…¶å®è¿™ä¸ªä¸œè¥¿ç”¨ä¸€ä¸ªbatè¿™ä¸€ä¸ªbad caseï¼Œä¸€å…±å°±æ˜¯å››ä¸ªæ¯”ç‰¹ï¼Œå››ä¸ªå­—èŠ‚å»æƒ©å¤„å®ƒã€‚é‚£ä¹ˆå…¶å®å››ä¸ªå­—èŠ‚å°±æ˜¯intï¼ŒæŒ‡å’±ä»¬çš„ä¸€ä¸ªipåœ°å€ï¼Œç”¨ä¸€ä¸ªintå€¼å…¨éƒ¨å°±å¯ä»¥å®Œæˆã€‚å°±æ˜¯æœ‰äººè¯´ã€‚æ˜æ˜è¿™é‡Œæ˜¯å››ä¸ªintå¯¹å§ï¼Ÿé‚£ä¹ˆè¿™é‡Œè¦è¯´çš„æ˜¯è¿™ä¸ªåœ°æ–¹çš„å››ä¸ªinputï¼Œå®ƒæœ€å¤§æ•°æ˜¯å¤šå°‘æ˜¯é›¶åˆ°å¤šå°‘ï¼Œé›¶åˆ°äºŒäº”æˆ–è€…æ˜¯è´Ÿçš„å¹ºäºŒä¸ƒåˆ°å¹ºäºŒå…«ä¹‹é—´ï¼Œå¯¹ä¸å¯¹ï¼Ÿé‚£ä¹ˆè¿™æ˜¯å’±ä»¬çš„ä¸€ä¸ªèŒƒå›´ã€‚é‚£ä¹ˆè¿™ä¸ªèŒƒå›´å‘¢å…¶å®å¹¶ä¸æ˜¯å ç”¨äº†ä¸€ä¸ªå…¨éƒ¨çš„intçš„å€¼èŒƒå›´ï¼Œæˆ‘ä»¬æŠŠå®ƒè¿›è¡Œä¸€å®šçš„æ¦‚æ‹¬ä¹‹åçš„è¯ï¼Œåœ¨ä¸‹é¢å¯ä»¥çœ‹å¾—å‡ºå…¶å®æ˜¯å…«ä½å…«ä½åŠ å…«ä½ï¼Œå…¶å®è¿™ä¸€å…±å°±æ˜¯é«˜å…«ä½ä»¥åŠä½å…«ä½çš„ä¸€ä¸ªè¿‡ç¨‹å˜›å¯¹å§ï¼Ÿæˆ‘ä»¬æŠŠå››ä¸ªå…«ä½åŠ åœ¨ä¸€èµ·å…¶å®å°±æ˜¯ä¸‰åäºŒä½ï¼Œä¸‰åäºŒä½å…¶å®å°±ç›¸å½“äºä¸€ä¸ªintentå€¼ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸€ä¸ªä¸œè¥¿å…¨éƒ¨åŠ åœ¨ä¸€èµ·ï¼Œå…¶å®å¯ä»¥ç›´æ¥æ„æˆä¸€ä¸ªintentå€¼ã€‚é‚£ä¹ˆæ¥çœ‹ä¸€ä¸‹å¹ºä¹äºŒï¼Œå…¶å®å°±æ˜¯å¹ºå¹ºåé¢å…­ä¸ªé›¶å¯¹å§ï¼Œè¿™ä¸ªåœ°æ–¹æ¯”è¾ƒé‡è¦ã€‚å¹ºä¹äºŒå‰é¢ä¸¤ä½æ˜¯å¹ºå¹ºï¼Œåé¢å‡ ä½æ˜¯é›¶ã€‚è€Œæœ€åä¸€ä¸ªç‚¹å¹ºçš„è¯é‚£ä¹ˆå°±æ˜¯æœ€åä¸€ä¸ªä¸ºé›¶ï¼Œè¿™ä¸ªä¸œè¥¿å‘¢æ¶‰åŠåˆ°ä¸€ä¸ªäºŒè¿›åˆ¶çš„ä¸€ä¸ªè½¬æ¢ï¼Œé‚£ä¹ˆè¿™ä¸ªç‚¹å¤§å®¶è®°ä¸€ä¸‹å°±å¥½ã€‚æ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬ä¸€ä¸ªå¹¿æ’­åœ°å€çš„ä¸€ä¸ªè¿ç®—ã€‚å¹¿æ’­åœ°å…¶å®æ˜¯å¯ä»¥è¿ç®—å‡ºæ¥çš„ï¼Œè€Œä¸æ˜¯å›ºå®šçš„ã€‚æ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„ipåœ°å€ï¼Œå°±æ‹¿æˆ‘çš„ç”µè„‘æ¥è¯´ï¼Œå¹ºä¹äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºäºŒã€å››ç‚¹ä¸ƒå¯¹å§ï¼Œå°±æ˜¯æˆ‘çš„ç”µè„‘çš„ipåœ°å€ã€‚è€Œæˆ‘çš„ç£ç½‘æºç æ˜¯å¤šå°‘å‘¢ï¼Ÿæ˜¯äºŒäº”äº”ç‚¹äºŒäº”ç‚¹äºŒã€äº”ç‚¹é›¶ã€‚äºŒäº”äº”ç›¸å½“äºä»€ä¹ˆäºŒäº”äº”ç›¸å½“äºæˆ‘ä»¬å‰é¢åˆšåˆšè¯´çš„é‚£ä¸ªåœ°æ–¹æ˜¯å¤šå°‘ä¸‰åäºŒä½å¯¹å§ä¸‰åäºŒä½å½“ä¸­åˆ†ä¸ºå…«ä½å…«ä½å…«ä½å…«ä½çš„å¯¹å§åˆ†åˆ«æ˜¯å››ä¸ªå…«ä½ï¼Œé‚£ä¹ˆäºŒäº”äº”å°±ç›¸å½“äºå…«ä½å…¨éƒ¨ä¸ºä¸€é›¶å°±ç›¸å½“äºå…«ä½å…¨éƒ¨ä¸ºé›¶å¯¹å§ï¼Œæ‰€ä»¥å‰é¢å°±æ˜¯å…«ä½å…¨éƒ¨å”¯ä¸€å…«ä½åé¢å…¨éƒ¨ä¸ºé›¶ã€‚é‚£ä¹ˆæˆ‘çš„ç½‘ç»œåœ°å€æ˜¯å¤šå°‘å‘¢ï¼Ÿæˆ‘çš„ç½‘ç»œåœ°å€å…¶å®ç›¸å½“äºå°±æ˜¯æŠŠä¸€å’Œä¸Šé¢çš„è¿™ä¸ªä¸œè¥¿è¿›è¡Œä¸€ä¸ªä»¥åè¿ç®—ï¼Œé‚£ä¹ˆæœ€åå¾—åˆ°çš„å°±æ˜¯å¹ºä¹äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºäºŒã€å››ç‚¹é›¶ï¼Œå› ä¸ºæˆ‘æœ€åä¸€ä½æ˜¯é›¶ï¼Œé‚£ä¹ˆæ‚¨ä¸å‰é¢çš„æ¯ä¸€ä¸ªè¿ç®—ä¸­å…¶å®å°±æ˜¯ä¸€ä¸ªé›¶ã€‚é‚£ä¹ˆæˆ‘çš„å¹¿æ’­åœ°å€æ˜¯å¤šå°‘å‘¢ï¼Ÿå‰é¢çš„ã€‚ä¸ªç½‘æ®µçš„æœ€åä¸€ä½å°±æ˜¯æˆ‘çš„å¹¿æ’­åœ°å€æˆ‘å‰é¢ç½‘ç»œåœ°å€ï¼Œè¿™ä¸ªç½‘æ®µç£ç½‘æºç æ˜¯äºŒäº”äº”ç‚¹äºŒäº”ç‚¹é›¶ã€‚é‚£ä¹ˆæˆ‘å…·å¤‡çš„è®¾å¤‡æ˜¯å¤šå°‘å¤šå°‘ä½ï¼Ÿæˆ‘åŸºæœ¬çš„è®¾å¤‡æ˜¯äºŒç™¾äº”åäº”ä¸ªè®¾å¤‡æˆ‘å…è®¸åˆ†é…äºŒç™¾äº”åäº”ä¸ªipåœ°å€ï¼Œé‚£ä¹ˆæˆ‘çš„ç¬¬ä¸€ä¸ªipåœ°å€æ˜¯æˆ‘çš„ç½‘ç»œåœ°å€ï¼Œæœ€åä¸€ä¸ªipåœ°å€æ˜¯æˆ‘çš„å¹¿æ’­åœ°å€ã€‚è¿™ä¸ªé—®é¢˜å°±æ¯”è¾ƒç®€å•ï¼Œä½ æŠŠä½ çš„æŒ‡çº¹æºç å’Œä½ ipçš„è¿›è¡Œä¸€ä¸ªæœ‰æ•ˆè¿ç®—ï¼Œç„¶åæœ€ç»ˆä¼šå¾—åˆ°ä½ çš„ç½‘ç»œåœ°å€ï¼Œè€Œç½‘ç»œåœ°å€å¾—åˆ°ä¹‹ååŒæ—¶å†å»çœ‹æœ€åä¸€ä½ï¼Œæœ€åä¸€ä½å¦‚æœæ˜¯é›¶ï¼Œæ‚¨çš„è¯ä»£è¡¨ç€æˆ‘çš„å…«ä¸ªæ¯”ç‰¹å…¨éƒ¨éƒ½æ˜¯ï¼Œå…«ä¸ªæ¯”çš„å…¨éƒ¨éƒ½æ˜¯é›¶çš„æƒ…å†µä¸‹ï¼Œæˆ‘å…è®¸åˆ†é…äºŒç™¾äº”åäº”ä¸ªipåœ°å€ï¼Œé‚£ä¹ˆæˆ‘çš„ç¬¬ä¸€ä¸ªé›¶å°±ä»£è¡¨æˆ‘çš„ç½‘ç»œåœ°å€ï¼Œæˆ‘çš„æœ€åä¸€ä½äºŒäº”äº”å°±ä»£è¡¨æˆ‘çš„å¹¿æ’­åœ°å€ã€‚é‚£ä¹ˆæ˜¯ä¸æ˜¯æ‰€æœ‰çš„æ¨å¹¿çš„å¹¿æ’­åœ°å€åé¢éƒ½æ˜¯ç‚¹äºŒäº”äº”çš„ï¼Ÿé”™çš„ã€‚é‚£ç»§ç»­å¾€ä¸‹çœ‹ä¸€ä¸‹ï¼Œè¿™é‡Œä¹Ÿæ˜¯ä¸€ä¸ªç½‘ç»œåˆ—è¡¨ã€‚ä¹Ÿæ˜¯æˆ‘çš„æœ¬çº§åœ°ç†å¹ºä¹äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºäºŒã€å››ç‚¹ä¸ƒã€‚å‡å¦‚æˆ‘çš„æŒ‡ç½‘ç‚¹ç æ˜¯äºŒäº”äº”ç‚¹äºŒäº”äº”ç‚¹äºŒäº”ç‚¹å¹ºä¹äºŒå‘¢ï¼Œé‚£ä¹ˆè¿™æ—¶å€™æˆ‘çš„ç½‘ç»œåœ°å€æ˜¯å¤šå°‘ï¼Ÿä¸€æ ·çš„ï¼Œç½‘ä¸Šé¢ä»¥åè¿ç®—æ‰æˆ‘çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œä¾ç„¶æ˜¯å¹ºä¹äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºäºŒã€å››ç‚¹é›¶ã€‚è€Œæˆ‘çš„å¹¿æ’­åœ°å€æ˜¯å¤šå°‘ï¼Ÿå¹¿æ’­åœ°å€å…¶å®åé¢å¹¶ä¸æ˜¯ç‚¹äºŒäº”äº”äº†ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºåœ¨è¿™é‡Œæœ‰å¤šå°‘ä¸ªä¸€å°±ä»£è¡¨ç€æˆ‘æœ‰å¤šå°‘ä¸ªç½‘æ®µåœ°å€ï¼Œé‚£ä¹ˆç½‘çš„åœ°å€æ€ä¹ˆè¿ç®—å‘¢ï¼Ÿå…¶å®æˆ‘ä»¬è¯´äº†ï¼Œå®ƒå…¶å®æ˜¯å…«ä¸ªä½ï¼Œå…«ä¸ªä½çš„è¯å‰é¢ä¸¤ä½ä¸ºå¹ºå¹ºï¼Œåé¢æ˜¯é›¶é›¶ã€‚é‚£ä¹ˆå¹ºå¹ºå°±å¸¦æœ‰ä¸¤ä¸ªå¯¹å§ï¼Ÿæˆ‘ä»¬æŒ‰ç…§äºŒè¿›åˆ¶æ¥ç®—ï¼ŒäºŒçš„ä¸¤æ¬¡æ–¹å…¶å®å°±æ˜¯å››æˆ‘å¯ä»¥åˆ†ä¸ºå››ä¸ªæ®µã€‚è€Œæˆ‘çš„å¹ºå¹ºä¹ã€äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºäºŒã€å››ç‚¹ä¸ƒæ˜¯å¤„äºå’±ä»¬çš„ç¬¬ä¸€ä¸ªæ®µå½“ä¸­ï¼Œæ‰€ä»¥è¯´æˆ‘çš„ipåœ°å€æ˜¯å±äºæˆ‘çš„ç¬¬ä¸€ä¸ªæ®µçš„æœ€åä¸€ä¸ªipã€‚é‚£ä¹ˆæˆ‘ç¬¬ä¸€ä¸ªæ®µçš„æœ€åä¸€ä¸ªidå°±æ˜¯å¹ºä¹äºŒç‚¹å¹ºå…­ã€‚å…«ç‚¹å¹ºäºŒã€å››ç‚¹å…­ä¸‰ã€‚æˆ‘ä»¬éœ€è¦å¾€åé¢å†ç»™å¤§å®¶çœ‹ä¸€ä¸‹ã€‚æ€ä¹ˆç®—çš„å‘¢ï¼ŸäºŒäº”äº”ç‚¹äºŒäº”ç‚¹äºŒäº”ç‚¹å¹ºä¹äºŒï¼Œå…¶å®å®ƒç›¸å½“äºå°±æ˜¯ä¸‰åäºŒä¸ªæ¯”ç‰¹ï¼Œå¯¹å§ï¼Ÿå‰é¢éƒ½æ˜¯å¹ºå¹ºå¹ºï¼Œæœ€åä¸€ä¸ªæŠŠæ¡çš„å‰é¢æ˜¯å¹ºå¹ºï¼Œåé¢æ˜¯å…­ä¸ªé›¶ã€‚é‚£ä¹ˆæˆ‘å…è®¸åˆ’åˆ†çš„ç½‘æ®µæ˜¯äºŒçš„å¤šå°‘æ¬¡æ–¹å‘¢ï¼Ÿä¸¤ä¸ªå¹ºäºŒçš„äºŒæ¬¡æ–¹ï¼Œä¹Ÿå°±æ˜¯å››ä¸ªç½‘æ®µã€‚åˆ†åˆ«æ˜¯å“ªå››ä¸ªç½‘æ®µï¼Ÿåˆ†åˆ«æ˜¯æœ€åä¸€ä½ä¸ºé›¶åˆ°å…­åä¸‰ï¼Œå…­åå››åˆ°ä¸€ç™¾äºŒåä¸ƒã€ä¸€ç™¾äºŒåå…«åˆ°ä¸€ç™¾ä¹åä¸€ï¼Œä¸€ç™¾ä¹åäºŒåˆ°äºŒäº”äº”ã€‚è€Œæˆ‘å‰é¢ä¸€å°æˆ‘è‡ªå·±çš„è®¾å¤‡æ˜¯å±äºå¹ºä¹äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºäºŒã€å››ç‚¹ä¸ƒï¼Œå¯¹å§ï¼Ÿé‚£ä¹ˆä¸ƒæ˜¯å±äºç¬¬ä¸€ä¸ªç½‘ç«™ã€‚ç¬¬ä¸€ä¸ªæˆ‘çš„æˆ‘çš„ä¸€ä¸ªä¿ç•™åœ°å€æ˜¯å¤šå°‘ï¼Ÿå¹ºä¹äºŒç‚¹å¹ºå…­å…«ç‚¹å¹ºäºŒã€å››ç‚¹é›¶ï¼Œé‚£æˆ‘çš„å¹¿æ’­åœ°å€æ˜¯æœ€åä¸€ä½ï¼Œä¹Ÿå°±æ˜¯å¹ºä¹äºŒç‚¹å¹ºå…­å…«ç‚¹å¹ºäºŒã€å››ç‚¹å…­ä¸‰ï¼Œè¿™ä¹Ÿå°±æ˜¯ã€‚æˆ‘çš„å¹¿æ’­åœ°å€ï¼Œæ‰€ä»¥è¯´å¹¿æ’­åœ°å€æœ€åä¸€ä½ä¸ä¸€å®šæ˜¯äºŒäº”äº”ã€‚åŒç†ï¼Œæˆ‘ä»¬æ¥è¯´ä¸€ä¸‹å¹¿æ’­é€šè®¯çš„ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹ä¸¤å°ä¸»æœºä¹‹é—´æ˜¯å¦å…è®¸å¹¿æ’­ç›´æ¥é€šè®¯ã€‚ç¬¬ä¸€ä¸ªä¸»æœºå¹ºä¹äºŒç‚¹å¹ºå…­ï¼Œå…«ç‚¹å¹ºäºŒå››ç‚¹ä¸ƒï¼Œå®ƒçš„ä¸»æ¿æºç æ˜¯äºŒäº”äº”ç‚¹äºŒäº”ç‚¹äºŒã€äº”ç‚¹å¹ºä¹äºŒã€‚ç¬¬äºŒå°ä¸»æœºå¹ºä¹äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºäºŒã€å››ç‚¹ä¸€ç™¾ï¼Œå®ƒçš„å­ç½‘æºç å‘¢ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚é‚£ä¹ˆè¿™ä¸¤å°ä¸»æœºå¯ä»¥ç›´æ¥å…è®¸å¹¿æ’­é€šè®¯ï¼ŒæŠŠæˆ‘çš„ä¸»æœºå‘é€å¹¿æ’­ä¹‹åï¼Œä¸»æœºäºŒèƒ½å¤Ÿæ”¶åˆ°å—ï¼Ÿå…¶å®è¿™æ˜¯ä¸èƒ½çš„ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬å‰é¢ä¹Ÿè¯´äº†ï¼Œè¿ç®—å¹¿æ’­åœ°å€ä¹‹åï¼Œå…¶å®ä¸»æœºçš„å¹¿æ’­åœ°å€æ˜¯å¹ºä¹äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºäºŒå››ç‚¹å…­ä¸‰ï¼Œè€Œæˆ‘çš„ä¸»æœºäºŒæ˜¯å¤„äºç¬¬äºŒä¸ªç½‘æ®µå†…ï¼Œæˆ‘ä¸»æœºäºŒçš„å¹¿æ’­åœ°å€åªæ˜¯å¹ºä¹äºŒç‚¹å¹ºå…­ã€å…«ç‚¹å¹ºäºŒã€å››ç‚¹å¹ºäºŒä¸ƒï¼Œé‚£ä¹ˆå®ƒä¸¤ä¸ªçš„å¹¿æ’­åœ°å€æœ¬èº«å°±ä¸ä¸€æ ·ï¼Œä½ åœ¨ä¸»æœºä¸€ç±»å‘çš„å¹¿æ’­ï¼Œå…¶å®ä¸»æœºäºŒå¹¶ä¸èƒ½æ”¶åˆ°ã€‚å°±ç®—ä½ å‘é€çš„æ˜¯ä¸€ä¸ªå—é™å¹¿æ’­åœ°å€äºŒäº”äº”ç‚¹ã€‚äºŒã€äº”ç‚¹äºŒäº”ç‚¹äºŒäº”ï¼Œé‚£ä¹ˆä¾ç„¶æŒ‡æ ‡ä¹Ÿæ— æ³•æ”¶åˆ°ï¼Œè¿™å°±æ˜¯å¹¿æ’­é€šè®¯ä¹‹é—´çš„ä¸€ä¸ªå¹¿æ’­åœ°å€çš„è¿ç®—çš„é—®é¢˜ã€‚é‚£ä¹ˆå¤§å®¶å‘¢åœ¨åé¢çš„è¿‡ç¨‹å½“ä¸­å¯ä»¥è‡ªå·±å†å»æŸ¥è¯¢ä¸€ä¸‹æˆ‘ä»¬çš„ä¸€ä¸ªå¹¿æ’­åœ°å€å¦‚ä½•è¿ç®—ã€‚é‚£ä¹ˆå¥½çš„ï¼Œæˆ‘ä»¬æœ¬ç« èŠ‚å‘¢å°±å·®ä¸å¤šåˆ°æ­¤ç»“æŸäº†ã€‚é‚£åé¢ä¸€ä¸ªç« èŠ‚å‘¢æˆ‘ä»¬ä¼šè¿›è¡Œä¸€ä¸ªæ¡ˆä¾‹çš„ä¸€ä¸ªå®æ“ï¼ŒçœŸæ­£çš„æ¥è¿›è¡Œå®ç°ä¸€ä¸ªå¹¿æ’­çš„ä¸€ä¸ªå‘é€ä»¥åŠå¹¿æ’­çš„ä¸€ä¸ªä¿¡æ¯æ¥æ”¶ã€‚è°¢è°¢å¤§å®¶ã€‚","categories":[],"tags":[]},{"title":"Socketç½‘ç»œç¼–ç¨‹-å…¥é—¨","slug":"Socketç½‘ç»œç¼–ç¨‹-å…¥é—¨","date":"2022-02-21T20:29:25.000Z","updated":"2022-02-22T20:01:32.000Z","comments":true,"path":"2022/02/22/Socketç½‘ç»œç¼–ç¨‹-å…¥é—¨/","link":"","permalink":"http://example.com/2022/02/22/Socket%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B-%E5%85%A5%E9%97%A8/","excerpt":"socketç½‘ç»œç¼–ç¨‹ç³»åˆ—ä¹‹ä¸€","text":"socketç½‘ç»œç¼–ç¨‹ç³»åˆ—ä¹‹ä¸€ Socketç½‘ç»œç¼–ç¨‹-å…¥é—¨ç½‘ç»œæ¨¡å‹-å¯¹åº”å…³ç³» Socket ä¸TCPã€UDPsocket æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå…¶å®socket å°±æ˜¯ä¸€ä¸ªå¥—èŠ‚å­—ï¼Œåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿï¼Œå®‰å“æˆ–è€…æ˜¯windows æˆ–è€…æ˜¯mac å½“ä¸­éƒ½æœ‰æä¾›å¥—èŠ‚å­—a p i çš„ä¸€ä¸ªåŸºç¡€çš„åŠŸèƒ½ã€‚é‚£ä¹ˆæˆ‘ä»¬é€šè¿‡è°ƒç”¨socket çš„å¯¹åº”çš„åŠŸèƒ½å»ä½¿ç”¨t c p æˆ–è€…æ˜¯u d p è¿›è¡Œå¯¹åº”çš„ä¸€ä¸ªæ•°æ®å‘é€ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆè¦è¿™æ ·å‘¢ï¼Ÿè¿™é‡Œæ¥ç»™å¤§å®¶è¿›è¡Œä¸€ä¸ªæ‰©å±•ã€‚åœ¨æˆ‘ä»¬å‰é¢æˆ‘ä»¬æœ‰è¯´åˆ°å¯¹äºè®¡ç®—æœºè€Œè¨€ï¼Œæˆ‘ä»¬æŠŠæ•°æ®ä»a æ‰‹æœºä¼ é€’åˆ°b æ‰‹æœºã€‚æˆ‘ä»¬æœ€ä¸»è¦çš„å°±æ˜¯æŠŠä¸€ä¸ªæ•°ä¸²ä¼ é€’è¿‡å»ï¼Œå¯¹å§ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆæ ·æ‰èƒ½ä¼ é€’è¿‡å»å‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªæ•°æ®åŠ å·¥æˆæœ€åº•å±‚çš„ä¸€ä¸ªç½‘ç»œçš„ç”µä¿¡å·æˆ–è€…æ˜¯å…‰ä¿¡å·è¿›è¡Œä¸€ä¸ªä¼ è¾“ã€‚é‚£ä¹ˆåœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯ä¸€å®šè¦å»å…³å¿ƒæˆ‘ä»¬çš„ä¸€å¥è¯ï¼Œæ¯”å¦‚è¯´hello wordè¿™ä¸ªå­—æ¯ï¼Œå®ƒç©¶ç«Ÿå˜æˆäº†å…‰ä¿¡å·çš„å“ªä¸€ä¸ªä¸œè¥¿å‘¢ï¼Ÿ å…¶å®æˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒè¿™ä¸ªä¸œè¥¿ã€‚å› ä¸ºå¦‚æœè¯´ä½ æ¯æ¬¡éƒ½è¦å»å…³å¿ƒè¿™äº›ä¸œè¥¿çš„è¯ï¼Œé‚£ä¹ˆå¯¹ä½ çš„ç¨‹åºå¼€å‘ä¹Ÿæ˜¯éå¸¸éå¸¸éº»çƒ¦çš„ã€‚è€Œä¸”å¯¹äºæ•´ä¸ªç³»ç»Ÿçš„ç¨³å®šæ€§è€Œè¨€ï¼Œæ˜¯éå¸¸ä¸å¥å£®çš„ã€‚æ‰€ä»¥è¯´å°±ä¼šå‡ºç°æˆ‘ä»¬å‰é¢æ‰€è¯´çš„ç½‘ç»œæ±½è½¦æ¨¡å‹ã€‚ é‚£ä¹ˆåœ¨è¿™é‡Œå‘¢ä¹Ÿç»™å¤§å®¶å†è¿›è¡Œä¸€ä¸ªå·©å›ºã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œæˆ‘ä»¬ä»a å…¬å¸å’Œb å…¬å¸ä¹‹é—´çš„ä¸€ä¸ªå…³ç³»ï¼Œa å…¬å¸è¦æŠŠä¸€ä¸ªè´§ç‰©å‘é€åˆ°b å…¬å¸ï¼Œå¯¹å§ï¼Ÿé¦–å…ˆa å…¬å¸è¦åšä»€ä¹ˆäº‹æƒ…ï¼Ÿa å…¬å¸è¦æŠŠè¿™ä¸ªè´§ç‰©è¿›è¡Œä¸€ä¸ªåŒ…è£…ï¼Œå¯¹å§ï¼Ÿä»–æŠŠè´§ç‰©è¿›è¡ŒåŒ…è£…ï¼Œé‚£ä¹ˆè¿™ä¸ªåŒ…è£…å®ƒå…¶å®å°±æ˜¯ä¸€ä¸ªå±‚é¢çš„ä¸€ä¸ªæ“ä½œã€‚å°±å®ƒçš„åº•å±‚å…¬å¸ä¸å…¬å¸ä¹‹é—´çš„ä¸€ä¸ªçº¦å®šï¼Œä½ éœ€è¦æŠŠè¿™ä¸ªè´§ç‰©è¿›è¡Œä¸€ä¸ªåŒ…è£…ï¼Œå¯¹å§ï¼Ÿå†åé¢ä¸€ç‚¹ï¼Œé¦–å…ˆåŒ…è£…äº†ä¹‹åçš„è¯ï¼Œä½ è¦æŠŠä½ åŒ…è£…çš„è¿™ä¸ªè´§ç‰©è¿›è¡Œä¸€ä¸ªæ ‡ç­¾çš„æ‰“åŒ…ï¼Œå¯¹ä¸å¯¹ï¼Ÿä½ è¦æ‰“åŒ…ã€‚é‚£ä¹ˆè¿™å°±æ˜¯è¯´è´§ç‰©éƒ¨é—¨ä¹‹é—´çš„ä¸€ä¸ªå…³ç³»äº†ï¼Œä½ è´´æ ‡ç­¾ã€æ‰“åŒ…ä»¥åŠåé¢ä½ è¦è¿›è¡Œè¿è¾“è¿‡ç¨‹å½“ä¸­å‘¢ã€‚å°±æ¶‰åŠåˆ°ä½ å¯èƒ½è¦èµ°æ°´è·¯ï¼Œèµ°ç©ºè¿ï¼Œèµ°é“è·¯ï¼Œå¯¹å§ï¼Ÿè¿™ä¸ªæ—¶å€™ä½ è¦æ¶‰åŠåˆ°ï¼Œä½ è¦è´´ä¸Šä½ å¯¹åº”çš„ä¸€ä¸ªæ–¹å¼ï¼Œä½ çš„è½¦å¢å·ã€‚é‚£ä¹ˆè¿™ä¸ªå°±æ˜¯ç‰©ç†å±‚é¢çš„ä¸€ä¸ªä¼ è¾“äº†ã€‚æ‰€ä»¥è¯´å½“ä½ æŠŠä½ çš„è´§ç‰©ä¸¢åˆ°äº†ä¸€ä¸ªç«è½¦ä¸Šçš„ï¼Œåˆ°äº†å¯¹åº”çš„åœ°å€çš„æ—¶å€™ï¼Œç«è½¦ä¸Šæ‹¿å‡ºæ¥ã€‚ä»–é¦–å…ˆè¦çœ‹è§çš„æ˜¯ä»€ä¹ˆï¼Ÿçœ‹è§çš„å°±æ˜¯æˆ‘æ˜¯ä»ä»€ä¹ˆåœ°æ–¹åˆ°è¾¾æˆ‘è¿™é‡Œæ¥çš„ï¼Œé‚£ä¹ˆæˆ‘éœ€è¦åšä»€ä¹ˆäº‹æƒ…å‘¢ï¼Ÿæˆ‘é¦–å…ˆæŠŠæˆ‘çš„è¿™ä¸ªè½¦å¢åˆ°äº†ï¼Œå¯¹å§ï¼Ÿæˆ‘å°±æŠŠå®ƒå¸è´§ã€‚ç„¶åå‘¢ï¼Œæˆ‘çœ‹ä¸€ä¸‹æ ‡ç­¾ï¼Œå“ï¼Œæ ‡ç­¾ä¸Šé¢è¯´çš„æ˜¯åˆ°å“ªä¸€ä¸ªå“ªä¸€ä¸ªåŒºï¼Œå¯¹å§ï¼Ÿæˆ‘è¦æŠŠå®ƒä¸¢åˆ°å“ªä¸€ä¸ªåŒºé‡Œé¢å»ã€‚ç„¶ååŒºé‡Œé¢å‘¢å®ƒåˆä¸€å±‚ä¸€å±‚çš„å¾€ä¸‹èµ°ï¼Œæœ€ç»ˆå‘¢æ‰èƒ½èµ°åˆ°b å…¬å¸å»ï¼Œè¿™å°±æ˜¯ä¸åŒåè®®å±‚ä¹‹é—´çš„ä¸€ä¸ªäº¤äº’è¿‡ç¨‹ã€‚è€Œå¦‚æœè¯´ä½ ä¸€ä¸ªå…¬å¸è¦å»ç®¡ç©¶ç«Ÿè¿™ä¸ªè´§ç‰©èµ°ç©ºè¿è¿˜æ˜¯èµ°æ°´è¿ï¼Œé€šè¿‡ä»€ä¹ˆæ ·çš„æ±½è½¦å»é€ä½ è‡ªå·±å»æŠŠè¿™ä¸ªè´§ç‰©é€åˆ°b å…¬å¸å»ã€‚é‚£ä¹ˆå…¶å®éå¸¸æµªè´¹äººåŠ›çš„ï¼Œä½ è‡ªå·±å»æŠŠä½ çš„è´§ç‰©é€åˆ°å…¬å¸ï¼Œä¸€ä¸ªè´§ç‰©è¿˜å¥½å¤šä¸ªè´§ç‰©çš„è¯ã€‚å…¶å®å°±éå¸¸éº»çƒ¦äº†ï¼Œæ‰€ä»¥è¯´å°±ä¸åŒå±‚çº§ä¹‹é—´çš„ä¸€ä¸ªå…³ç³»ï¼Œè¿è¾“äº¤ç»™å¿«é€’æ¥åšå°±å¥½ï¼Œå¯¹ä¸å¯¹ï¼Ÿ æ‰€ä»¥è¯´è¿™å°±æ˜¯å’±ä»¬çš„ä¸€ä¸ªä¼ è¾“æ¨¡å‹çš„ä¸€ä¸ªä¸ƒå±‚ç½‘ç»œæ¨¡å‹çš„æ¦‚å¿µã€‚ä¹‹æ‰€ä»¥å­˜åœ¨çš„ä¸€ä¸ªåŸç†ï¼Œé‚£ä¹ˆsocket ä¸tcp udpä¹‹é—´çš„å…³ç³»å‘¢ï¼Œå…¶å®socket å°±æ˜¯å¯¹tcp udp ä¹‹é—´çš„ä¸€ä¸ªå°è£…ã€‚ è¿˜æœ‰æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹socket ç©¶ç«Ÿæ˜¯ä»€ä¹ˆï¼Ÿç®€å•æ¥è¯´socket å°±æ˜¯i p åœ°å€ä¸ç«¯å£çš„ä¸€ä¸ªç»“åˆåè®®ã€‚è¿™ä¸ªåè®®åç§°å«åšRFC 793ã€‚é‚£ä¹ˆå¤§å®¶å¯ä»¥å»æŸ¥è¯¢ä¸€ä¸‹ï¼Œæ˜¯ä¸€ç§åœ°å€ä¸ç«¯å£ç»“åˆçš„ä¸€ä¸ªæè¿°åè®®ã€‚ å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªæè¿°åè®®ï¼Œå¯¹ä¸å¯¹ï¼Ÿå®ƒç”¨æ¥æè¿°ä»€ä¹ˆï¼Œæè¿°åœ°å€ä¸ç«¯å£ä¹‹é—´çš„ä¸€ä¸ªå…³ç³»ã€‚è¿™ä¸ªå°±æ˜¯i p åœ°å€ç«¯å£ï¼Œå°±æ˜¯æˆ‘ä»¬ç”µè„‘ä¸Šæ‰€è°“çš„ç«¯å£ã€‚è¿™é‡Œå‘¢ç»™å¤§å®¶æä¸€ä¸‹ç«¯å£ã€‚æ¯”å¦‚è¯´ä½ è®¿é—®ä¸€ä¸ªç½‘ç«™ï¼Œé‚£ä¹ˆä½ è®¿é—®çš„å…¶å®å°±æ˜¯80ç«¯å£ï¼Œå°±æ˜¯å’±ä»¬çº¦å®šå¥½çš„ä¸€ä¸ªh t t p åè®®çš„ä¸€ä¸ªç®€å•çš„ç«¯å£ã€‚å…¶å®å°±æ˜¯80ç«¯å£ã€‚ æ¥ç€å¾€ä¸‹èµ°ï¼ŒTCP&#x2F;IPåè®®çš„ç›¸å…³a p i çš„ä¸€ä¸ªæ€»ç§°æ˜¯ç½‘ç»œa p i çš„é›†åˆå®ç°ï¼Œå¯¹å§ï¼Ÿå®ƒå…¶å®å‘¢å°±æ˜¯å¯¹t c p i p çš„åè®®ï¼Œç›¸å…³çš„a p i çš„ä¸€ä¸ªæ€»ç§°ã€‚TCP&#x2F;IP å®ƒæœ‰å¯¹åº”çš„åè®®ï¼Œå¯¹å§ï¼Ÿè¯´èµ·æ¥å°±æ˜¯å¯¹è¿™äº›åè®®çš„ä¸€ä¸ªå®ç°ä¸€ä¸ªæè¿°ï¼Œç„¶åé›†åˆåœ¨ä¸€èµ·ã€‚ æ¶µç›–äº†ä»€ä¹ˆå‘¢ï¼Ÿæ¶µç›–äº†æˆ‘ä»¬çš„æµå¥—æ¥å­—ï¼Œä»¥åŠå’±ä»¬çš„å…¶å®è¿™ä¸ªåœ°æ–¹å°±æ˜¯å’±ä»¬çš„t c p å’Œudp äº†ã€‚ é‚£æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹socket çš„ä¸€ä¸ªç»„æˆä¸ä½œç”¨ã€‚é¦–å…ˆåœ¨ç½‘ç»œä¼ è¾“å½“ä¸­ï¼Œå®ƒæ˜¯ç”¨äºæ ‡è¯†ä¸¤ä¸ªç«¯ç‚¹ä¹‹é—´çš„è¿æ¥ï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Ÿåœ¨ä¼ è¾“çš„æ•´ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œæ¯”å¦‚è¯´ä½ çš„a è®¡ç®—æœºå’Œb è®¡ç®—æœºä¹‹é—´ï¼Œæˆ‘ä»¬é€šè¿‡socket è¿›è¡Œè¿æ¥ã€‚ åœ¨ä½ çœ‹æ¥ï¼Œè®¤ä¸ºæ˜¯ç‰©ç†å±‚é¢çš„è¿æ¥å—ï¼Ÿä¸ä¸€å®šï¼Œå®ƒç‰©ç†å±‚é¢ä¸ä¸€å®šæ˜¯æ—¶æ—¶åˆ»åˆ»éƒ½æœ‰è¿æ¥çš„ï¼Œå®ƒæœ‰å¯èƒ½æ–­å¼€ï¼Œæœ‰å¯èƒ½åœ¨ä½ è¿™ä¸ªç¨‹åºä¹‹å¤–å®ƒè¿˜è¿æ¥ã€‚æ‰€ä»¥è¯´ä½ çš„ç¨‹åºè¿™ä¸ªsocket å¹¶ä¸ç®¡ç‰©ç†å±‚é¢çš„ä¸€ä¸ªè¿æ¥ï¼Œå®ƒæ˜¯ç”¨æ¥æ ‡è¯†çš„ï¼Œæ˜¯å”¯ä¸€æ ‡è¯†ä¸¤ä¸ªç«¯ç‚¹ä¹‹é—´çš„è¿æ¥ã€‚ é‚£æˆ‘ä»¬æ¥ç€å¾€ä¸‹è¯´ç«¯ç‚¹åŒ…æ‹¬ä»€ä¹ˆï¼ŸåŒ…æ‹¬i p å’Œçš„ä¸€ä¸ªç«¯å£ Portã€‚ä¸€ä¸ªè®¡ç®—æœºæœ‰éå¸¸å¤šçš„ç«¯å£ï¼Œé‚£ä¹ˆå®ƒå¯¹å¤–æœ‰ä¸€ä¸ªi p æˆ‘ä»¬çš„ä½œç”¨ã€‚æ‰€è°“çš„ä½œç”¨å°±æ˜¯æ ‡è¯†è¿™ä¸ªi p ä¸€ä¸ªi p ä»£è¡¨ä¸€ä¸ªè®¡ç®—æœºçš„è¯ï¼Œå®ƒå°±ä»£è¡¨çš„æ˜¯ä¸¤ä¸ªè®¡ç®—æœºä¹‹é—´æŸä¸€ä¸ªç«¯å£ä¸Šé¢è¿æ¥ï¼Œè¿™ä¸ªæ€ä¹ˆè¯´å‘¢ï¼Ÿ å°±å¥½æ¯”ä½ çš„å®¶i p å°±æ˜¯ä½ çš„å®¶ï¼Œç«¯å£å°±æ˜¯ä½ çš„çª—æˆ·ï¼Œé€šè¿‡ä½ å®¶å§å®¤çš„çª—æˆ·æ‰“å¼€é—¨ï¼Œå°±èƒ½çœ‹è§ä½ å¯¹é¢å¥³ç¥çš„é‚£ä¸ªçª—æˆ·å£ï¼Œå¯¹å§ï¼Ÿè¿™ä¸ªä¹‹é—´ä½ ä»¬ä¹‹é—´é€šè¿‡çœ¼ç¥è¿›è¡Œè¿æ¥ï¼Œå¯¹å§ï¼Ÿæ‰€ä»¥è¯´è¿™å°±æ˜¯ç«¯ç‚¹ä¸ç«¯ç‚¹ä¹‹é—´çš„ä¸€ä¸ªè¿æ¥ã€‚ å®ƒæœ€ä¸»è¦çš„å››ä¸ªè¦ç´ å°±æ˜¯å®¢æˆ·ç«¯çš„åœ°å€ï¼Œå®¢æˆ·ç«¯çš„ç«¯å£ä»¥åŠæœåŠ¡å™¨ç«¯çš„åœ°å€å’ŒæœåŠ¡å™¨ç«¯çš„ç«¯å£ã€‚ æˆ‘ä»¬æ¥ç€å¾€ä¸‹è®²socket çš„ä¸€ä¸ªä¼ è¾“åŸç†ï¼Œåœ¨è¿™é‡Œç»™å¤§å®¶æè¿°çš„æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯å’Œä¸€ä¸ªæœåŠ¡å™¨ã€‚ é¦–å…ˆå‘¢æˆ‘ä»¬çš„å®¢æˆ·ç«¯å‘¢å®ƒæœ‰ä¸€ä¸ªåœ°å€ç­‰äºi p ä¸€ï¼ŒæœåŠ¡å™¨ç«¯çš„åœ°å€ç­‰äºi p äºŒï¼Œå°±æ˜¯æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€äº†ï¼Œå¯¹å§ï¼Ÿi p åœ°å€æœ‰äº†ã€‚é‚£ä¹ˆé¦–å…ˆç¬¬äºŒç‚¹æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹å®ƒçš„ç«¯å£æ˜¯ä»€ä¹ˆï¼Œç«¯å£æ˜¯äºŒäº”ç«¯å£ï¼Œå¯¹ä¸å¯¹ï¼ŸäºŒåäº”å·ç«¯å£ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„i p åœ°å€åŠ ä¸Šç«¯å£ï¼Œå°±ç­‰äºå’±ä»¬çš„socket çš„ä¸€ä¸ªåè®®ã€‚åŒæ—¶å‘¢å®ƒåšäº†ä¸€ä¸ªä»€ä¹ˆä½œç”¨ï¼Ÿå°±æ˜¯email å¯¹å§ï¼Ÿå®ƒæ˜¯ä¸€ä¸ªemail æœåŠ¡ï¼Œå°±æ˜¯å’±ä»¬é‚£ä¸ªweb serverã€‚æˆ‘ä»¬çš„æ•°æ®å‘¢å…¶å®å°±é€šè¿‡å’±ä»¬çš„è¿™ä¸ªi p åœ°å€ä¸ç«¯å£ä¹‹é—´çš„è¿™ç§è¿æ¥æ–¹å¼ï¼Œæˆ‘ä»¬å°±èƒ½å®ç°å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯ä¹‹é—´çš„ä¸€ä¸ªäº¤äº’ã€‚ä½ è¦å»å–ä¸€ä¸ªé‚®ä»¶ï¼Œå¯¹å§ï¼Ÿä½ å°±é€šè¿‡äºŒåäº”å·ç«¯å£å»å–é‚®ä»¶è¯´å”‰æˆ‘æœ‰æ²¡æœ‰é‚®ä»¶ï¼Œæœ‰çš„è¯ï¼Œæˆ‘å»ç»™æˆ‘ä¸€ä¸ªè¿”å›ï¼Œå¯¹å§ï¼Ÿè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å’±ä»¬é‚£ä¸ªsocket å®ƒçš„ä¸€ä¸ªä¼ è¾“åŸç†çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚ å†å¾€ä¸‹ç»†è®²ï¼Œsocket. å½“ä¸­çš„ä¸€ä¸ªt c pï¼Œæˆ‘ä»¬æ¥è¯´ä¸€ä¸‹t c p æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿt c p æ˜¯é¢å‘è¿æ¥çš„ä¸€ä¸ªé€šè®¯åè®®ï¼Œé¢å‘è¿æ¥å¯¹æ–¹ã€‚è¦æ³¨æ„ä¸€ç‚¹æ˜¯é¢å‘è¿æ¥çš„ï¼Œå®ƒæ˜¯é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥é€šè®¯å®Œæˆæ—¶è¦æ‹†é™¤è¿æ¥ã€‚å°±è¯´ä½ å’Œä½ çš„å¥³ç¥è¦è¿›è¡Œè¿æ¥çš„æ—¶å€™ï¼Œä½ é¦–å…ˆè¦é—®ä»–ä¸€ä¸‹ï¼Œå“ï¼Œä½ æœ‰æ²¡æœ‰ç©ºå•Šï¼Œæˆ‘å¯ä¸å¯ä»¥ç»™ä½ è¯´è¯´è¯ã€‚ç„¶åä½ çš„å¥³ç”Ÿè·Ÿä½ è¯´ï¼Œå“ï¼Œæˆ‘æœ‰ç©ºå¯¹å§ï¼Ÿé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å‘¢æ‰ä¼šè¿›è¡Œåˆ°ç¬¬ä¸‰æ¬¡è¯´ï¼Œå“ï¼Œå¥½å§ï¼Œæˆ‘ä»¬ç°åœ¨è¿æ¥è¿æ¥ä¹‹åå‘¢ï¼Œé‚£ä¹ˆä½ ä»¬ä¹‹é—´å°±å¯ä»¥äº¤æµè¿›è¡Œè°ˆè¯äº†ã€‚ç„¶ååé¢åˆ°æ‹†é™¤è¿æ¥ï¼Œæ‹†é™¤è¿æ¥å°±æ˜¯è¯´ä½ ä»¬ä¸¤ä¸ªä¹‹é—´è¯´å“ï¼Œæˆ‘è¦èµ°äº†ï¼Œæˆ‘æœ‰äº‹æˆ‘è¦èµ°äº†ï¼Œå¯¹é¢å°±è¯´å¥½å§ï¼Œé‚£ä½ èµ°å§ã€‚ç„¶åä½ å¯¹é¢è¯´ï¼Œé‚£æˆ‘å°±èƒ½èµ°äº†ï¼Œç„¶åå¯¹é¢è¯´å¥½å§ï¼Œä½ èµ°äº†ï¼Œç„¶åæœ€åä½ èµ°äº†ï¼Œä»–æ–­å¼€äº†ï¼Œä»–ä¹Ÿä¸å†å…³æ³¨ä½ çš„çª—æˆ·äº†ã€‚é‚£ä¹ˆä½ ä»¬ä¸¤ä¸ªä¹‹é—´å°±ä¸ä¼šå†ç»è¿‡çª—æˆ·ä¹‹é—´çš„ä¸€ä¸ªå¯¹æœ›äº†ï¼Œå¯¹å§ï¼Ÿä½ è¦å‘Šè¯‰ä»– å°±èµ°äº†ï¼Œå¯¹é¢çš„äººæ‰çŸ¥é“ã€‚æ¥ç€æˆ‘ä»¬å¾€ä¸‹è¯´ï¼Œç”±äºt c p æ˜¯é¢å‘è¿æ¥çš„ï¼Œæ‰€ä»¥åªèƒ½é€šä¿¡äºç«¯åˆ°ç«¯çš„ä¸€ä¸ªé€šä¿¡ã€‚ä»€ä¹ˆæ„æ€å•Šï¼Ÿä½ åœ¨çœ‹ä½ çš„å¥³ç¥çš„æ—¶å€™ï¼Œä½ åœ¨è·Ÿä½ çš„å¥³ç¥ä¹‹é—´è¿›è¡Œäº¤æµçš„æ—¶å€™ï¼Œä½ æ˜¯ä¸èƒ½å»çœ‹å…¶ä»–äººã€‚è¿™å°±æ˜¯t c p çš„ä¸€ä¸ªä¸œè¥¿ã€‚ä½ åœ¨æŸä¸€ä¸ªæ—¶åˆ»ä½ åªèƒ½å»è¿æ¥åˆ°å®ƒçš„æŸä¸€ä¸ªç«¯å£ã€‚æ‰€ä»¥è¯´å®ƒæ˜¯ç«¯åˆ°ç«¯çš„ä¸€ä¸ªé€šä¿¡ï¼Œæ˜¯é¢å‘ç«¯åˆ°ç«¯çš„ä¸€ä¸ªé€šä¿¡ã€‚ æˆ‘ä»¬å†è¯´ä¸€ä¸‹u d pï¼Œu d p è¿™ä¸ªä¸œè¥¿å•Šè·Ÿt c p å·®åˆ«æ˜¯è›®å¤§çš„ã€‚é¦–å…ˆç¬¬ä¸€ç‚¹u d p æ˜¯é¢å‘æ— è¿æ¥çš„é€šä¿¡æ–¹å¼ï¼Œä½ ä¸éœ€è¦è¿æ¥ã€‚u d p çš„æ•°æ®åŒ…æ‹¬ç›®çš„ç«¯å£å·å’ŒåŸç«¯å£å·çš„ä¿¡æ¯ã€‚ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿu d p çš„æ•°æ®é‡Œé¢å®ƒæ¶µç›–äº†ä¸€ä¸ªç›®çš„çš„ç«¯å£å·ï¼Œå°±æ˜¯è¯´åŒ…æ‹¬äº†ç›®æ ‡çš„ç«¯å£å·å’Œä½ è‡ªå·±çš„ä¸€ä¸ªç«¯å£å·ã€‚ä½ åœ¨å¯¹å¤–è¯´çš„æ—¶å€™ï¼Œæ¯”å¦‚è¯´ç°åœ¨ä½ è¦è¯´ä¸€å¥è¯ï¼Œå¯¹ä½ çš„å¥³ç”Ÿè®²å¯¹å§ï¼Ÿè¿™æ—¶å€™ä½ ä½ å¥³ç¥æ˜¯ä¸åœ¨çš„ï¼Œä½ æ˜¯å¯èƒ½è¯´ç»™äº†ä»–çš„å¦ˆå¦ˆï¼Œä½ ç»™ä»–è¯´ï¼Œæˆ‘æƒ³è¦å¯¹æŸæŸäººè¯´ï¼Œå“ï¼Œæˆ‘å–œæ¬¢ä½ ï¼Œå¯¹å§ï¼Ÿè¿™å¥è¯é¦–å…ˆå‘¢ä½ è¯´å‡ºè¿™å¥è¯çš„æ—¶å€™ï¼Œä½ å¦ˆå¦ˆä½œä¸ºä¸€ä¸ªè½¬æ¥è€…ï¼Œé‚£ä¹ˆå¥¹ç»™å¥¹çš„å¥³å„¿è®²çš„æ—¶å€™æ€ä¹ˆè¯´å‘¢ï¼Ÿå“ï¼ŒæŸæŸæŸæŸå…¬å­å¯¹ä½ è¯´äº†ä¸€å¥ï¼Œæˆ‘å–œæ¬¢ä½ è¿™å¥è¯ï¼Œå¯¹ä¸å¯¹ï¼Ÿä»–çš„å¦ˆå¦ˆä¹‹æ‰€ä»¥èƒ½å¤Ÿæ‰¾åˆ°ä»–çš„å¥³å„¿ï¼Œé‚£ä¹ˆå°±ä¸€å®šèƒ½å¤ŸçŸ¥é“è¯´ä½ æ˜¯å¯¹ä»–å¥³å„¿è¯´çš„ã€‚é‚£ä¹ˆè¿™æ—¶å€™å°±åŒ…æ‹¬äº†ç›®æ ‡ç«¯å£å·ã€‚å½“ä»–å¦ˆå¦ˆåœ¨è½¬è¿°è¿™å¥è¯çš„æ—¶å€™å‘¢ï¼Œå…¶å®å°±åŒ…æ‹¬äº†è¯´æŸæŸå…¬å­ï¼Œå¯¹å§ï¼ŸæŸæŸå…¬å­å°±æ˜¯åŸç«¯å£å·ã€‚å“ï¼Œå¯¹ï¼Œå°±æ˜¯è¯´çš„ä½ ã€‚ç”±äºé€šè®¯æ˜¯ä¸éœ€è¦è¿æ¥çš„ï¼Œæ‰€ä»¥è¯´å¯ä»¥å®ç°å¹¿æ’­çš„å‘é€å¹¶ä¸å±€é™äºç«¯åˆ°ç«¯ä¹‹é—´çš„ä¸€ä¸ªå‘é€ã€‚è¿™ä¸ªä¸œè¥¿å¾ˆç®€å•ï¼Œå‡å¦‚è¯´ä½ æ˜¯ä¸€ä¸ªè€å¸ˆè¦ä¼ è¾“å­¦æ ¡çš„ä¸€ä¸ªé€šçŸ¥ï¼Œè®©ä½ çš„ç­ä¸Šå»ï¼Œå¯¹å§ï¼Ÿä½ æ˜¯ä¸€ä¸ªä¸€ä¸ªå­¦ç”Ÿçš„ï¼Œæ‰¾å­¦ç”Ÿå¯¹ä»–è¯´æŸä¸€ä¸ªå®‰æ’å‘¢ï¼Œè¿˜æ˜¯è¯´ä½ åœ¨ä¸Šè¯¾çš„æ—¶å€™ç›´æ¥å¯¹ç€å…¨ç­è¯´ä¸€ä¸‹è¿™æ ·æ¥çš„å“ˆï¼Œå¯¹å§ï¼Ÿè¿™ä¸ªæ—¶å€™å°±æ˜¯t c p å’Œu d p æœ€å¤§çš„åŒºåˆ«äº†ï¼Œt c p æ˜¯ä¸€ä¸ªä¸€ä¸ªä¸ªçš„æ¥ã€‚é‚£ä¹ˆu d p ä½ å¯ä»¥åœ¨ç­ä¸Šç›´æ¥è¯´ï¼Œå“å‘¦ï¼Œå¼ä¸€å¥ï¼Œæ˜å¤©ä¸ä¸Šè¯¾å¯¹ä¸å¯¹ï¼Ÿè¿™ä¸ªä¸œè¥¿å°±å®Œæˆäº†ã€‚é‚£ä¹ˆok è¿™å°±æ˜¯å’±ä»¬çš„ä¸€ä¸ªu d p çš„ä¸€ä¸ªåè®®ã€‚å½“ç„¶ã€‚ æˆ‘ä»¬åé¢è¿˜ä¼šè®²è§£ä¸€ä¸‹t c p u d p å…·ä½“çš„ä¸€äº›åŒºåˆ«ã€‚ æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹t c p çš„ä¸€ä¸ªä¼ è¾“å›¾è§£ã€‚ t c p çš„ä¼ è¾“å›¾è§£ï¼Œä¸€ä¸ªè®¾å¤‡ä¼ è¾“åˆ°æœåŠ¡å™¨ä¸Šã€‚å”‰ï¼Œå®ƒé¦–å…ˆæ˜¯è¿›è¡Œä¸€ä¸ªt c p çš„æ•°æ®å‘é€ï¼ŒåŒæ—¶å‘¢æˆ–å®ƒä¼šæ”¶åˆ°ä¸€æ¡t c p çš„å›å¤ï¼Œä»£è¡¨è¿™æ¡æ•°æ®æ”¶åˆ°äº†ã€‚é‚£ä¹ˆè¿™ä¸ªå›å¤å‘¢å¹¶ä¸æ˜¯ç”±ä½ æ¥å®Œæˆçš„ï¼Œè€Œæ˜¯t c p å±‚é¢ï¼Œæ•°æ®å±‚é¢å·²ç»å®Œæˆäº†è¿™ä¸ªå·¥è£…ã€‚å½“ä½ è¦å‘é€ä¸€ä¸ªæ•°æ®çš„æœåŠ¡å™¨çš„æ—¶å€™ï¼Œå…¶å®è¿™æ¡æ•°æ®åªæœ‰ä¸¤ç§çŠ¶æ€ï¼Œä¸€ç§æ˜¯å‘é€æˆåŠŸï¼Œä¸€ç§æ˜¯å‘é€å¤±è´¥ã€‚åªæœ‰è¿™ä¸¤ä¸ªçŠ¶æ€ï¼Œåªæœ‰æˆåŠŸä¸å¤±è´¥ï¼Œæ²¡æœ‰è¯´å‘é€ä¸€åŠï¼Œä»–æ¥æ”¶åˆ°ä¸€åŠçš„æƒ…å†µä¸€å®šæ˜¯ä½ å‘é€è¿‡å»ï¼Œä»–çœŸçš„æ”¶åˆ°äº†ã€‚åŒæ—¶ä»–ç»™ä½ äº†ä¸€æ¬¡å›é€ä¹‹åï¼Œä»–æ”¶åˆ°äº†è¿™æ¡æ•°æ®æ‰ä»£è¡¨æˆåŠŸäº†ã€‚æ‰€ä»¥ä»–åªæœ‰ä¸¤ä¸ªçŠ¶æ€ï¼Œè¦ä¹ˆæˆåŠŸï¼Œè¦ä¹ˆå¤±è´¥ã€‚ udpå°±ä¸ä¸€æ ·äº†ï¼Œä»–åªç®¡å‘é€æ•°æ®ï¼Œä»–ä¸ç®¡å›é€çš„ï¼Œä»–åªç®¡æŠŠæ•°æ®å¾€ä¸‹å‘ã€‚ä»–ä¸ç®¡å›é€çš„ï¼Œæ¯”å¦‚è¯´ä½ ç°åœ¨å»ç­ä¸Šç»™é‚£äº›å­¦ç”Ÿè¯´æ˜å¤©ä¸ä¸Šè¯¾å§ã€‚å“ï¼Œå‡å¦‚è¿™ä¸ªå­¦ç”Ÿä»–æ²¡åœ¨ç­ä¸Šæ€ä¹ˆåŠï¼Ÿä½ éš¾é“è¿˜å•ç‹¬å»æ‰¾ä¸€ä¸‹è¿™ä¸ªå­¦ç”Ÿï¼Ÿä¸ä¼šçš„ï¼Œu d p å…¶å®ä¸ä¼šçš„ï¼Œä»–ç›´æ¥å°±å¼ä¸€å¥ï¼Œæ˜å¤©ä¸ä¸Šè¯¾ï¼Œok å®Œäº†å°±å®Œäº†ã€‚ä»–å¯¹å…¨ç­åŒå­¦ä¸€è¯´ï¼Œè¯´å®Œäº†å°±å®Œäº‹äº†ï¼Œä¸å­˜åœ¨ä¸€ä¸ªæŸä¸ªå­¦ç”Ÿï¼Œä»–æœ‰æ²¡æœ‰å¬åˆ°è¦å¯¹ä½ è¿›è¡Œä¸€ä¸ªåé¦ˆï¼Œä¸å­˜åœ¨è¿™ä¸ªä¸œè¥¿ï¼Œä¸å­˜åœ¨è¯´æ¯ä¸ªå­¦ç”Ÿè¿˜è¦å¯¹ä½ è¯´ï¼Œå“ï¼Œæˆ‘å¬åˆ°äº†ï¼Œæˆ‘æ˜å¤©ä¸ä¼šæ¥ä¸Šè¯¾äº†ï¼Œä¸å­˜åœ¨è¿™ä¸ªä¸œè¥¿ã€‚ æ‰€ä»¥è¯´è¿™å°±æ˜¯u d p å’Œt c p æœ€å¤§çš„ä¸€ä¸ªåŒºåˆ«ã€‚å¥½çš„ï¼Œæˆ‘ä»¬æœ¬å°èŠ‚è®²äº†ä¸€ä¸ªt c p u d p çš„ä¸€ä¸ªå›¾è§£ï¼Œä¹Ÿè®²äº†å’±ä»¬çš„socket ç©¶ç«Ÿæ˜¯ä¸€äº›ä»€ä¹ˆä¸œè¥¿ã€‚é‚£ä¹ˆæˆ‘ä»¬å‰é¢ä¸¤ä¸ªå°èŠ‚éƒ½è®²äº†ä¸€äº›ç†è®ºçš„çŸ¥è¯†ï¼Œåé¢ä¸€ä¸ªç« èŠ‚æˆ‘ä»¬ä¼šç»™å¤§å®¶è®²è§£ä¸€ä¸‹ä¸€ä¸ªå®é™…çš„æ¡ˆä¾‹ã€‚é‚£ä¹ˆåœ¨è®²è§£å®é™…çš„æ¡ˆä¾‹ä¹‹å‰å‘¢ï¼Œç»™å¤§å®¶è¯´ä¸€ä¸‹ä¸€ä¸ªcat serious i p u d i c a t i o n å°±æ˜¯å’±ä»¬æ‰€è°“çš„c s æ¨¡å‹ã€‚åœ¨t c p i p åè®®å½“ä¸­ï¼Œä¸¤ä¸ªä¹‹é—´çš„ä¸»è¦æ–¹å¼å°±æ˜¯ã€‚c s æ¨¡å‹c s å…¶å®å°±æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´äº¤äº’çš„ä¸€ä¸ªæ¨¡å‹ï¼Œå°±ç§°ä¹‹ä¸ºc s æ¨¡å‹ã€‚æœ€ä¸»è¦çš„ç›®çš„å°±æ˜¯ååŒç½‘ç»œå½“ä¸­çš„è®¡ç®—æœºèµ„æºï¼ŒæœåŠ¡å™¨æ¨¡å¼è¿›ç¨‹é—´çš„æ•°æ®å…±äº«ã€‚ä¸ºä»€ä¹ˆè¦æœ‰c s æ¨¡å‹ï¼Ÿæ¯”å¦‚è¯´ä½ è®¿é—®ä¸€ä¸ªç½‘ç«™ï¼Œä½ æœ‰æ²¡æœ‰æƒ³è¿‡ä¸ºä»€ä¹ˆè¿™ä¸ªç½‘ç«™ä¸€å®šè¦éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šï¼Ÿè¿™ä¸ªå‘¢å…¶å®ä¹Ÿè›®å¥½ç†è§£çš„ã€‚æ¯”å¦‚è¯´ä½ è‡ªå·±åšä¸€ä¸ªç½‘ç«™ï¼Œä½ éš¾é“æŠŠä½ çš„è¿™ä¸ªç½‘é¡µå‘ç»™å…¨ä¸–ç•Œçš„æ¯ä¸ªäººéƒ½å‘ä¸€ä»½å¤‡ä»½ç»™ä»–ï¼Œè¯´æˆ‘çš„ç½‘ç«™æ˜¯è¿™ä¸ªã€‚ç„¶åå‘¢ï¼Œä½ çš„ç½‘ç«™æœ‰æ›´æ–°çš„æ—¶å€™ï¼Œä½ éš¾é“ç»™å…¨ä¸–ç•Œçš„äººéƒ½è¯´ä¸€ä¸‹ä½ çš„ç½‘ç«™æœ‰å‰¯æœ¬æ›´æ–°çš„ï¼Œå…¨éƒ¨å«ä»–ä»¬æ›´æ–°ä¸€ä¸‹å—ï¼Ÿä¸ä¼šçš„ï¼Œä½ ç›´æ¥æŠŠä½ çš„ç½‘ç«™éƒ¨ç½²åœ¨ä¸€ä¸ªæœåŠ¡ä¸Šå½“æŸäººçœŸæ­£éœ€è¦çœ‹çš„æ—¶å€™ï¼Œä»–é€šè¿‡è¿™ä¸ªc s æ¨¡å‹ï¼Œä»–çš„å®¢æˆ·ç«¯å»è®¿é—®ä½ çš„è¿™ä¸ªæœåŠ¡å™¨ï¼Œå¾—åˆ°ä½ çš„ç½‘ç«™ï¼Œæ¥çœ‹ä½ çš„ç½‘ç«™ã€‚æ‰€ä»¥ è¯´è¿™å°±æ˜¯c s æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯ååŒçš„è®¡ç®—æœºå½“ä¸­çš„ä¸€ä¸ªç½‘ç»œèµ„æºæœåŠ¡å™¨æ¨¡å¼ä»¥åŠè¿›ç¨‹é—´çš„ä¸€ä¸ªæ•°æ®å…±äº«ã€‚è¿›ç¨‹é—´çš„ç½‘ç»œæ•°æ®æ¨¡å‹å…±äº«å‘¢ï¼Œå…¶å®è¿™ä¸ªä¹Ÿè›®ç®€å•çš„ã€‚åœ¨ä½ çš„å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä½ çš„æŸä¸€ä¸ªè½¯ä»¶æä¾›çš„æŸä¸€ä¸ªæœåŠ¡ï¼Œå¯¹å§ï¼Ÿæ¯”å¦‚ä½ ç°åœ¨ä¸€ä¸ªç½‘ç«™ï¼Œä½ è‡ªå·±çš„æœ‰æœ‰ä¸€ä¸ªç¨‹åºæä¾›äº†ä¸€ä¸ªä¸€åŠ ä¸€ç­‰äºäºŒçš„è¿™ä¸ªè¿‡ç¨‹ï¼Œä½ ä¸æƒ³å…¶ä»–è½¯ä»¶å†å»å®ç°ï¼Œä¸€åŠ ä¸€ç­‰äºäºŒçš„è¿™ä¸ªè¿‡ç¨‹ã€‚é‚£ä¹ˆä½ å¯ä»¥æŠŠä½ çš„è¿™ä¸ªè½¯ä»¶å¯¹å¤–æš´éœ²å‡ºå»ï¼Œè¯´æˆ‘å¯ä»¥å®ç°æŸä¸ªæ•°æ®åŠ ä¸ŠæŸä¸ªæ•°æ®ï¼Œç­‰äºæŸä¸ªæ•°æ®çš„è¿‡ç¨‹ã€‚å…¶ä»–äººå‘¢å°±åªéœ€è¦æŠŠå‰é¢ä¸¤ä¸ªæ•°æ®ä¼ é€’ç»™ä½ ï¼Œç„¶åä»–å°±èƒ½å¾—åˆ°ä»–çš„ç»“æœï¼Œè¿™å°±æ˜¯è¿›ç¨‹ä¹‹é—´è¿›è¡Œæ•°æ®å…±äº«ã€‚å¸¸è§çš„å‘¢å°±æ˜¯f t p ï¼Œsm t p å’Œh t t p è¿™å°±æ˜¯æœ¬å°èŠ‚ä¸»è¦çš„è®²è§£ã€‚ Socket TCPç‰›åˆ€å°è¯•æŠ¥æ–‡ã€åè®®ã€Macåœ°å€åŒå­¦ä»¬ï¼Œæˆ‘ä»¬å‰é¢ä¸€ä¸ªç« èŠ‚æ¥è®²è§£äº†ä¸€äº›ç®€å•çš„ä»£ç ï¼Œé‚£ä¹ˆåœ¨è¿™é‡Œå‘¢æˆ‘ä»¬ç´§æ¥ç€è¦è¿›è¡Œçš„æ˜¯ä¸€äº›ç†è®ºçŸ¥è¯†çš„ä¸€ä¸ªæ‰©å……ã€‚ä¹‹æ‰€ä»¥è¦è®²è¿™äº›ç†è®ºçŸ¥è¯†ï¼Œå¹¶ä¸æ˜¯è¯´è¿™äº›ç†è®ºçŸ¥è¯†ä½ ä¸€å®šèƒ½å¤Ÿåœ¨åé¢çš„å¼€å‘å½“ä¸­èƒ½å¤Ÿç”¨ä¸Šï¼Œä½†æ˜¯è¿™æœ‰åŠ©äºä½ å¯¹æ•´ä¸ªsocketä½“ç³»çš„ä¸€ä¸ªäº†è§£ï¼Œä»¥åŠä¹Ÿæ˜¯æ‰©å……ä½ çš„ä¸€ä¸ªæ€ç»´ä¸Šçš„ä¸€ç§æ€è€ƒæ–¹å¼çš„ä¸€ç§é¢å¤–çŸ¥è¯†ç‚¹ã€‚æ‰€ä»¥è¯´æˆ‘è®¤ä¸ºç†è®ºè¿˜æ˜¯è›®é‡è¦çš„ã€‚é¦–å…ˆæˆ‘ä»¬æ¥è®²æŠ¥æ–‡æ®µã€‚ä»€ä¹ˆæ˜¯æŠ¥æ–‡ï¼ŸæŠ¥æ–‡æ˜¯æŒ‡tcpipåè®®ä¼ è¾“è¿‡ç¨‹å‘¢èµ·ç€è·¯ç”±å¯¼èˆªä½œç”¨çš„ä¸€ä¸ªä¸œè¥¿ã€‚é‚£ä¹ˆåœ¨tcpipåè®®å½“ä¸­ï¼Œä½ è¦å‘é€ä¸€ä¸ªæ•°æ®åˆ°bå®¢æˆ·ç«¯ã€‚å°±æ‹¿æˆ‘ä»¬ä¸Šä¸€èŠ‚æ‰€è®²çš„demoæ¥è¯´ï¼Œä½ è¦ä»aè¿™ä¸ªè¿›ç¨‹å‘é€ä¸€ä¸ªæ•°æ®åˆ°bè¿›ç¨‹ï¼Œå®ƒå…¶å®å¹¶ä¸æ˜¯è¯´ç®€å•åœ°æŠŠä¸€ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆbyteæ•°æ®ä¼ é€’è¿‡å»è€Œå·²ã€‚å®ƒåœ¨æ•´ä¸ªè¿‡ç¨‹å½“ä¸­è¿˜éœ€è¦æŠŠæ‹œæ‰˜æ•°æ®è¿›è¡Œä¸€å®šçš„æŠ¥æ–‡è§£æï¼Œç„¶ååŠ ä¸Šå¯¹åº”çš„å­—èŠ‚å¤´ï¼Œç„¶åå†æŠŠè¿™ä¸ªå­—èŠ‚å¤´ä¿¡æ¯ä¼ é€’åˆ°bç¨‹åºã€‚ç„¶ååœ¨bç¨‹åºå½“ä¸­ï¼Œå‘¢ï¼Œä»–ä¼šæŠŠå¤´è§£æå¼€ä¹‹åï¼Œæœ€ç»ˆå¾—åˆ°æˆ‘ä»¬åé¢çš„æŠ¥æ–‡æ®µã€‚ç„¶åä¹Ÿå°±æ˜¯å’±ä»¬çš„ä¸€ä¸ªbufferæ•°æ®ã€‚æ‹¿äº†bufferæ•°æ®ä¹‹åå†ä¸¢ç»™åº”ç”¨å±‚ï¼Œåº”ç”¨å±‚æœ€ç»ˆå†æŠŠbufferæ•°æ®è§£ææˆå’±ä»¬çš„è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±å®ç°äº†å’±ä»¬ä¸€ä¸ªå­—ç¬¦ä¸²çš„ä¸€ä¸ªäº¤äº’è¿‡ç¨‹ã€‚å®ƒçš„ä¸»è¦ä½œç”¨å‘¢ï¼ŒæŠ¥æ–‡æ®µæ˜¯ç”¨ä»¥æŸ¥è¯¢å„ä¸ªè·¯ç”±æ®µçš„ipåœ°å€ã€äº¤æ¢åè®®çš„ipæ•°æ®åŒ…ï¼Œé‚£ä¹ˆè¿™ä¸ªæŠ¥æ–‡æ•°æ®å‘¢å°±åŒ…æ‹¬è¿™äº›ä¿¡æ¯ï¼ŒåŒæ ·çš„æŠ¥æ–‡å……å½“æ•´ä¸ªtcpåè®®æ•°æ®åŒ…çš„ä¸€ä¸ªè·¯ç”±åŠŸèƒ½ã€‚æŠ¥æ–‡åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯ä¼šä¸æ–­åœ°å°è£…æˆç»„å°è£…æˆåŒ…ã€å°è£…æˆé’ˆæ¥è¿›è¡Œä¼ è¾“ã€‚ é‚£ä¹ˆè¿™äº›ä¸œè¥¿å‘¢ä¸»è¦çš„ç›®çš„æ˜¯ä¸ºäº†ä»€ä¹ˆï¼Ÿ å½“ä½ çš„ä¸€ä¸ªæ•°æ®è¿‡äºå¤ªå¤§äº†æ—¶å€™ï¼Œé‚£ä¹ˆä»–ä¼šæŠŠä½ çš„ä¸€æ‰¹å¤§æ•°æ®è½¬æ¢æˆå¯¹åº”çš„ä¸€äº›ç»„åˆï¼Œæ˜¯åŒ…æˆ–è€…æ˜¯å¸§ï¼Œç„¶åè§£ææˆä¸€ä¸ªä¸€ä¸ªå°çš„æ•°æ®ç‚¹ï¼Œç„¶åé€šè¿‡å°çš„æ•°æ®ç‚¹ä¼ è¾“è¿‡å»ã€‚ æ¯”å¦‚è¯´ä½ æƒ³å‘é€ä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œå¯¹å§ï¼Œæ–‡ä»¶æ˜¯ä¸€ä¸ªå¾ˆé•¿å¾ˆé•¿çš„ä¸€ä¸ªåŒ…æ•°æ®ï¼Œä½†æ˜¯å‘¢ä½ åœ¨å‘é€çš„è¿‡ç¨‹å½“ä¸­ï¼Œå®ƒæ˜¯éœ€è¦ä¸æ–­çš„æ ¡éªŒçš„ï¼Œtcpipåè®®å½“ä¸­æ˜¯å…ˆè¦å‘é€ï¼Œç„¶åæ”¶åˆ°ä¸€ä¸ªè¿”å›çš„ä¿¡æ¯ï¼Œå¯¹ä¸å¯¹ï¼Ÿå®ƒæ˜¯æœ‰ä¸€ä¸ªæ ¡éªŒçš„è¿‡ç¨‹ï¼Œæ‰€ä»¥è¯´æˆ‘éœ€è¦å…ˆå‘é€ä¸€éƒ¨åˆ†è¿‡å»ï¼Œç„¶åå‘¢åœ¨å›é€è¿™ä¸€éƒ¨åˆ†æˆåŠŸä¸å¦ï¼Œé‚£ä¹ˆæ•´ä¸ªè¿‡ç¨‹å‘¢å®ƒä¼šæŠŠä½ çš„æ•´ä¸ªbufferè§£ææˆå¾ˆå¤šå¾ˆå¤šå°çš„bufferï¼Œç„¶ååœ¨å‰é¢åŠ ä¸Šä¸€å®šçš„å’±ä»¬çš„ä¸€ä¸ªæŠ¥æ–‡å¤´ï¼Œç„¶åå‘¢è¿›è¡Œä¸€ä¸ªæ‰¹é‡çš„å‘é€ï¼Œæ¯ä¸€æ‰¹æ•°æ®å®ƒéƒ½æœ‰ä¸€å®šçš„æ ¡éªŒä½œç”¨ã€‚å°è£…çš„æ–¹å¼å‘¢å°±åƒæˆ‘è¯´çš„ï¼Œå°±æ˜¯åœ¨ä¸€äº›æ§åˆ¶ä¿¡æ¯ä¸Šé¢åŠ ä¸Šä¸€ä¸ªå¤´éƒ¨åŠæŠ¥æ–‡å¤´ã€‚ ç„¶ååé¢æ¥è¯´ä¸€ä¸‹æˆ‘ä»¬æ‰€è°“çš„ä¼ è¾“åè®®ã€‚é¡¾åæ€ä¹‰å°±æ˜¯ä¸€ç§è§„å®šã€ä¸€ç§çº¦æŸã€‚çº¦å®šå¾…é‡é…ç½®åœ¨ç½‘ç»œä¼ è¾“è¿‡ç¨‹ä¾ç„¶æ˜¯é€‚ç”¨çš„ï¼Œç½‘ç»œä¼ è¾“çš„æµç¨‹ä¹‹æ‰€ä»¥æ˜¯å¥å£®çš„ã€ç¨³å®šçš„ï¼Œå…¶å®ä¹Ÿæ˜¯å¾—ç›Šäºå’±ä»¬çš„ä¸€ä¸ªåŸºç¡€çš„åè®®çš„æ„æˆï¼Œå¿…é¡»è¦åŒæ–¹éµå®ˆå…±åŒçš„åè®®ã€‚ç®€å•æ¥è¯´å°±æ˜¯aåˆ°bçš„ä¸€ä¸ªä¼ è¾“æ•°æ®ï¼Œbèƒ½å¤Ÿè¯†åˆ«ï¼Œåä¹‹bè¿”å›ç»™açš„ä¼ è¾“æ•°æ®aä¹Ÿèƒ½è¯†åˆ«ï¼Œè¿™å°±æ˜¯åè®®ã€‚ä¸¤ä¸ªäººä¹‹é—´éµå¾ªè¿™æ ·ä¸€ä¸ªåè®®çš„å…³ç³»ã€‚é‚£æˆ‘ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼Œä½ æƒ³è¦æ‰“ç”µè¯ç»™ä½ çš„å¦ˆå¦ˆï¼Œé‚£ä½ é¦–å…ˆéœ€è¦è¿›è¡Œä¸€ä¸ªæ‹¨å·ï¼Œç„¶åä½ çš„å¦ˆå¦ˆæ‰‹æœºä¼šè¿›è¡Œå“é“ƒï¼Œç„¶åä½ å¦ˆå¦ˆæ¥ç”µè¯ï¼Œç„¶åå‘¢è·Ÿä½ è¿›è¡Œé€šè¯ï¼Œä½ è¯´ä¸€å¥è¯ï¼Œä»–å›ä¸€å¥è¯ï¼Œå¯¹å§ï¼Ÿç„¶åä½ ä»¬ç›´æ¥è¿›è¡Œä¸€ä¸ªäº¤äº’çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚ é‚£ä¹ˆåœ¨è¿™é‡Œä½ é¦–å…ˆæ˜¯éœ€è¦è¿›è¡Œæ‹¨å·ï¼Œä½ å¦ˆå¦ˆç”µè¯æ‰èƒ½å¤Ÿå“é“ƒï¼ŒåŒæ—¶ä»–è¦æ¥å¬ç”µè¯ä¹‹åï¼Œä½ ä»¬ä¿©è¿™æ ·æ‰å¯ä»¥è¿›è¡Œé€šè¯ã€‚é‚£ä¹ˆè¿™æ•´ä¸ªè¿‡ç¨‹å½“ä¸­è¦ç»è¿‡ä¸€ç³»åˆ—çº¦å®šå¥½çš„ã€è§„å®šå¥½çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œè¿™å°±ç§°ä¹‹ä¸ºåè®®ã€‚ é‚£ä¹ˆåŒæ ·çš„ï¼Œä½ å»è®¿é—®ä¸€ä¸ªç½‘ç«™ï¼Œä½ é¦–å…ˆæ˜¯éœ€è¦è¾“å…¥è¿™ä¸ªç½‘ç«™çš„åœ°å€ï¼Œé‚£ä¹ˆå®ƒéœ€è¦è¿›è¡Œä¸€ä¸ªç½‘ç«™çš„ä¸€ä¸ªåœ°å€æŸ¥è¯¢ï¼Œç„¶åå‘¢å»è®¿é—®è¿™ä¸ªç½‘ç«™å¯¹åº”çš„æœåŠ¡å™¨ä¸Šé¢çš„ipåœ°å€å’Œç«¯å£å·ï¼Œç„¶åå‘¢ç½‘ç«™ä¼šè¿”å›å®ƒçš„é¦–é¡µä¿¡æ¯ç»™ä½ ï¼Œé‚£ä¹ˆæ•´ä¸ªè¿‡ç¨‹å°±ä¾æ¬¡å¾€ä¸‹è¿›è¡Œäº¤äº’ï¼Œæ‰€ä»¥è¯´è¿™æ ·çš„ä¸€ä¸ªè¿‡ç¨‹å°±ç§°ä¹‹ä¸ºä¼ è¾“åè®®ã€‚ é‚£ä¹ˆç¬¬ä¸‰ç‚¹ï¼Œæˆ‘ä»¬æ¥è®²ä¸€ä¸‹macåœ°å€ã€‚macåœ°å€å‘¢æ˜¯ä¸€ä¸ªmedia accept controlçš„ä¸€ä¸ªç¼©å†™ï¼Œè¯‘ä¸ºåª’ä½“æ§åˆ¶è®¿é—®ã€‚åª’ä½“è®¿é—®æ§åˆ¶æˆ–ç§°ä¹‹ä¸ºç‰©ç†åœ°å€ã€ç¡¬ä»¶åœ°å€ã€‚åœ¨æ‰€æœ‰æ‰€æœ‰çš„ç¡¬ä»¶åœ°å€ä¸Šéƒ½æœ‰è¿™æ ·çš„ä¸€ä¸ªä¿¡æ¯ï¼Œå«åšmacåœ°å€ï¼Œæ— è®ºæ˜¯ä½ çš„æ‰‹æœºè¿˜æ˜¯ã€‚ä½ çš„è·¯ç”±å™¨ï¼Œè¿˜æ˜¯ä½ çš„ç”µè„‘ï¼Œä»¥åŠä½ çš„æ¯ä¸€å°é€šè®¯è®¾å¤‡ï¼Œå…¶å®éƒ½æœ‰ä¸€ä¸ªåœ°å€å«åšmacåœ°å€ï¼Œå…¶å®å®ƒç”¨çš„é‡å°±æ˜¯æ ‡è¯†è¿™ä¸ªç‰©ç†è®¾å¤‡å®ƒåœ¨ç½‘ç»œä¸Šçš„ä¸€ä¸ªåœ°å€ã€‚é‚£macåœ°å€å…¶å®æ˜¯æœ‰é™çš„ï¼Œmacåœ°å€ç”¨æ¥å®šä¹‰ç½‘ç»œè®¾å¤‡çš„ä¸€ä¸ªä½ç½®ï¼Œå¯¹å§ å½¢å¦‚ï¼š44-45-53-54-00-00 å°±æ˜¯ä¸€ä¸ªmacåœ°å€ï¼Œå…¶å®å°±æ˜¯ä¸ä½ çš„èº«ä»½è¯ç±»ä¼¼ï¼Œä½ æœ‰ä½ çš„èº«ä»½è¯ï¼Œæ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„èº«ä»½è¯ï¼Œé‚£ä¹ˆå°±ç”¨æ¥æ ‡è¯†ä½ è¿™ä¸ªäººã€‚é‚£ä¹ˆæ¯ä¸€å°å¯ä»¥ä¸Šç½‘çš„è®¾å¤‡å®ƒéƒ½æœ‰è¿™æ ·çš„ä¸€ä¸ªmacåœ°å€ï¼Œç”¨æ¥æ ‡è¯†è¿™ä¸ªè®¾å¤‡å®ƒçš„ä½ç½®ã€‚ å“æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸€ä¸ªæ‰‹æœºç«¯çš„ä¸€ä¸ªæ£€æµ‹å›¾ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™é‡Œé¢æœ‰äº›ä»€ä¹ˆæ ·çš„ä¿¡æ¯ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®‰å“å¯¹å§ç³»ç»Ÿæ˜¯å®‰å“ï¼Œç„¶åå‘¢æœ‰ä¸€äº›è“ç‰™ç‰ˆæœ¬å•Šä»€ä¹ˆä»€ä¹ˆä¹‹ç±»çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬åœ¨è¿™é‡Œå‘¢å¹¶ä¸å…³æ³¨è¿™äº›ä¸œè¥¿ï¼Œæˆ‘ä»¬ã€‚éœ€è¦å…³æ³¨çš„æ˜¯ä»€ä¹ˆmacåœ°å€åœ¨è¿™é‡Œã€‚ è¿™å°±æ˜¯å’±ä»¬çš„ä¸€ä¸ªmacåœ°å€ï¼Œå½“ç„¶è¿™å‰é¢è¿˜æœ‰ä¸€ä¸ªb s s idï¼Œç„¶åå®ƒä¹Ÿæ˜¯ä¸€ä¸ªç±»ä¼¼macåœ°å€ä¸€æ ·çš„ä¸œè¥¿ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ— çº¿çš„ç½‘ç»œçš„ä¸€ä¸ªä»–è‡ªå·±çš„ä¸€ä¸ªç½‘å¡çš„ä¸€ä¸ªåœ°å€ã€‚æ‰€ä»¥è¯´è¿™ä¸ªåœ°æ–¹é‚£å®ƒæ˜¯å’Œmacåœ°å€éå¸¸ç±»ä¼¼çš„ã€‚å½“ç„¶ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªå’±ä»¬çš„ipåœ°å€ï¼Œæ˜¯å’±ä»¬å½“å‰çš„ä¸€ä¸ªç½‘ç»œçš„ipåœ°å€ï¼Œå¯¹å§ï¼Œä»¥åŠè¿™è¾¹æœ‰å’±ä»¬çš„ä¸€ä¸ªæ™®é€šç½‘ç»œçš„ä¸€ä¸ªä¿¡æ¯ã€‚å¥½äº†ï¼Œæˆ‘ä»¬å†æ¥ç€å¾€ä¸‹çœ‹ä¸€ä¸‹ã€‚ è¿™æ˜¯ç¬¬äºŒå¹…å›¾ã€‚ç¬¬äºŒå¹…å›¾ä¸Šçš„è¯æŠŠä¸Šé¢çš„ä¸€äº›ç»†èŠ‚è¿›è¡Œä¸€ä¸ªç®€å•çš„å½’ç±»ã€æ€»ç»“ã€‚é‚£æˆ‘ä»¬æ¥ç€æ¥çœ‹ä¸€ä¸‹ipåœ°å€ï¼Œè¿™æ˜¯å’±ä»¬çš„ä¸€äº›åŸºç¡€çš„ipä¿¡æ¯çš„ä¸€ä¸ªè®¾ç½®ï¼Œä»¥åŠå’±ä»¬çš„macåœ°å€å¯¹å§é‚£ä¹ˆå¯ä»¥è¯´å’±ä»¬æ¯ä¸€å°è®¾å¤‡éƒ½æœ‰è¿™æ ·çš„ä¿¡æ¯çš„å­˜åœ¨ï¼Œæœ‰å’±ä»¬çš„ipåœ°å€ï¼Œæœ‰å’±ä»¬çš„macåœ°å€ã€‚ æˆ‘ä»¬ä¹‹æ‰€ä»¥æœ‰ipåœ°å€ã€‚å…¶å®ä¹Ÿæ˜¯å› ä¸ºå’±ä»¬å…ˆè¦æœ‰macåœ°å€ï¼Œmacåœ°å€ä»£è¡¨ä½ è¿™å°ç¡¬ä»¶è®¾å¤‡çš„ä¸€ä¸ªç‰©ç†åœ°å€ï¼ŒåŒæ—¶ä½ çš„i påœ°å€å‘¢æ˜¯å½“å‰å±€åŸŸç½‘æ ¹æ®ä½ çš„macåœ°å€åˆ†é…ç»™ä½ çš„ä¸€ä¸ªä¸´æ—¶çš„ã€å¯ç”¨çš„ä¸€ä¸ªipåœ°å€è€Œå·²ã€‚ IPã€ç«¯å£ã€è¿œç¨‹æœåŠ¡å™¨æˆ‘ä»¬ä¸Šä¸€ä¸ªç« èŠ‚æ¥è®²è§£äº†ä¸€ä¸‹å’±ä»¬é‚£ä¸ªæŠ¥æ–‡ã€macåœ°å€ï¼Œä»¥åŠå’±ä»¬çš„ä¸€äº›åè®®æ–¹é¢çš„ä¸€äº›ä¿¡æ¯ï¼Œé‚£æˆ‘ä»¬æœ¬ç« èŠ‚æ¥è®²è§£ä¸€ä¸‹å’±ä»¬çš„ipä»¥åŠå’±ä»¬ç«¯å£ã€ä»¥åŠè¿œç¨‹æœåŠ¡å™¨çš„æ¦‚å¿µã€‚æœ¬ç« èŠ‚å‘¢æˆ‘ä¼šç”¨ä¸€äº›ç¤ºæ„å›¾ç»™å¤§å®¶è®²è§£ä¸€ä¸‹åŸºç¡€çš„ä¸€äº›åŸç†ï¼Œå°½å¯èƒ½çš„è®©å¤§å®¶ä¸æ„Ÿåˆ°æ¯ç‡¥ã€‚å¥½äº†ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥è¯´ä¸€ä¸‹ipåœ°å€ã€‚ipåœ°å€å³äº’è”ç½‘å½“ä¸­çš„ä¸€ä¸ªåè®®åœ°å€ï¼Œç¼©å†™ä¸ºä¸€ä¸ªipåœ°å€ã€‚é‚£ä¹ˆå½“ç„¶ä¸Šé¢å°±æ˜¯å’±ä»¬ä¸€ä¸ªäº’è”ç½‘çš„ä¸€ä¸ªåè®®åœ°å€ï¼Œæ˜¯åˆ†é…ç»™ç½‘ç»œä¸Šä½¿ç”¨ï¼Œç½‘é™…åè®®è®¾å¤‡ï¼Œæ•°å­—æ ‡ç­¾ã€‚å¸¸è§çš„ipåœ°å€åˆ†ä¸ºipv4å’Œipv6ä¸¤å¤§ç±»ã€‚ é‚£æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œipåœ°å€ç”±ä¸‰åäºŒä½äºŒè¿›åˆ¶ç»„æˆï¼Œå¸¸ä»¥192.168.0.1çš„å½¢å¼å‡ºç° xxx.xxx.xxx.xxxæ¯ä¸€ç»„å‰å‰ä»£è¡¨ç€å°äºæˆ–ç­‰äº255çš„åè¿›åˆ¶æ•°ï¼Œå½“ç„¶å®ƒæ˜¯å¤§äºé›¶çš„ã€‚ æ¯”å¦‚è¯´208.80.152.2 åé¢æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹ipåœ°å€åˆ†ä¸ºabcdä¸€å¤§ç±»ï¼Œå…¶ä¸­eç±»å±äºç‰¹æ®Šçš„ä¿ç•™çš„åœ°å€ï¼Œæ€»çš„æ•°é‡æ˜¯å¤šé•¿å•Šæ€»çš„æ•°é‡æ˜¯å››åäºŒäº¿ä¸ªã€‚æœ€ç»ˆçš„æ—¶å€™æ˜¯åœ¨äºŒé›¶å¹ºå¹ºå¹´äºŒæœˆä¸‰æ—¥çš„æ—¶å€™ï¼Œå…¶å®æ‰€æœ‰çš„åœ°å€å°±å·²ç»è¢«åˆ†é…å°½äº†ï¼Œæ‰€æœ‰çš„ipåœ°å€å…¶å®å·²ç»è¢«åˆ†é…å®Œæˆäº†ï¼Œä½ ç°åœ¨æ‰€ç”¨çš„ipåœ°å€å…¶å®å¹¶ä¸æ˜¯æ•´ä¸ªå› ç‰¹ç½‘çš„ä¸€ä¸ªipåœ°å€ï¼Œä½ çš„ipåœ°å€å…¶å®åªæ˜¯ä¸€ä¸ªå±€åŸŸç½‘ç±»çš„ä¸€ä¸ªåœ°å€ï¼Œä½ çš„å±€åŸŸç½‘ä¸Šé¢å¯èƒ½è¿˜æœ‰å±€åŸŸç½‘ã€‚é‚£ä¹ˆä¸€ç›´åˆ°æ•´ä¸ªå› ç‰¹ç½‘çš„æ—¶å€™å‘¢ï¼Œå®ƒçš„é‚£ä¸ªåœ°å€å…¶å®æ˜¯å·²ç»å›ºå®šå¥½äº†ï¼Œä¸å¯å˜çš„ã€‚å¦‚æœä¸»æœºå·å…¨éƒ¨éƒ½æ˜¯1ï¼Œé‚£ä¹ˆè¿™ä¸ªåœ°å€ç›´æ¥ä¸ºå¹¿æ’­åœ°å€ï¼Œå°±æ¯”å¦‚è¯´1.1.1.1ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªç›´æ¥å¹¿æ’­åœ°å€ï¼Œ åœ°å€255.255.255.255 å—é™çš„å¹¿æ’­åœ°å€ä»£è¡¨ç€ä½ å½“å¤©å±€åŸŸç½‘çš„ä¸€ä¸ªå¹¿æ’­åœ°å€ã€‚ä½ å¦‚æœè¯´ä½¿ç”¨udpå¾€è¿™ä¸ªipåœ°å€å‘é€ä¿¡æ¯ï¼Œé‚£ä¹ˆä½ çš„å±€åŸŸç½‘å†…çš„å…¶ä»–è®¾å¤‡å…¨éƒ¨ä¼šæ”¶åˆ°ä½ çš„udpçš„å¹¿æ’­ã€‚ å¦‚æœè¯´ä½ å¾€1.1.1.1çš„è¿™ä¸ªåœ°å€å‘é€ä¸€ä¸ªudpçš„è¯ï¼Œç†è®ºæ¥è¯´å®ƒä¼šå¾€æ•´ä¸ªå› ç‰¹ç½‘å‘é€ä¸€ä¸ªudpåè®®ï¼Œä½†æ˜¯å…¶å®å®ƒæ˜¯ä¼šè¢«å¯¹åº”çš„å±€åŸŸç½‘çš„é˜²ç«å¢™æ‰€æ‹¦æˆªï¼Œå¹¶ä¸ä¼šå‘é€å‡ºå»ã€‚ç´§æ¥ç€æ¥è¯´ä¸€ä¸‹ipv6ï¼Œå› ä¸ºipv4çš„ä¸€ä¸ªæ•°é‡æ˜¯æœ‰é™çš„ï¼Œè€Œä¸”æ¯”è¾ƒå°‘ï¼Œå››åäºŒäº¿äº†ï¼Œæ‰€ä»¥è¯´å®ƒå·²ç»è¢«åˆ†é…å®Œæˆäº†ã€‚é‚£ä¹ˆåœ¨åé¢å‘¢ä¸ºäº†è§£å†³æ–°å¢çš„ä¸€äº›è®¾å¤‡åœ¨å› ç‰¹ç½‘å½“ä¸­çš„ä¸€ä¸ªåœ°ä½ï¼Œå°±æå‡ºäº†i p v6çš„æ¦‚å¿µï¼Œæ€»å…±æœ‰128ä½é•¿ipv6çš„åœ°å€è¡¨è¾¾å½¢å¼ä¸€èˆ¬é‡‡ç”¨32åå…­è¿›åˆ¶æ•°ï¼Œä¹Ÿå¯ä»¥æƒ³è±¡æˆæ˜¯1632ã€‚ æœ‰ä¸¤ä¸ªé€»è¾‘éƒ¨åˆ†ç»„æˆï¼Œè¿™å…­åå››ä½çš„ç½‘ç»œå‰ç¼€å’Œä¸€ä¸ªå…­åå››ä½çš„ä¸»æœºåœ°å€ï¼Œä¸»æœºåœ°å€å¸¸å¸¸æ˜¯æ ¹æ®ç‰©ç†åœ°å€è‡ªåŠ¨ç”Ÿæˆï¼Œè¿™ä¸ªåœ°æ–¹çš„ä¸»æœºåœ°å€å‘¢å°±æ˜¯ä¸€èˆ¬è€Œè¨€æ˜¯ä¼šæ ¹æ®ä½ çš„macåœ°å€å•Šæˆ–è€…æ˜¯ä½ çš„ä¸€äº›ç¡¬ä»¶è®¾å¤‡ä¿¡æ¯æ¥ç»„æˆã€‚é‚£ä¹ˆä¸€ä¸ªå…­åå››ä½çš„ç½‘ç»œå‰ç¼€å‘¢å°±åœ¨ä»£è¡¨ç€ä½ çš„å½“å‰ç½‘ç»œçš„ä¸€ä¸ªçŠ¶æ€ï¼Œé‚£ä¹ˆåŠ åœ¨ä¸€èµ·å…¶å®å°±å½¢æˆäº†ä½ çš„ipv6åœ°å€ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªipvå…­åœ°å€ï¼Œçœ‹èµ·æ¥æ¯”è¾ƒå¤æ‚ã€‚ ipv6å’Œipv4ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿå› ä¸ºipv6æ˜¯å¤§äºipv4çš„ï¼Œå®ƒçš„æ•°é‡æ˜¯å¤§äºå®ƒçš„ï¼ŒåŒæ—¶ipv4çš„åœ°å€ä¸€å®šæ˜¯å¯ä»¥è½¬æ¢æˆä¸€ä¸ªipv6çš„ä¸€ä¸ªåœ°å€çš„ï¼Œä½†æ˜¯ipv6çš„åœ°å€æ˜¯ä¸ä¸€å®šèƒ½å¤Ÿè½¬æ¢æˆipv4çš„åœ°å€ã€‚ é‚£æˆ‘ç®€å•æ¥è¯´ä¸€ä¸‹ç¬¬äºŒä¸ªå¤§ç‚¹ç«¯å£ã€‚å¦‚æœè¯´æŠŠipåœ°å€å½“ä½œä¸€é—´æˆ¿å­ç«¯å£ï¼Œå°±æ˜¯è¿›å…¥è¿™ä¸ªæˆ¿å­çš„é—¨æˆ–è€…æ˜¯çª—æˆ·ï¼Œè¿™æ˜¯å’±ä»¬ä¹‹å‰æè¿‡çš„æ¦‚å¿µï¼Œåœ¨ä¸åŒçš„çª—æˆ·åæœ‰ä¸åŒçš„äººã€‚é‚£ä¹ˆæˆ¿å­å½“ä¸­çš„ç”¨æˆ·ä¸å¤–ç•Œäº¤æµçš„å‡ºå£å°±æ˜¯å’±ä»¬çš„æˆ¿å­å’Œç«¯å£ç»„æˆäº†è¿™ä¸ªäººå¯¹å¤–äº¤æµçš„ä¸€ä¸ªå‡ºå£ã€‚å¤–ç•Œçš„é¸½å­ä¹Ÿå°±æ˜¯ä¿¡æ¯é£åˆ°ä¸åŒçš„çª—å£ï¼Œä¹Ÿå°±æ˜¯ç»™ä¸åŒçš„äººä¼ é€’ä¿¡æ¯ã€‚é‚£ä¹ˆä½ åœ¨ä¸€ä¸ªæˆ¿å­é‡Œé¢æœ‰ä¸åŒçš„äººï¼Œå°±ä»£è¡¨ç€ä½ çš„ä¸åŒçš„ç¨‹åºçš„è¿›ç¨‹ï¼Œè€Œå¤–é¢ä¸åŒçš„é¸½å­é£æ¥çš„æ—¶å€™ï¼Œå°±ä»£è¡¨ç€ä¸åŒçš„è¿›ç¨‹å‘é€ä¿¡æ¯ã€‚ä»0åˆ°1023ç«¯å£ä»¥åŠ1024åˆ°49151ç«¯å£éƒ½æ˜¯ç‰¹æ®Šç«¯å£ã€‚é‚£ä¹ˆç‰¹æ®Šç«¯å£å‘¢åé¢æˆ‘ä¼šè¡¥å……åˆ°ä¸€ä»½æ–‡æ¡£å½“ä¸­ï¼Œç‰¹æ®Šç«¯å£é‡Œé¢æœ‰éå¸¸å¤šçš„ä¸€äº›ç‰¹æ®Šæ„ä¹‰ã€‚é‚£ä¹ˆè¿™äº›ç«¯å£å‘¢æ˜¯æˆ‘ä»¬ä¸èƒ½å¤Ÿç›´æ¥ä½¿ç”¨çš„ä¸€ä¸ªç«¯å£å·åœ°å€ï¼Œè¿™æ˜¯ä¸€äº›åŸºæœ¬çš„ä¸€äº›ç‰¹æ®Šç«¯å£å·ã€‚ é‚£ä¹ˆé¦–å…ˆæˆ‘ä»¬æ¥è¯´ä¸€ä¸‹äºŒé›¶äºŒå¹ºå·ç«¯å£ä¸€èˆ¬ä¼šç”¨ä½œäºf t påè®®ï¼Œå®ƒæ˜¯ä¸€ä¸ªtcpçš„ä¸€ä¸ªç«¯å£å·ã€‚äºŒåäºŒå·ç«¯å£å‘¢ã€‚ä¸€ä¸ªs s hï¼ŒäºŒåä¸‰å·æ˜¯care nightï¼ŒäºŒåäº”å·æ˜¯s m t pã€‚å½“ç„¶äº”åä¸‰å·æ˜¯dnsã€‚ä½ è¯´ä¹‹æ‰€ä»¥èƒ½å¤Ÿè®¿é—®ä¸€ä¸ªç½‘ç«™ï¼Œå…¶å®æ˜¯å› ä¸ºå®ƒé¦–å…ˆå»è¿›è¡Œä¸€ä¸ªdnsè§£æï¼Œç„¶åæ‹¿åˆ°ä½ çš„åŸŸåå¯¹åº”çš„i påœ°å€å’Œç«¯å£å·ä¹‹åæ‰èƒ½å¤Ÿè¿›è¡Œè®¿é—®ã€‚é‚£ä¹ˆå½“ç„¶è¿˜æœ‰t f t pã€h t t på¯¹å§ï¼Œh t pæ˜¯å’±ä»¬éå¸¸å¸¸è§çš„å…«é›¶ç«¯å£ï¼Œè¿˜æœ‰å’±ä»¬é‚®ä»¶åè®®ç­‰ç­‰ï¼Œè¿˜æœ‰h tt psæ˜¯å››å››ä¸‰åè®®ã€‚ ä¸Šé¢æ¥è®²äº†ä¸‹ç‰¹æ®Šçš„ç«¯å£ï¼Œé‚£ä¹ˆç´§æ¥ç€å¾€ä¸‹è¯´ï¼Œè®¡ç®—æœºä¹‹é—´ä¾ç…§äº’è”ç½‘ä¼ è¾“å±‚é¢çš„tcpipåè®®é€šè®¯ï¼Œä¸åŒçš„åè®®å¯¹åº”çš„ä¸åŒçš„ç«¯å£å·ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸Šé¢å·²ç»è¯´ã€‚åé¢çš„49152åˆ°65535ç«¯å£æ˜¯å±äºåŠ¨æ€ç«¯å£èŒƒå›´ã€‚å°±æ¯”å¦‚è¯´æˆ‘ä»¬ä¹‹å‰å®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡å™¨çš„æ—¶å€™ï¼Œç”Ÿæˆçš„è¿™ä¸ªç«¯å£å·ï¼Œå…¶å®å°±æ˜¯å¤„äºè¿™ä¸ªåŒºé—´çš„ä¸€ä¸ªåŠ¨æ€çš„ä¸€ä¸ªç«¯å£ã€‚æ²¡æœ‰ç«¯å£æ˜¯å¯ä»¥è¢«æ­£å¼çš„æ³¨å†Œä½¿ç”¨çš„ï¼Œå°±æ˜¯è¯´ä½ ä¸å¯èƒ½è¯´æŸä¸ªç«¯å£å·å°±æ˜¯æˆ‘ä¸€å®šè¦ç”¨çš„ï¼Œä½ ä¸èƒ½å¯¹å¤–é¢çš„äººè¯´è¿™ä¸ªç«¯å£å·å°±ä¸€å®šæ˜¯æˆ‘ç”¨çš„ï¼Œå¤–é¢çš„äººä¸èƒ½ç”¨è¿™ä¸ªç«¯å£ä¸èƒ½è¿™æ ·çš„ï¼Œè¿™ä¸ªç«¯å£å·éƒ½æ˜¯ä¸€ä¸ªåŠ¨æ€çš„ç«¯å£ã€‚æ‰€ä»¥è¯´ä½ ä¸èƒ½å¤Ÿå›ºåŒ–å®ƒã€‚é‚£ä¹ˆæ¥è¯´é—®é¢˜ç¬¬ä¸€ç‚¹ï¼Œç«¯å£å·çš„æ€»æ•°æ˜¯å…­äº”äº”ä¸‰å…­ï¼Œé‚£ä¹ˆèƒ½å¤Ÿå»ºç«‹å¤šå°‘ä¸ªè¿æ¥ï¼Ÿå…­äº”ä¸‰å…­ä¸ª?å…¶å®ä¸æ˜¯ã€‚è¿™ä¸ªåœ°æ–¹çš„å…­äº”ä¸‰å…­æ˜¯ä»£è¡¨ç€ä½ è‡ªå·±çš„æœ¬åœ°çš„ç”µè„‘çš„ç«¯å£å·ã€‚é‚£ä¹ˆè¿™ä¸ªç«¯å£å·å‘¢æœ‰å‡ ä¸ªç‚¹ï¼Œé¦–å…ˆç«¯å£å®ƒå¯¹åº”çš„ipä½ å¯ä»¥ç†è§£ä¸ºipï¼Œå°±æ˜¯æˆ¿å­ï¼Œç«¯å£å°±æ˜¯çª—æˆ·ã€‚ä¸åŒçš„ipå°±æ˜¯ä¸åŒçš„æˆ¿å­ã€‚æ‰€ä»¥è¯´ä¸åŒçš„æˆ¿å­ä¹‹é—´å°±æœ‰ä¸åŒçš„è¿™ä¸ªç«¯å£å·ã€‚ä¹Ÿå°±è¯´ä½ çš„ç”µè„‘å¦‚æœè¯´ä¸€æ—¦å…·å¤‡å¤šä¸ªipåœ°å€çš„ä¸€ä¸ªæ–¹æ³•çš„è¯ï¼Œé‚£ä¹ˆä½ å¯ä»¥æœ‰å¤šä¸ªç«¯å£å·ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ çš„ç«¯å£å·è™½ç„¶è¯´æ¯ä¸€ä¸ªipåœ°å€éƒ½æ˜¯è¿™ä¹ˆå¤šï¼Œä½†ã€‚åœ¨ä½ æœ‰å¤šä¸ªipåœ°å€çš„æƒ…å†µä¸‹ï¼Œä½ çš„æœ¬åœ°çš„ç”µè„‘å¯ä»¥å»ºç«‹çš„è¿æ¥æ•°ä¼šè¿œè¿œå¤§äºå…­äº”ä¸‰å…­ä¸ªã€‚å½“ç„¶äº†ï¼Œä½ ä¾ç„¶æ˜¯æœ‰é™çš„ï¼Œä½†æ˜¯å¯¹äºæœåŠ¡å™¨è€Œè¨€ï¼Œç«¯å£æ˜¯å¤ç”¨çš„ã€‚æ¯”å¦‚è¯´æœåŠ¡å™¨ä»–ç›‘å¬å…«é›¶å¹ºç«¯å£ï¼Œæ— è®ºå¤šå°‘ä¸ªå®¢æˆ·ç«¯æ¥ï¼Œä»–éƒ½æ˜¯é€šè¿‡æŠŠä½ å·ç«¯å£è¿›è¡Œäº¤äº’çš„ï¼Œä¸ä¼šåˆ›å»ºé¢å¤–å¤šä½™çš„ç«¯å£ã€‚æ¥è¯´ä¸€ä¸‹æ•°æ®ä¼ è¾“çš„ä¸€ä¸ªå±‚æ¬¡ï¼Œè¿™æ˜¯å’±ä»¬çš„ä¹‹å‰è¯´çš„å››å±‚æ¨¡å‹ã€‚ ç¨‹åºä¹Ÿå°±å’±ä»¬æ•°æ®è¿›å…¥åˆ°ä¼ è¾“å±‚é¢çš„æ—¶å€™ï¼Œä¼ è¾“å±‚é¢æœ‰ä¸€ä¸ªudpçš„æ•°æ®ï¼Œé‚£ä¹ˆudpæ•°æ®ä»–ä¼šå¹²ä¸€ä»¶äº‹æƒ…ï¼ŒåŠ ä¸Šä¸€ä¸ªudpçš„å¤´éƒ¨ï¼Œè¿›å…¥åˆ°åé¢çš„ä¸€ä¸ªinternetè¯¾ç¨‹ï¼Œé‚£ä¹ˆè¿™æ—¶å€™ä¼šè¿›å…¥ipæ•°æ®ã€‚ipæ•°æ®å‘¢å‰é¢ä¼šè¢«åŠ ä¸Šip headerï¼Œä¹Ÿæ˜¯ipå¤´éƒ¨ï¼Œä»–ä¼šæŠŠå‰é¢çš„udpçš„è¿™ä¸ªä¸€ä¸ªæ•´ä½“å…¨éƒ¨è½¬æ¢æˆipçš„ä¸€ä¸ªæ•°æ®ï¼Œå‰é¢åŠ ä¸Šä¸€ä¸ªipçš„æŠ•ã€‚é‚£ä¹ˆå†åˆ°åé¢æ•°æ®é“¾æ¥å±‚çš„æ—¶å€™ï¼Œå®ƒä¼šæŠŠä½ ä¸Šé¢çš„æ•´ä¸ªåè®®å…¨éƒ¨è½¬æ¢æˆä¸€ä¸ªçœŸæ•°æ®ï¼Œä»£è¡¨çš„ä¸€å¸§æ•°æ®ï¼Œé‚£ä¹ˆå®ƒä¼šæœ‰ä¸€ä¸ªå¸§çš„å¤´éƒ¨å’Œå¸§çš„å°¾éƒ¨ã€‚è¿™æ ·çš„è¯å®ƒå‘é€ç»™bçš„æ‰‹bçš„é“¾è·¯å±‚ï¼Œå®ƒä¼šæŠŠå¤´éƒ¨å’Œå°¾éƒ¨å»æ‰ï¼Œç„¶åå¾—åˆ°ipæ•°æ®å±‚ï¼Œå¾€ä¸Šä¸€æ¬¡ä¸¢ï¼Œæœ€ç»ˆåˆ°ç¨‹åºå±‚çš„æ—¶å€™åˆæ˜¯å’±ä»¬çš„åŸå§‹æ•°æ®äº†ã€‚æ‰€ä»¥è¯´å’±ä»¬æ•°æ®çš„å‘é€è¿‡ç¨‹æ˜¯ä¼šç»è¿‡å±‚å±‚çš„ä¸€ä¸ªå¤´éƒ¨çš„è¿½åŠ ã€‚ é‚£ä¹ˆæ¥è¯´ä¸€ä¸‹è¿œç¨‹æœåŠ¡å™¨æ˜¯ä»€ä¹ˆ?è¿œç¨‹æœåŠ¡å™¨ä¸€èˆ¬è€Œè¨€å±€åŸŸç½‘ï¼Œä¹Ÿå°±æ˜¯æŒ‡ä½ å®¶é‡Œé¢æˆ–è€…æ˜¯ä½ å…¬å¸é‡Œé¢çš„ç½‘ç»œéƒ½æ˜¯å±äºå±€åŸŸç½‘çš„ã€‚æˆ‘å’Œä½ ä»¬çš„ç”µè„‘ä¹‹é—´æ˜¯å±äºäº’è”ç½‘çš„ï¼Œè€Œéå±€åŸŸç½‘ã€‚æˆ‘çš„ç”µè„‘å’Œä½ çš„ç”µè„‘ä¹‹é—´çš„å…³ç³»å±äºäº’è”ç½‘çš„å…³ç³»ï¼Œè€Œä¸æ˜¯å±€åŸŸç½‘ï¼Œä½†æ˜¯ä½ çš„ç”µè„‘å’Œä½ çš„æ‰‹æœºä¹‹é—´çš„å…³ç³»æ˜¯å±äºä¸€ä¸ªå±€åŸŸç½‘ï¼Œå½“ç„¶ä½ çš„æ‰‹æœºå¾ˆç®€ã€‚å’Œç”µè„‘è¦è¿æ¥åŒä¸€ä¸ªæ— çº¿è·¯ç”±å™¨æ‰è¡Œã€‚é»˜è®¤çš„æˆ‘çš„ç”µè„‘æ˜¯æ— æ³•ç›´æ¥é“¾æ¥åˆ°ä½ ä»¬çš„ç”µè„‘çš„ï¼Œå› ä¸ºä½ ä»¬çš„ç”µè„‘åœ¨ä½ ä»¬çš„å±€åŸŸç½‘å½“ä¸­æˆ‘çš„ç”µè„‘åœ¨æˆ‘çš„å±€åŸŸç½‘å½“ä¸­ï¼Œä½ è™½ç„¶ç”µè„‘ä¸Šæœ‰ä¸€ä¸ªipåœ°å€ï¼Œä½†æ˜¯é‚£ä¸ªipåœ°å€å¹¶ä¸æ˜¯ä½ çš„äº’è”ç½‘ipåœ°å€ï¼Œè€Œæ˜¯ä½ çš„å±€åŸŸç½‘ipåœ°å€ï¼Œæˆ‘çš„ç”µè„‘ä¸Šä¹Ÿæœ‰ipåœ°å€ï¼Œæˆ‘çš„åœ°å€å‘¢ä¹Ÿæ˜¯æˆ‘çš„å±€ç½‘åœ°å€ã€‚æ‰€ä»¥è¯´æˆ‘å°±ç®—çŸ¥é“ä½ çš„ipï¼ŒåªçŸ¥é“ä½ çš„ç«¯å£ï¼Œä½ èƒ½å¤Ÿå»ºç«‹ä¸€ä¸ªsocketçš„ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä½†æ˜¯æˆ‘æ˜¯æ— æ³•è¿æ¥ä½ çš„ï¼Œæˆ‘è¿æ¥çš„æ°¸è¿œæ˜¯æˆ‘çš„è¿™ä¸ªå±€åŸŸç½‘è¿›è¡Œæ‰«æçš„ã€‚å¦‚æœè¯´æˆ‘æƒ³è¦è¿æ¥ä½ æ€ä¹ˆåŠå‘¢ï¼Ÿçœ‹åé¢ã€‚ è¿™æ˜¯å’±ä»¬çš„ä¸€ä¸ªå±€ç½‘é‡Œé¢çš„ä¸€äº›è®¾å¤‡ï¼Œè¿™ä¸ªæ˜¯å¦å¤–ä¸€ä¸ªå±€ç½‘é‡Œé¢ä¹Ÿæ˜¯ä¸€äº›è®¾å¤‡ã€‚æˆ‘ä»¬å°è¯•æŠŠè¿™å°ç”µè„‘è·Ÿè¿™å°ç”µè„‘ä¹‹é—´è¿›è¡Œè¿æ¥ï¼Œä¼ è¾“æ•°æ®èƒ½ä¸èƒ½å‘¢ï¼Ÿå¯¹ä¸å¯¹ï¼Ÿè¿™ä¹Ÿæ˜¯è¯´äº†ä¸¤ä¸ªå±€åŸŸç½‘ä¹‹é—´å†…éƒ¨çš„è®¾å¤‡æ˜¯æ— æ³•ç›´æ¥è¿›è¡Œé€šè®¯çš„ï¼Œæ— æ³•ç›´æ¥è¿›ã€‚è¿æ¥çš„ã€‚ä½ å¯ä»¥è¯´å“ä¸ºä»€ä¹ˆä½ çš„qqå¯ä»¥ç»™æˆ‘çš„qqå‘é€æ¶ˆæ¯ï¼Œé‚£ä¹ˆä¸€å®šæ˜¯ä½ çš„æ‰‹æœºè·Ÿæˆ‘çš„æ‰‹æœºä¹‹é—´ç›´æ¥è¿æ¥çš„å—ï¼Ÿä¸æ˜¯ã€‚å…¶å®æ˜¯è¿™æ ·çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªå±€åŸŸç½‘è¿™ä¹Ÿæ˜¯å¦å¤–ä¸€ä¸ªå±€åŸŸç½‘ã€‚ æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¿™ä¸ªæœåŠ¡å™¨æ¥å…·å¤‡çš„å¤–ç½‘åœ°å€ï¼Œå°±æˆ‘ä»¬å‰é¢è¯´çš„ipvå››ã€ipvå…­ï¼Œå®ƒå‰é¢éƒ½æœ‰ä¸€éƒ¨åˆ†å·²ç»åˆ†é…çš„åœ°å€ï¼Œåˆ†é…çš„è¿™ä¸ªåœ°å€å°±æ˜¯å’±ä»¬æ•´ä¸ªäº’è”ç½‘å¤–éƒ¨çš„ä¸€ä¸ªidï¼Œè¿™éƒ¨åˆ†åœ°å€æ˜¯å·²ç»åˆ†é…å‡ºå»äº†ï¼Œå·²ç»æ˜¯å›ºå®šçš„ã€‚æ¯”å¦‚è¯´å’±ä»¬çš„ä¸€äº›æ”¿åºœçš„æœåŠ¡å™¨ï¼Œæˆ–è€…è¯´å’±ä»¬çš„ä¸»å¹²ä¸Šé¢çš„ä¸€äº›æœåŠ¡å™¨ï¼Œå®ƒçš„ipåœ°å€æ°¸è¿œæ˜¯å›ºå®šçš„ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªå¯¹å¤–æ‰€æœ‰çš„è®¾å¤‡éƒ½æœ‰æ•ˆçš„ä¸€ä¸ªipåœ°å€ã€‚ä½ çš„ç”µè„‘è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œç„¶åå‘¢æœåŠ¡å™¨å‘¢ä¹Ÿè¿æ¥åˆ°æˆ‘çš„ç”µè„‘ï¼Œç„¶åå°±å®ç°äº†ä¸€ä¸ªæ•°æ®çš„äº¤æ¢ï¼Œä½ æŠŠæ•°æ®å…ˆå‘é€åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å‘¢å†æŠŠæ•°æ®é€šçŸ¥åˆ°æˆ‘ï¼Œokã€‚è¿™å°±å®ç°äº†æˆ‘ä»¬ä¹‹é—´çš„æ•°æ®äº¤äº’ï¼Œä¹Ÿå°±æ˜¯qqçš„ä¸€ä¸ªä½œç”¨ã€‚qqå®ƒä¹‹æ‰€ä»¥èƒ½å¤Ÿä½ å‘é€ä¸‹å»ç»™æˆ‘ä¹Ÿæ˜¯è¿™æ ·ã€‚è¯·æ¥ç€æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹æˆ‘ä»¬çš„ä¸€ä¸ªwebè¯·æ±‚æµç¨‹ã€‚ ä½ çš„ç”µè„‘å»è®¿é—®ä¸€ä¸ªç½‘é¡µï¼Œä½ è¯·æ±‚ä¸€ä¸ªç½‘é¡µçš„æ—¶å€™ï¼Œä½ çš„åœ°å€æ˜¯å¹ºä¹äºŒç‚¹å¹ºå…­å…«ç‚¹å¹ºç‚¹å¹ºå¹ºäºŒï¼Œè¿™ä¸ªåœ°å€æ˜¯ä½ çš„å±€åŸŸç½‘åœ°å€å¹ºä¹äºŒç‚¹å¹ºå…­å…«ã€‚é‡åˆ°è¿™æ ·çš„åœ°å€ä¸€å®šæ˜¯ä½ çš„å±€æœ‰ç½‘åœ°å€ï¼Œé‚£ä¹ˆå¤–ç½‘æœåŠ¡å™¨çš„åœ°å€ä½ è¦æƒ³è®¿é—®çš„åœ°å€ä¸€å®šæ˜¯ä¸€ä¸ªå¤–ç½‘æœåŠ¡å™¨çš„åœ°å€ï¼Œå®ƒçš„åœ°å€æ˜¯ä»€ä¹ˆå¹ºå¹ºé›¶ç‚¹ä¹ã€é›¶ç‚¹å››ã€äº”ç‚¹å…­ï¼Œè¿™æ˜¯ä¸€å°å¤–ç½‘åœ°å€çš„æœåŠ¡å™¨ã€‚é‚£ä¹ˆé¦–å…ˆä½ è¦è¿›è¡Œçš„æ˜¯ä½ è®¿é—®ï¼Œæ¯”å¦‚ä½ è®¿é—®ç™¾åº¦ï¼Œä½ é¦–å…ˆä½ ä½ è¾“å…¥çš„æ˜¯ä¸€ä¸ªç™¾åº¦ç‚¹comï¼Œå¯¹å§ï¼Ÿé‚£ä¹ˆè¿™ä¸ªä¸œè¥¿æ˜¯ä¸€ä¸ªåŸŸåï¼Œé¦–å…ˆå®ƒè¦è¿›è¡Œä¸€ä¸ªåŸŸåæœåŠ¡å™¨çš„ä¸€ä¸ªæŸ¥è¯¢ï¼Œæ‰€ä»¥è¯´å®ƒä¼šç»è¿‡ä¸€ä¸ªåŸŸåæœåŠ¡å™¨çš„ä¸€ä¸ªudpäº”ä¸‰çš„è¿™ä¸ªç«¯å£ã€‚ä¸‹é¢æˆ‘ä»¬ä¹Ÿè¯´äº†ï¼Œäº”åä¸‰å·ç«¯å£æ˜¯ä¸€ä¸ªudpçš„ä¸€ä¸ªåè®®ç«¯å£ï¼Œå»æŸ¥è¯¢å®ƒçš„åœ°å€ï¼Œä½ çš„ç”µè„‘å°±ä¼šæ‹¿ã€‚å¥½ï¼Œæƒ³è®¿é—®çš„è¿™ä¸ªç™¾åº¦è¿™ä¸ªæœåŠ¡å™¨çš„å…·ä½“çš„åœ°å€ä»¥åŠå®ƒçš„ç«¯å£å·ã€‚ä»–çš„åœ°å€å‡å¦‚ä»–å°±æ˜¯å¹ºå¹ºé›¶ç‚¹ä¹ã€é›¶ç‚¹å››ã€äº”ç‚¹å…­ï¼Œå®ƒçš„ç«¯å£å·æ˜¯ä»€ä¹ˆå‘€ï¼Ÿä½ è®¿é—®ç½‘é¡µç«¯å£å·æ°¸è¿œéƒ½æ˜¯å…«é›¶åï¼Œå½“ä½ æ²¡æœ‰æŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œé‚£ä¹ˆå°±æˆ–è€…æ˜¯å…«è¿å·ç«¯å£å°±è¿›è¡Œä¸€ä¸ªhttpçš„åè®®ï¼Œokï¼Œå°±è¿›è¡Œäº¤äº’ï¼Œç„¶åä½ ä»¬ä¸¤ä¸ªäººå°±å¯ä»¥è¿›è¡Œä¼ æ•°æ®äº†ã€‚å½“ç„¶å¯¹httpså°±æ˜¯443å·ç«¯å£å·ï¼Œéƒ½æ˜¯tcpåè®®ã€‚æˆ‘ä»¬æ‰€è°“çš„httpæˆ–è€…æ˜¯h tt psï¼Œå…¶å®éƒ½æ˜¯åŸºäºtcpè¿›è¡Œçš„ä¸€ä¸ªå°è£…ã€‚å¥½çš„ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æœ¬ç« èŠ‚çš„ä¸€ä¸ªä¸»è¦çš„ä¸€äº›çŸ¥è¯†ç‚¹ã€‚é‚£ä¹ˆä¸‹ä¸ªç« èŠ‚å‘¢æˆ‘ä»¬ä¼šå¼€å§‹è®²è§£ä¸€ä¸‹udpç›¸å…³çš„ä¸€äº›çŸ¥è¯†ç‚¹ï¼Œä»¥åŠudpçš„æ¡ˆä¾‹ã€‚å¥½çš„ï¼Œè°¢è°¢å¤§å®¶ã€‚","categories":[],"tags":[]},{"title":"Jetpackç³»åˆ—â€”LiveData","slug":"Jetpackç³»åˆ—â€”LiveData","date":"2022-02-16T07:12:20.000Z","updated":"2022-05-12T11:08:13.000Z","comments":true,"path":"2022/02/16/Jetpackç³»åˆ—â€”LiveData/","link":"","permalink":"http://example.com/2022/02/16/Jetpack%E7%B3%BB%E5%88%97%E2%80%94LiveData/","excerpt":"","text":"LiveData ç¡®ä¿UIç¬¦åˆæ•°æ®çŠ¶æ€ ä¸éœ€è¦æ‰‹åŠ¨å¤„ç†ç”Ÿå‘½å‘¨æœŸ å§‹ç»ˆä¿æŒæœ€æ–°çš„æ•°æ® äº‹ä»¶æ€»çº¿liveDataBus ç¡®ä¿UIç¬¦åˆæ•°æ®çŠ¶æ€ å› ä¸ºlivedataå®ç°äº†è§‚å¯Ÿè€…æ¨¡å¼ å®ƒé‡Œé¢çš„æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œä¼šå‘æ³¨å†Œçš„Observerè§‚å¯Ÿè€…å‘é€é€šçŸ¥ï¼Œè¿™æ—¶å¯ä»¥åœ¨è§‚å¯Ÿè€…çš„onChangedé‡Œé¢æ›´æ”¹UI ä»¥ä¿æŒæ•°æ®çš„æœ€æ–°åŒ– ä¸éœ€è¦æ‰‹åŠ¨å¤„ç†ç”Ÿå‘½å‘¨æœŸ åœ¨æ³¨å†Œobserveçš„æ—¶å€™ï¼Œä¼šå°†å½“å‰å®¿ä¸»çš„ç”Ÿå‘½å‘¨æœŸè¿›è¡Œç»‘å®šï¼Œå½“å®¿ä¸»è¢«é”€æ¯æ—¶ï¼Œå°±è‡ªåŠ¨çš„è¿›è¡Œé”€æ¯ å§‹ç»ˆä¿æŒæœ€æ–°çš„æ•°æ® å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œå½“å®¿ä¸»çš„ç”Ÿå‘½å‘¨æœŸå˜ä¸ºéæ´»è·ƒçŠ¶æ€çš„æ—¶å€™ï¼Œé‚£ä¹ˆå®ƒå°†åœ¨å†æ¬¡å˜ä¸ºæ´»è·ƒçŠ¶æ€çš„æ—¶å€™ï¼Œæ¥æ”¶åˆ°æœ€æ–°çš„æ•°æ®ï¼Œæ¯”å¦‚activity ä»å‰å°è¿”å›åˆ°åå°ï¼Œå†ä»åå°è¿”å›å‰å°ã€‚å†æ¯”å¦‚actvityå’Œfragmentç”±äºé…ç½®çš„æ›´æ”¹ï¼Œè€Œé‡æ–°åˆ›å»ºï¼Œä¹Ÿæ˜¯èƒ½å¤Ÿæ¥æ”¶åˆ°æœ€æ–°å¯ç”¨çš„æ•°æ®ï¼Œæ¥ä¿æŒæœ€æ–°çš„æ•°æ®å’ŒUI äº‹ä»¶æ€»çº¿liveDataBus ä½¿ç”¨livedataæ¥å®ç°æ¶ˆæ¯æ€»çº¿ï¼Œæ›¿ä»£ä½¿ç”¨eventbus 1234567891011//æœ‰å‚æ•°æ„é€  mVersion = 0 public LiveData(T value) &#123; mData = value; mVersion = START_VERSION + 1;&#125;//æ— å‚æ•°æ„é€ ï¼ŒmVersion = -1 mData = NOT_SETpublic LiveData() &#123; mData = NOT_SET; mVersion = START_VERSION;&#125; é‚£ä¹ˆä¸ºä»€ä¹ˆlivedataéœ€è¦ä¸€ä¸ªversionå‘¢ï¼Ÿ å› ä¸ºlivedataé€šè¿‡versionæ¥æ§åˆ¶æ•°æ®åˆ†å‘ï¼Œé€šè¿‡mVersionæ¥è¿›è¡Œæ•°æ®çš„æ¯”å¯¹ï¼Œæœ¬æ¬¡æ˜¯å¦éœ€è¦è¿›è¡Œæ•°æ®çš„åˆ†å‘ï¼Œå› ä¸ºä¸èƒ½livedataå‘é€ä¸€æ¬¡æ•°æ®ï¼Œè€Œobservableèƒ½æ¥æ”¶åˆ°2ï¼Œ3æ¬¡æ•°æ® 123456789101112131415161718192021//æŠŠå®¿ä¸»å’Œobserverè¿›è¡Œç»‘å®špublic void observe(@NonNull LifecycleOwner owner, @NonNull Observer&lt;? super T&gt; observer) &#123; assertMainThread(&quot;observe&quot;); if (owner.getLifecycle().getCurrentState() == DESTROYED) &#123; // ignore return; &#125; //æŠŠlifecycle å’Œ observeråŒ…è£…æˆäº†ä¸€ä¸ªLifecycleBoundObserverï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªæœ‰è¾¹ç•Œçš„çš„observer LifecycleBoundObserver wrapper = new LifecycleBoundObserver(owner, observer); //åŒ…è£…å®Œåï¼ŒæŠŠwrapperæ”¾å…¥ä¸€ä¸ªhashmapé‡Œ ObserverWrapper existing = mObservers.putIfAbsent(observer, wrapper); if (existing != null &amp;&amp; !existing.isAttachedTo(owner)) &#123; throw new IllegalArgumentException(&quot;Cannot add the same observer&quot; + &quot; with different lifecycles&quot;); &#125; if (existing != null) &#123; return; &#125; //æ³¨æ„è¿™é‡Œä¼ å…¥çš„æ˜¯åŒ…è£…åçš„wrapper lifecycleboundobserver owner.getLifecycle().addObserver(wrapper);&#125; é€šè¿‡observeå¯ä»¥å‘livedataæ³¨å†Œä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡ owner.getLifecycle().addObserver(wrapper) è¿›å…¥ ä¼šè¿›è¡Œåˆ°å®ç° LifecycleRegistry.addObserver(observer)æ–¹æ³• 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152public void addObserver(@NonNull LifecycleObserver observer) &#123; enforceMainThreadIfNeeded(&quot;addObserver&quot;); //åˆ¤æ–­å½“å‰å®¿ä¸»çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ State initialState = mState == DESTROYED ? DESTROYED : INITIALIZED; //åˆ¤æ–­å®Œåï¼Œä¼šæŠŠå½“å‰å®¿ä¸»çš„ç”Ÿå‘½å‘¨æœŸå’Œè§‚å¯Ÿè€…è¿›è¡ŒåŒ…è£… ObserverWithState statefulObserver = new ObserverWithState(observer, initialState); //åŒ…è£…å®Œæˆåä¹Ÿä¼šå­˜å‚¨åˆ°hashmapé‡Œ ObserverWithState previous = mObserverMap.putIfAbsent(observer, statefulObserver); //ä¸ºä»€ä¹ˆè¦å†è¿›è¡Œè¿™ä¹ˆåŒ…è£…å‘¢ï¼Ÿä¸»è¦æ˜¯ä¸ºäº†åˆ†å‘å½“å‰å®¿ä¸»çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ç»™æ¯ä¸ªobserver if (previous != null) &#123; return; &#125; LifecycleOwner lifecycleOwner = mLifecycleOwner.get(); if (lifecycleOwner == null) &#123; // it is null we should be destroyed. Fallback quickly return; &#125; boolean isReentrance = mAddingObserverCounter != 0 || mHandlingEvent; State targetState = calculateTargetState(observer); mAddingObserverCounter++; while ((statefulObserver.mState.compareTo(targetState) &lt; 0 &amp;&amp; mObserverMap.contains(observer))) &#123; pushParentState(statefulObserver.mState); final Event event = Event.upFrom(statefulObserver.mState); if (event == null) &#123; throw new IllegalStateException(&quot;no event up from &quot; + statefulObserver.mState); &#125; //åˆ†å‘å®¿ä¸»çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ ç»™observer statefulObserver.dispatchEvent(lifecycleOwner, event); popParentState(); // mState / subling may have been changed recalculate targetState = calculateTargetState(observer); &#125; if (!isReentrance) &#123; // we do sync only on the top level. sync(); &#125; mAddingObserverCounter--;&#125;void dispatchEvent(LifecycleOwner owner, Event event) &#123; State newState = event.getTargetState(); mState = min(mState, newState); //è¿™ä¸ªlifecycleobserverå°±æ˜¯æˆ‘ä»¬ä¼ é€’è¿›æ¥çš„lifecyclebounderobserver mLifecycleObserver.onStateChanged(owner, event); mState = newState;&#125; è¿™ä¸ªæ¥å£æ˜¯ LifecycleEventObserverçš„ 1234public interface LifecycleEventObserver extends LifecycleObserver &#123; //è¿™ä¸ªå›è°ƒçš„æ˜¯å®¿ä¸»ç”Ÿå‘½å‘¨æœŸçš„å˜åŒ– æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å®¿ä¸» ä¸€ä¸ªæ˜¯Event void onStateChanged(@NonNull LifecycleOwner source, @NonNull Lifecycle.Event event);&#125; 12345678910111213141516171819202122232425262728293031public enum Event &#123; /** * Constant for onCreate event of the &#123;@link LifecycleOwner&#125;. */ ON_CREATE, /** * Constant for onStart event of the &#123;@link LifecycleOwner&#125;. */ ON_START, /** * Constant for onResume event of the &#123;@link LifecycleOwner&#125;. */ ON_RESUME, /** * Constant for onPause event of the &#123;@link LifecycleOwner&#125;. */ ON_PAUSE, /** * Constant for onStop event of the &#123;@link LifecycleOwner&#125;. */ ON_STOP, /** * Constant for onDestroy event of the &#123;@link LifecycleOwner&#125;. */ ON_DESTROY, /** * An &#123;@link Event Event&#125; constant that can be used to match all events. */ ON_ANY;&#125; å®¿ä¸»çš„æ¯ä¸ªç”Ÿå‘½å‘¨æœŸçš„æ”¹å˜éƒ½ä¼šå›è°ƒåˆ°onStateChanged æˆ‘ä»¬çœ‹ä¸‹å®ƒçš„å®ç° LifecycleBoundObserver å®ç°äº†LifecycleEventObserver LifecycleBoundObserver.onStateChanged 1234567891011121314151617public void onStateChanged(@NonNull LifecycleOwner source, @NonNull Lifecycle.Event event) &#123; Lifecycle.State currentState = mOwner.getLifecycle().getCurrentState(); //å¦‚æœå½“å‰çŠ¶æ€æ˜¯destroyed if (currentState == DESTROYED) &#123; //è‡ªè¡Œç§»é™¤ï¼Œè‡ªè¡Œåæ³¨å†Œè¿™ä¸ªobserver removeObserver(mObserver); return; &#125; Lifecycle.State prevState = null; while (prevState != currentState) &#123; prevState = currentState; //å¦åˆ™å°±æ‰§è¡Œæ´»è·ƒçŠ¶æ€çš„å˜æ›´ çœ‹shouldBeActiveæ–¹æ³• activeStateChanged(shouldBeActive()); currentState = mOwner.getLifecycle().getCurrentState(); &#125;&#125; 1234//è¿™é‡Œåˆ¤æ–­äº†åªæœ‰å®¿ä¸»çš„ç”Ÿå‘½å‘¨æœŸå¤§äºstartçš„æ—¶å€™ æ‰ä»£è¡¨å®¿ä¸»æ˜¯æ´»è·ƒçš„boolean shouldBeActive() &#123; return mOwner.getLifecycle().getCurrentState().isAtLeast(STARTED);&#125; ç»§ç»­çœ‹activeStateChanged 12345678910111213void activeStateChanged(boolean newActive) &#123; if (newActive == mActive) &#123; return; &#125; mActive = newActive; changeActiveCounter(mActive ? 1 : -1); if (mActive) &#123; dispatchingValue(this); &#125;&#125; 1234567891011121314151617181920212223void changeActiveCounter(int change) &#123; int previousActiveCount = mActiveCount; mActiveCount += change; if (mChangingActiveState) &#123; return; &#125; mChangingActiveState = true; try &#123; while (previousActiveCount != mActiveCount) &#123; boolean needToCallActive = previousActiveCount == 0 &amp;&amp; mActiveCount &gt; 0; boolean needToCallInactive = previousActiveCount &gt; 0 &amp;&amp; mActiveCount == 0; previousActiveCount = mActiveCount; if (needToCallActive) &#123;//é¦–æ¬¡æ³¨å†Œä¼šæ‰§è¡ŒonActive onActive(); &#125; else if (needToCallInactive) &#123;//å½“æœ€åä¸€ä¸ªè§‚å¯Ÿè€…è¢«ç§»é™¤æ—¶ï¼Œä¼šæ‰§è¡ŒonInactive onInactive(); &#125; &#125; &#125; finally &#123; mChangingActiveState = false; &#125;&#125; 123protected void onInactive() &#123;//å¯ä»¥åˆå§‹åŒ–&#125; 123protected void onActive() &#123;//å¯ä»¥åæ³¨å†Œï¼Œé‡Šæ”¾èµ„æºï¼Œæ¸…ç† pagingå°±åˆ©ç”¨äº†è¿™é‡Œ&#125; æ¥ç€çœ‹ ä¼ å…¥true æ‰§è¡ŒdispatchingValue æŠŠå½“å‰çš„observerä¼ å…¥è¿›å» 123if (mActive) &#123; dispatchingValue(this);&#125; 123456789101112131415161718192021222324void dispatchingValue(@Nullable ObserverWrapper initiator) &#123; if (mDispatchingValue) &#123; mDispatchInvalidated = true; return; &#125; mDispatchingValue = true; do &#123; mDispatchInvalidated = false; //ä¸ä¸ºç©ºï¼Œèµ°åˆ°considerNotify é‡Œï¼Œè§considerNotify if (initiator != null) &#123; considerNotify(initiator); initiator = null; &#125; else &#123; for (Iterator&lt;Map.Entry&lt;Observer&lt;? super T&gt;, ObserverWrapper&gt;&gt; iterator = mObservers.iteratorWithAdditions(); iterator.hasNext(); ) &#123; considerNotify(iterator.next().getValue()); if (mDispatchInvalidated) &#123; break; &#125; &#125; &#125; &#125; while (mDispatchInvalidated); mDispatchingValue = false;&#125; 1234567891011121314151617181920private void considerNotify(ObserverWrapper observer) &#123; //å¦‚æœ observeræ˜¯ä¸æ´»è·ƒçš„ï¼Œä¹Ÿæ˜¯ä¸è¿›è¡Œåˆ†å‘çš„ if (!observer.mActive) &#123; return; &#125; //å†åˆ¤æ–­å®¿ä¸»çš„ç”Ÿå‘½å‘¨æœŸæ˜¯å¦å¤§äºstartçŠ¶æ€ if (!observer.shouldBeActive()) &#123; //å¦‚æœä¸æ´»è·ƒï¼Œå°±æŠŠactvityStateChangedçŠ¶æ€è½¬ä¸ºfalse observer.activeStateChanged(false); return; &#125; //mVersionæ˜¯åœ¨livedataçš„æ„é€ é‡Œåˆ›å»ºçš„ åªæœ‰å½“observer.mLastVersion å°äºmVersionçš„æ—¶å€™æ‰ä¼šè¿›è¡Œåˆ†å‘ if (observer.mLastVersion &gt;= mVersion) &#123; return; &#125; //è¿™é‡Œæ˜¯åˆ†å‘åï¼Œè¦æŠŠmLastVersion å’ŒmVersionè¿›è¡ŒåŒæ­¥èµ‹å€¼ observer.mLastVersion = mVersion; //è¿™é‡Œæ‰æ˜¯çœŸæ­£çš„åˆ†å‘å›è°ƒonChaned æŠŠlivedataé‡Œçš„æ³›å‹æ•°æ®ä¼ å…¥è¿›å» observer.mObserver.onChanged((T) mData);&#125; livedataä¸­è¿˜æœ‰ä¸€ä¸ªæ–¹æ³• 12345678910111213public void observeForever(@NonNull Observer&lt;? super T&gt; observer) &#123; assertMainThread(&quot;observeForever&quot;); AlwaysActiveObserver wrapper = new AlwaysActiveObserver(observer); ObserverWrapper existing = mObservers.putIfAbsent(observer, wrapper); if (existing instanceof LiveData.LifecycleBoundObserver) &#123; throw new IllegalArgumentException(&quot;Cannot add the same observer&quot; + &quot; with different lifecycles&quot;); &#125; if (existing != null) &#123; return; &#125; wrapper.activeStateChanged(true);&#125; å¦‚æœæ³¨å†Œäº†è¿™ä¸ªæ–¹æ³•ï¼Œåœ¨å®¿ä¸»è¢«é”€æ¯æ—¶ï¼Œlivedataæ˜¯ä¸ä¼šå¸®æˆ‘ä»¬åæ³¨å†Œçš„ï¼Œéœ€è¦æˆ‘ä»¬è‡ªè¡Œå»è°ƒç”¨removeObserver æ¥ç€æ¥çœ‹postValue 1234567891011protected void postValue(T value) &#123; boolean postTask; synchronized (mDataLock) &#123; postTask = mPendingData == NOT_SET; mPendingData = value; &#125; if (!postTask) &#123; return; &#125; ArchTaskExecutor.getInstance().postToMainThread(mPostValueRunnable);&#125; å¦‚æœå½“å‰åœ¨å­çº¿ç¨‹ä¸­ï¼Œåˆ™å¿…é¡»è°ƒç”¨postvalue ä¸èƒ½è°ƒç”¨ setvalue 1234567protected void setValue(T value) &#123; assertMainThread(&quot;setValue&quot;); //æ–°çš„æ•°æ®éœ€è¦è¿›è¡Œåˆ†å‘ï¼Œè¿™é‡ŒmLastVersionå°±å°äºmVersionäº†ï¼Œå¯ä»¥è¿›è¡Œåˆ†å‘ï¼Œå¦‚æœè°ƒç”¨äº†onChangedçš„ï¼Œæ¶ˆè´¹äº†è¿™ä¸ªäº‹ä»¶å’Œæ•°æ®ï¼ŒmLastVersionå°±åŒæ­¥äº† mVersion++; mData = value; dispatchingValue(null);&#125; dispatchingValue ä¼ äº†nullå€¼ è¿™ä¸ªè¦åŒºåˆ«äºä¸Šé¢activeStateChangedä¸­çš„dispatchingValue 1234567891011121314151617181920212223242526void dispatchingValue(@Nullable ObserverWrapper initiator) &#123; if (mDispatchingValue) &#123; mDispatchInvalidated = true; return; &#125; mDispatchingValue = true; do &#123; mDispatchInvalidated = false; if (initiator != null) &#123; considerNotify(initiator); initiator = null; &#125; else &#123; //è¿™é‡Œä¼ äº†null æ‰€ä»¥ï¼Œèµ°ä¸‹é¢çš„è¿™ä¸ªé€»è¾‘ éå†è¿™ä¸ªobservers //è¿™ä¸ªobserverså°±æ˜¯æˆ‘ä»¬ä¹‹å‰addObserveræ·»åŠ è¿›å»çš„ for (Iterator&lt;Map.Entry&lt;Observer&lt;? super T&gt;, ObserverWrapper&gt;&gt; iterator = mObservers.iteratorWithAdditions(); iterator.hasNext(); ) &#123; //éå†ä¹‹åï¼Œå°±ä¼šè°ƒç”¨considerNoityè¿›è¡Œæ•°æ®çš„åˆ†å‘ï¼Œè°ƒç”¨onChanged considerNotify(iterator.next().getValue()); if (mDispatchInvalidated) &#123; break; &#125; &#125; &#125; &#125; while (mDispatchInvalidated); mDispatchingValue = false;&#125; livedata è¿™ä¸ªæ–¹æ³•ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æ´»è·ƒçš„è§‚å¯Ÿè€… 123public boolean hasActiveObservers() &#123; return mActiveCount &gt; 0;&#125; çœ‹ä¸‹livedataçš„å­ç±»ï¼Œå®ç° 123456789101112131415161718192021public class MutableLiveData&lt;T&gt; extends LiveData&lt;T&gt; &#123; public MutableLiveData(T value) &#123; super(value); &#125; public MutableLiveData() &#123; super(); &#125; @Override public void postValue(T value) &#123; super.postValue(value); &#125; @Override public void setValue(T value) &#123; super.setValue(value); &#125;&#125; è¿™ä¸ªç±»å¥½åƒä»€ä¹ˆéƒ½æ²¡åšï¼Œåªæ˜¯å¤å†™äº†postvalueå’Œsetvalueå¹¶æŠŠæ–¹æ³•æ”¹æˆäº†publicè€Œå·²ï¼Œé‚£ä¹ˆåŸå› æ˜¯ä»€ä¹ˆï¼Ÿ å› ä¸ºlivedataä½œä¸ºæ•°æ®å‘é€ç»„ä»¶ï¼Œå¿…å®šæ˜¯ä¸€æ–¹å‘é€ä¸€æ–¹æ¥æ”¶ï¼Œä¸èƒ½æ—¢å‘é€åˆæ¥æ”¶ï¼Œæ‰€ä»¥MutableLiveData æ˜¯ä¸ºäº†è§„é¿è¿™ä¸ªé—®é¢˜æ‰å­˜åœ¨çš„ï¼Œåªæœ‰æ‹¿åˆ°çš„å¯¹è±¡æ˜¯MutableLiveDataå®ƒæ‰èƒ½è¿›è¡Œä¸€ä¸ªæ•°æ®çš„å‘é€","categories":[{"name":"Jetpackç³»åˆ—","slug":"Jetpackç³»åˆ—","permalink":"http://example.com/categories/Jetpack%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://example.com/tags/Android/"},{"name":"Jetpack","slug":"Jetpack","permalink":"http://example.com/tags/Jetpack/"}]},{"title":"Android - åœ¨Fragmentä¸­è§‚å¯ŸLiveDataæ—¶ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨viewLifecycleOwner[è½¬]","slug":"Android - åœ¨Fragmentä¸­è§‚å¯ŸLiveDataæ—¶ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨viewLifecycleOwner","date":"2022-02-16T02:37:54.000Z","updated":"2022-05-12T07:32:47.000Z","comments":true,"path":"2022/02/16/Android - åœ¨Fragmentä¸­è§‚å¯ŸLiveDataæ—¶ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨viewLifecycleOwner/","link":"","permalink":"http://example.com/2022/02/16/Android%20-%20%E5%9C%A8Fragment%E4%B8%AD%E8%A7%82%E5%AF%9FLiveData%E6%97%B6%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8viewLifecycleOwner/","excerpt":"ä½¿ç”¨LiveData åœ¨è°ƒç”¨observeæ—¶ä¼ å…¥thisä¼šæŠ¥æé†’ï¼Œè¦æ±‚ä½¿ç”¨viewLifecycleOwneråŸå› æ˜¯ä»€ä¹ˆï¼Ÿ","text":"ä½¿ç”¨LiveData åœ¨è°ƒç”¨observeæ—¶ä¼ å…¥thisä¼šæŠ¥æé†’ï¼Œè¦æ±‚ä½¿ç”¨viewLifecycleOwneråŸå› æ˜¯ä»€ä¹ˆï¼Ÿ åŸæ–‡é“¾æ¥ Android - åœ¨Fragmentä¸­è§‚å¯ŸLiveDataæ—¶ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨viewLifecycleOwnerå®˜ç½‘å»ºè®®ä½¿ç”¨viewLifecycleOwner åœ¨Fragmentä¸­å¯¹LiveDataå¯¹è±¡è°ƒç”¨Observeæ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚æœä¼ é€’çš„LifecycleOwnerå‚æ•°ä¸ºthisï¼Œä¹Ÿå°±æ˜¯Fragmentçš„æ—¶å€™ï¼Œä¼šå—åˆ°AndroidStudioçš„æé†’ï¼Œè¦æ±‚ä½¿ç”¨viewLifecycleOwnerï¼š fragment.png ä»ç±»å‹ä¸Šæ¥è¯´ï¼ŒFragmentä¸viewLifecycleOwnerçš„ç±»å‹FragmentViewLifecycleä¸¤è€…éƒ½ç»§æ‰¿äº†LifecycleOwnerï¼Œåƒä¹‹å‰é‚£æ ·ç›´æ¥thisï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿è¡Œä¹Ÿæ˜¯æ­£å¸¸çš„ï¼Œé‚£ä¹ˆè¿™é‡Œçš„Lintæé†’æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ é€šè¿‡åœ¨å®˜ç½‘å¯»æ‰¾androidx.fragment:fragmentçš„æ–‡æ¡£ï¼Œå¯ä»¥çœ‹åˆ°1.2.0ç‰ˆæœ¬æ›´æ–°çš„å†…å®¹æœ‰ä¸€æ¡ï¼š 26005601-ff3b75c18a8b2c79.png å¯ä»¥çŸ¥é“ï¼Œè¿™è‚¯å®šæ˜¯æœ‰ä»–çš„é“ç†ã€‚æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æä¸€ä¸‹åŸå› ï¼š 123456789101112131415161718192021222324252627282930313233viewLifecycleOwnerç›¸å…³ç”Ÿå‘½å‘¨æœŸæ‰¾åˆ°viewLifecycleOwnerç›¸å…³ä»£ç ( åªçœ‹å…³é”®ç‚¹ )ï¼š//Fragment.javaä¸­void performCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) &#123;mChildFragmentManager.noteStateNotSaved(); mPerformedCreateView =true; mViewLifecycleOwner =new FragmentViewLifecycleOwner(); //æ­¤å¤„åˆ›å»ºäº†FragmentViewLifecycleOwner mView = onCreateView(inflater, container, savedInstanceState); //åˆ›å»ºå®Œæˆä¹‹åï¼Œè°ƒç”¨äº†onCreateView()æ–¹æ³• ... //çœç•¥æ— å…³ä»£ç &#125;//FragmentManager.javaprivate void destroyFragmentView(@NonNull Fragment fragment) &#123; fragment.performDestroyView(); //æ­¤æ–¹æ³•ä¸­æ‰§è¡Œäº†onDestroyView()æ–¹æ³• fragment.mViewLifecycleOwner =null; //åœ¨æ‰§è¡Œå®ŒonDestroyView()æ–¹æ³•ä¹‹åï¼Œå°†viewLifecycleOwnerç½®ç©º&#125;//Fragment.javavoid performDestroyView() &#123; ... onDestroyView(); // fragment.performDestroyView()æ–¹æ³•è°ƒç”¨ä¸­ï¼Œæ‰§è¡Œäº†onDestroyView()æ–¹æ³• ...&#125;å¯ä»¥å‘ç°mViewLifecycleOwnerçš„èµ‹å€¼åœ¨onCreateView()ä¹‹å‰ï¼Œç½®ç©ºåœ¨onDestroyView()ä¹‹åï¼ŒmViewLifecycleOwnerçš„æ³¨é‡Šä¹Ÿè¯´æ˜äº†è¿™ç‚¹ï¼š // è¿™åœ¨performCreateViewä¸­åˆå§‹åŒ–ï¼Œåœ¨å¤–éƒ¨ä¸å¯ç”¨ // This is initialized in performCreateView and unavailable outside of the // onCreateView/onDestroyViewç”Ÿå‘½å‘¨æœŸ // onCreateView/onDestroyView lifecycle @Nullable FragmentViewLifecycleOwner mViewLifecycleOwner; æ­£å¦‚ç±»åæ‰€ç¤ºï¼Œè¿™ä¸ªFragmentViewLifecycleä»£è¡¨çš„æ˜¯Fragmentä¸­Viewçš„LifecycleOwnerï¼ŒFragmentä¸­Viewçš„ç”Ÿå‘½å‘¨æœŸä¸Fragmentæœ¬èº«å¹¶ä¸ç›¸åŒã€‚ çœ‹åˆ°è¿™é‡Œï¼Œæƒ³å¿…æœ‰äº›åŒå­¦å¯¹Fragmentçš„ç”Ÿå‘½å‘¨æœŸä¹ŸåŠçŸ¥åŠè§£ï¼Œé¡ºä¾¿æ¸©ä¹ ä¸€ä¸‹ï¼š Fragment.png Fragmentå…¥back stackçš„è¿‡ç¨‹ä¼šæ‰§è¡ŒonDestroyViewä½†ä¸æ‰§è¡Œä¹‹åçš„onDestroyä¸onDetachï¼Œè€Œå‡ºback stackæ˜¯ä»onCreateViewå¼€å§‹æ‰§è¡Œï¼Œè€Œæ²¡æœ‰ä¹‹å‰çš„onAttachä¸onCreateã€‚ LiveDataçš„observeè¿‡ç¨‹æ¸©ä¹ äº†ç›¸å…³ç”Ÿå‘½å‘¨æœŸåï¼Œä¸‹é¢æ¥çœ‹ä¸€ä¸‹LiveDataçš„observeè¿‡ç¨‹ã€‚ æˆ‘ä»¬çŸ¥é“åœ¨LiveDataçš„observeæ–¹æ³•å†…ï¼Œä¼šå°†å‚æ•°ownerä¸observeråŒ…è£…èµ·æ¥ï¼Œä½¿å¾—observerçš„å›è°ƒå—ownerçš„ç”Ÿå‘½å‘¨æœŸçš„å½±å“ï¼Œåªæœ‰åœ¨ownerå¤„äºæ´»è·ƒçŠ¶æ€æ‰å›è°ƒobserverï¼Œè€Œæ´»è·ƒçŠ¶æ€æŒ‡çš„æ˜¯å½“å‰ownerçš„ç”Ÿå‘½å‘¨æœŸè‡³å°‘ä¸ºSTARTEDï¼Œå³å¦‚ä¸‹ï¼ˆ1ï¼‰å¤„ï¼Œownerä¸observerçš„åŒ…è£…ç±»ä¸­å¦æ´»è·ƒçš„åˆ¤æ–­æ–¹æ³•ã€‚ 12345678910111213141516171819202122class LifecycleBoundObserver extends ObserverWrapper implements LifecycleEventObserver &#123; @NonNull final LifecycleOwner mOwner; LifecycleBoundObserver(@NonNull LifecycleOwner owner, Observer&lt;? super T&gt; observer) &#123; super(observer); mOwner = owner; &#125; @Override boolean shouldBeActive() &#123; return mOwner.getLifecycle().getCurrentState().isAtLeast(STARTED); &#125;//(1) @Override public void onStateChanged(@NonNull LifecycleOwner source, @NonNull Lifecycle.Event event) &#123; if (mOwner.getLifecycle().getCurrentState() == DESTROYED) &#123; removeObserver(mObserver);//(2) return; &#125; activeStateChanged(shouldBeActive()); &#125; ...&#125; å¯æ˜¯ï¼ŒFragmentä¸Fragmentä¸­çš„Viewåœ¨æ´»è·ƒçš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€æ˜¯ä¸€è‡´çš„ï¼Œè¿™é‡Œçš„ownerä½¿ç”¨fragmentè¿˜æ˜¯viewLifecycleOwnerå¹¶æ— ä¸åŒï¼ŒäºŒè€…åªæœ‰åœ¨onCreateViewåˆ°onDestroyViewä¹‹å¤–æœ‰åŒºåˆ«ã€‚ åŒ…è£…ç±»ä¸­çš„onStateChangedæ–¹æ³•ä¼šæ‰§è¡Œobserverçš„é€‚æ—¶ç§»é™¤å·¥ä½œï¼Œè€Œï¼ˆ2ï¼‰å¤„çš„ç§»é™¤observeræ­£æ˜¯åœ¨ownerå¤„äºDESTROYEDæ—¶å‘ç”Ÿçš„ã€‚å¯¹äºFragmentï¼ŒçŠ¶æ€ä¼šåœ¨onDestroyViewæ‰§è¡Œå‰å¤•ï¼Œå˜ä¸ºDESTROYEDï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345678910//Fragment.java ä¹Ÿå¯¹åº”äº†ä¸Šè¾¹çš„å†…å®¹ void performDestroyView() &#123; mChildFragmentManager.dispatchDestroyView(); if (mView != null) &#123; mViewLifecycleOwner.handleLifecycleEvent(Lifecycle.Event.ON_DESTROY); &#125; mState = CREATED; onDestroyView(); ... &#125; åŸå› æ­¤æ—¶ï¼Œä¸€åˆ‡éƒ½è§£é‡Šå¾—é€šäº†ï¼Œåœ¨Fragmentä¸­å¯¹LiveDataå¯¹è±¡è°ƒç”¨observeæ–¹æ³•æ—¶ï¼Œä½¿ç”¨viewLifecycleOwnerä»£æ›¿thisçš„åŸå› æ˜¯ï¼šFragmentä¸Fragmentä¸­çš„Viewçš„ç”Ÿå‘½å‘¨æœŸå¹¶ä¸ä¸€è‡´ï¼Œéœ€è¦è®©observeræ„ŸçŸ¥Fragmentä¸­çš„Viewçš„ç”Ÿå‘½å‘¨æœŸè€ŒéFragmentï¼Œå› æ­¤Androidä¸“é—¨æ„é€ äº†Fragmentä¸­çš„Viewçš„LifecycleOwnerï¼Œå³viewLifecycleOwnerã€‚","categories":[],"tags":[]},{"title":"okhttpç½‘ç»œæ¡†æ¶åŸç†","slug":"okhttpç½‘ç»œæ¡†æ¶æºç (kotlin)","date":"2022-02-13T00:06:08.000Z","updated":"2022-02-16T06:39:57.000Z","comments":true,"path":"2022/02/13/okhttpç½‘ç»œæ¡†æ¶æºç (kotlin)/","link":"","permalink":"http://example.com/2022/02/13/okhttp%E7%BD%91%E7%BB%9C%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81(kotlin)/","excerpt":"okhttpç½‘ç»œæ¡†æ¶åŸç†","text":"okhttpç½‘ç»œæ¡†æ¶åŸç† okhttp ç½‘ç»œæ¡†æ¶åŸç†12345678910111213141516171819202122232425262728293031323334353637383940414243//æ„é€ å‡½æ•°class Builder constructor() &#123;//ç©ºå‚æ•°æ„é€ å‡½æ•° //æˆå‘˜å˜é‡çš„é»˜è®¤åˆå§‹åŒ– //åˆ†å‘å™¨â€”â€”é‡ç‚¹ ä¸»è¦å¤„ç†å¼‚æ­¥è¯·æ±‚ç½‘ç»œ ç¼“å­˜ç­‰åˆ†å‘æµç¨‹ internal var dispatcher: Dispatcher = Dispatcher() //è¿æ¥æ± ï¼Œæ¯ä¸€ä¸ªè¿æ¥è¿›å…¥è¿æ¥æ± ï¼Œ1.åŒæ ·urlä¼šè¿æ¥å¤ç”¨ 2.å“ªäº›è¿æ¥æ‰“å¼€ å“ªäº›å¤ç”¨ çš„ç­–ç•¥ internal var connectionPool: ConnectionPool = ConnectionPool() internal val interceptors: MutableList&lt;Interceptor&gt; = mutableListOf() internal val networkInterceptors: MutableList&lt;Interceptor&gt; = mutableListOf() internal var eventListenerFactory: EventListener.Factory = EventListener.NONE.asFactory() internal var retryOnConnectionFailure = true internal var authenticator: Authenticator = Authenticator.NONE internal var followRedirects = true internal var followSslRedirects = true internal var cookieJar: CookieJar = CookieJar.NO_COOKIES internal var cache: Cache? = null internal var dns: Dns = Dns.SYSTEM internal var proxy: Proxy? = null internal var proxySelector: ProxySelector? = null internal var proxyAuthenticator: Authenticator = Authenticator.NONE internal var socketFactory: SocketFactory = SocketFactory.getDefault() internal var sslSocketFactoryOrNull: SSLSocketFactory? = null internal var x509TrustManagerOrNull: X509TrustManager? = null internal var connectionSpecs: List&lt;ConnectionSpec&gt; = DEFAULT_CONNECTION_SPECS internal var protocols: List&lt;Protocol&gt; = DEFAULT_PROTOCOLS internal var hostnameVerifier: HostnameVerifier = OkHostnameVerifier internal var certificatePinner: CertificatePinner = CertificatePinner.DEFAULT internal var certificateChainCleaner: CertificateChainCleaner? = null internal var callTimeout = 0 internal var connectTimeout = 10_000 internal var readTimeout = 10_000 internal var writeTimeout = 10_000 internal var pingInterval = 0 //è®¾ç½®æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨apply ä½œç”¨åŸŸå‡½æ•° apply fun readTimeout(duration: Duration) = apply &#123; readTimeout = checkDuration(&quot;timeout&quot;, duration.toMillis(), TimeUnit.MILLISECONDS) &#125; ... &#125; kotlin çŸ¥è¯†ç‚¹è¡¥å…… internal â€”â€” èƒ½è§åˆ°ç±»å£°æ˜çš„ æœ¬æ¨¡å—å†… çš„ä»»ä½•å®¢æˆ·ç«¯éƒ½å¯è§å…¶interanlæˆå‘˜ ä½œç”¨åŸŸå‡½æ•°â€”â€”æ˜¯åœ¨å¯¹è±¡çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œä»£ç å—ã€‚å½“å¯¹ä¸€ä¸ªå¯¹è±¡è°ƒç”¨è¿™æ ·çš„å‡½æ•°å¹¶æä¾›ä¸€ä¸ª lambda è¡¨è¾¾å¼æ—¶ï¼Œå®ƒä¼šå½¢æˆä¸€ä¸ªä¸´æ—¶ä½œç”¨åŸŸã€‚åœ¨æ­¤ä½œç”¨åŸŸä¸­ï¼Œå¯ä»¥è®¿é—®è¯¥å¯¹è±¡è€Œæ— éœ€å…¶åç§°ã€‚å…±æœ‰ä»¥ä¸‹äº”ç§ï¼šletã€runã€withã€apply ä»¥åŠ alsoã€‚ æ¯ä¸ªä½œç”¨åŸŸå‡½æ•°ä¹‹é—´æœ‰ä¸¤ä¸ªä¸»è¦åŒºåˆ«ï¼š å¼•ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡çš„æ–¹å¼ this å’Œ it è¿”å›å€¼ apply è¿™é‡Œ ä½¿ç”¨this ä½†å¯ä»¥çœç•¥ å¦å¤–ä½¿ç”¨itçš„æ˜¯letå’Œalso apply å’Œalso è¿”å›ä¸Šä¸‹æ–‡å¯¹è±¡æœ¬èº«ã€‚å› æ­¤ï¼Œå®ƒä»¬å¯ä»¥ä½œä¸ºè¾…åŠ©æ­¥éª¤åŒ…å«åœ¨è°ƒç”¨é“¾ä¸­ï¼šä½ å¯ä»¥ç»§ç»­åœ¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šè¿›è¡Œé“¾å¼å‡½æ•°è°ƒç”¨ã€‚æœ‰è¿”å›å€¼ï¼Œè¿”å›çš„å°±æ˜¯å¯¹è±¡æœ¬èº«ã€‚ letã€runå’Œwithè¿”å›lambdaè¡¨è¾¾å¼çš„ç»“æœã€‚æ‰€ä»¥å¯ä»¥ç»™ä¸€ä¸ªå˜é‡èµ‹å€¼ã€‚ val numbers &#x3D; mutableListOf(â€œoneâ€, â€œtwoâ€, â€œthreeâ€)val countEndsWithE &#x3D; numbers.run { add(â€œfourâ€) add(â€œfiveâ€) count { it.endsWith(â€œeâ€) }&#x2F;&#x2F;è¿”å›çš„çš„æ­¤è¡¨è¾¾å¼çš„ç»“æœï¼Œæ‰€ä»¥æ˜¯countæ˜¯Int}println(â€œThere are $countEndsWithE elements that end with e.â€) æ­¤å¤–ï¼Œè¿˜å¯ä»¥å¿½ç•¥è¿”å›å€¼ï¼Œä»…ä½¿ç”¨ä½œç”¨åŸŸå‡½æ•°ä¸ºå˜é‡åˆ›å»ºä¸€ä¸ªä¸´æ—¶ä½œç”¨åŸŸã€‚ val numbers &#x3D; mutableListOf(â€œoneâ€, â€œtwoâ€, â€œthreeâ€)with(numbers) { val firstItem &#x3D; first() val lastItem &#x3D; last() println(â€œFirst item: $firstItem, last item: $lastItemâ€)} ä¸è¿”å›ä¸œè¥¿ï¼Œè€Œæ˜¯é™åˆ¶åœ¨withä½œç”¨åŸŸå†…æ“ä½œçš„æ˜¯numberså¯¹è±¡ï¼Œçœç•¥äº†this okhttpçš„è°ƒç”¨æµç¨‹å›¾ æ ¸å¿ƒæ˜¯getResponseWithInterceptorChainæ–¹æ³•ï¼Œæ‹¦æˆªå™¨é“¾çš„å®ç°ï¼Œä¸»è¦è¯·æ±‚ä¹Ÿæ˜¯åœ¨è¿™é‡Œå®Œæˆçš„ åŒæ­¥æ˜¯excute å¼‚æ­¥ equeue BuIldè®¾è®¡æ¨¡å¼ è¦æ„é€ çš„å¯¹è±¡å‚æ•°å¾ˆå¤šï¼Œå¯ä»¥å‚è€ƒokttpçš„buildæ¨¡å¼ï¼Œå¯ä»¥å¤§å¤§ç®€åŒ–ï¼Œæ„å»ºçš„æ­¥éª¤å’Œä¼ å‚ï¼Œæ–¹ä¾¿ä½¿ç”¨é“¾å¼æ“ä½œæ¥è®¾ç½®å•ç‹¬çš„å±æ€§ã€‚","categories":[],"tags":[]},{"title":"Jetpackç³»åˆ—â€”åº•éƒ¨å¯¼èˆªè·¯ç”±BottomNavigationViewåŸç†","slug":"Jetpackç³»åˆ—â€”åº•éƒ¨å¯¼èˆªè·¯ç”±åŸç†","date":"2022-02-09T02:49:29.000Z","updated":"2022-02-17T19:45:50.000Z","comments":true,"path":"2022/02/09/Jetpackç³»åˆ—â€”åº•éƒ¨å¯¼èˆªè·¯ç”±åŸç†/","link":"","permalink":"http://example.com/2022/02/09/Jetpack%E7%B3%BB%E5%88%97%E2%80%94%E5%BA%95%E9%83%A8%E5%AF%BC%E8%88%AA%E8%B7%AF%E7%94%B1%E5%8E%9F%E7%90%86/","excerpt":"ä¸»è¦ä»‹ç»BottomNavigationViewåŠå…¶å®ç°åŸç†","text":"ä¸»è¦ä»‹ç»BottomNavigationViewåŠå…¶å®ç°åŸç† bottom_nav_menu.xml é…ç½®åº•éƒ¨itemçš„æ˜¾ç¤ºå†…å®¹å’Œä¸ªæ•° 1234567891011&lt;fragment android:id=&quot;@+id/nav_host_fragment_activity_main&quot; android:name=&quot;androidx.navigation.fragment.NavHostFragment&quot; android:layout_width=&quot;match_parent&quot; android:layout_height=&quot;match_parent&quot; app:defaultNavHost=&quot;true&quot; app:layout_constraintBottom_toTopOf=&quot;@id/nav_view&quot; app:layout_constraintLeft_toLeftOf=&quot;parent&quot; app:layout_constraintRight_toRightOf=&quot;parent&quot; app:layout_constraintTop_toTopOf=&quot;parent&quot; app:navGraph=&quot;@navigation/mobile_navigation&quot; /&gt; 1app:defaultNavHost=&quot;true&quot; æ˜¯å¦å’Œç³»ç»Ÿçš„è¿”å›é”®ç›¸å…³è” å¦‚æœç›¸å…³è”ï¼Œå¦‚æœå›é€€æ ˆä¸­æœ‰fragment é‚£ä¹ˆå°±ä¼šæ‹¦æˆªè¿”å›é”® å¦‚æœæ²¡æœ‰çš„è¯å°±æ‰§è¡Œè¿”å›é”®çš„é»˜è®¤è¡Œä¸º 1app:navGraph=&quot;@navigation/mobile_navigation&quot; åº•éƒ¨è·¯ç”±ç»“æ„ 1234567891011121314151617181920212223242526&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot; xmlns:tools=&quot;http://schemas.android.com/tools&quot; android:id=&quot;@+id/mobile_navigation&quot; app:startDestination=&quot;@+id/navigation_home&quot;&gt; &lt;--èŠ‚ç‚¹æ‰€é…ç½®çš„fragment --&gt; &lt;fragment android:id=&quot;@+id/navigation_home&quot; android:name=&quot;com.steve.ppjoke_android.ui.home.HomeFragment&quot; android:label=&quot;@string/title_home&quot; tools:layout=&quot;@layout/fragment_home&quot; /&gt; &lt;fragment android:id=&quot;@+id/navigation_dashboard&quot; android:name=&quot;com.steve.ppjoke_android.ui.dashboard.DashboardFragment&quot; android:label=&quot;@string/title_dashboard&quot; tools:layout=&quot;@layout/fragment_dashboard&quot; /&gt; &lt;fragment android:id=&quot;@+id/navigation_notifications&quot; android:name=&quot;com.steve.ppjoke_android.ui.notifications.NotificationsFragment&quot; android:label=&quot;@string/title_notifications&quot; tools:layout=&quot;@layout/fragment_notifications&quot; /&gt;&lt;/navigation&gt; 1app:startDestination=&quot;@+id/navigation_home&quot; é»˜è®¤è¦æ˜¾ç¤ºçš„é¡µé¢æ˜¯å“ªä¸€ä¸ª é€šè¿‡å¯è§†åŒ–ç•Œé¢é…ç½®fragment 123456789101112131415161718&lt;fragment android:id=&quot;@+id/navigation_home&quot; android:name=&quot;com.steve.ppjoke_android.ui.home.HomeFragment&quot; android:label=&quot;@string/title_home&quot; tools:layout=&quot;@layout/fragment_home&quot;&gt; &lt;!-- å½“å‰fragmentè·³è½¬åˆ°ä¸‹ä¸€é¡µçš„åŠ¨ä½œï¼Œæ‰€ä»¥å¿…é¡»æŒ‡å®šç›®æ ‡é¡µ--&gt; &lt;action android:id=&quot;@+id/id_action&quot; app:destination=&quot;@id/navigation_dashboard&quot; /&gt; &lt;!--æŒ‡çš„æ˜¯åˆ›å»ºå½“å‰fragmentæ—¶éœ€è¦ä¼ é€’çš„å‚æ•° --&gt; &lt;argument android:name=&quot;arg1&quot; app:argType=&quot;integer&quot; /&gt; &lt;!--é€šè¿‡urlæ‹‰èµ·é¡µé¢ï¼Œéšå¼æ„å›¾ å°±æ˜¯é¡µé¢è·¯ç”± --&gt; &lt;deepLink android:id=&quot;@+id/deepLink&quot; app:uri=&quot;www.imooc.com&quot; /&gt;&lt;/fragment&gt; å…ˆçœ‹æ‰¿è½½çš„Fragmentçš„å®ç°é€»è¾‘ NavHostFragment.java 123456789101112131415161718192021222324252627282930313233343536373839404142public void onCreate(@Nullable Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); final Context context = requireContext(); //åˆ‡æ¢fragmentçš„èƒ½åŠ›å§”æ‰˜ç»™NavHostController mNavController = new NavHostController(context); ... //æ·»åŠ äº†ä¸¤ä¸ªå¯¼èˆªå™¨ onCreateNavController(mNavController); Bundle navState = null; if (savedInstanceState != null) &#123; navState = savedInstanceState.getBundle(KEY_NAV_CONTROLLER_STATE); if (savedInstanceState.getBoolean(KEY_DEFAULT_NAV_HOST, false)) &#123; mDefaultNavHost = true; getParentFragmentManager().beginTransaction() .setPrimaryNavigationFragment(this) .commit(); &#125; mGraphId = savedInstanceState.getInt(KEY_GRAPH_ID); &#125; if (navState != null) &#123; // Navigation controller state overrides arguments mNavController.restoreState(navState); &#125; if (mGraphId != 0) &#123; // Set from onInflate() mNavController.setGraph(mGraphId); &#125; else &#123; // See if it was set by NavHostFragment.create() final Bundle args = getArguments(); final int graphId = args != null ? args.getInt(KEY_GRAPH_ID) : 0; final Bundle startDestinationArgs = args != null ? args.getBundle(KEY_START_DESTINATION_ARGS) : null; if (graphId != 0) &#123; mNavController.setGraph(graphId, startDestinationArgs); &#125; &#125;&#125; onCreateNavController 1234567protected void onCreateNavController(@NonNull NavController navController) &#123; navController.getNavigatorProvider().addNavigator( //ç¬¬ä¸€ä¸ªï¼Œç»™dialogframgentæä¾›è·³è½¬ï¼Œåˆ‡æ¢çš„èƒ½åŠ› new DialogFragmentNavigator(requireContext(), getChildFragmentManager())); //ç¬¬äºŒä¸ªï¼Œæ˜¯ç»™fragmentæä¾›è·³è½¬ navController.getNavigatorProvider().addNavigator(createFragmentNavigator());&#125; é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜åœ¨NavControllerçš„æ„é€ å‡½æ•°é‡Œæ·»åŠ äº†ä¸¤ä¸ªé»˜è®¤çš„navigator 1234567891011121314public NavController(@NonNull Context context) &#123; mContext = context; while (context instanceof ContextWrapper) &#123; if (context instanceof Activity) &#123; mActivity = (Activity) context; break; &#125; context = ((ContextWrapper) context).getBaseContext(); &#125; //è¿™ä¸ªå¯¼èˆªå™¨çš„ä½œç”¨æ˜¯é…ç½®çš„é»˜è®¤å¯åŠ¨çš„é¡µé¢ï¼Œå¯åŠ¨åä¼šè·³è½¬ï¼Œå”¯ä¸€è¢«ç”¨åˆ°çš„åœ°æ–¹ mNavigatorProvider.addNavigator(new NavGraphNavigator(mNavigatorProvider)); //ä¸ºactivityè·³è½¬æä¾›æ”¯æŒ mNavigatorProvider.addNavigator(new ActivityNavigator(mContext));&#125; ä¸ºä»€ä¹ˆæŠŠnavigatoræ·»åŠ åˆ°provideré‡Œå‘¢ï¼Ÿ privoderæœ¬è´¨æ˜¯ä¸€ä¸ªhashmapï¼Œå­˜å‚¨å¯¼èˆªå™¨çš„å®ä¾‹ è¿™4ä¸ªå¯¼èˆªå™¨æœ‰ä»€ä¹ˆç›¸åŒç‚¹æœ‰ä»€ä¹ˆä¸åŒç‚¹ï¼Ÿ éƒ½ç»§æ‰¿è‡ªNavigator 12345678910111213141516171819202122232425262728//æ³›å‹å¿…é¡»ç»§æ‰¿NavDestination è€ŒNavDestinationå°±æ˜¯dialog activity fragment ä¹‹æ‰€ä»¥è¿™ä¹ˆè®¾è®¡æ³›å‹ï¼Œæ˜¯éœ€è¦activityçš„navigatoråªèƒ½åˆ›å»ºactivityçš„navigator è€Œfragmentåªèƒ½åˆ›å»ºfragmentçš„å¯¼èˆªå™¨public abstract class Navigator&lt;D extends NavDestination&gt; &#123; //1.æ¯ä¸€ä¸ªnavigatorçš„å­ç±»éƒ½å¿…é¡»æ ‡æ³¨ä¸€ä¸ªNameçš„æ³¨è§£ï¼Œåªæœ‰è¿™æ ·ï¼Œæ‰ä¼šæŠŠå®ƒæ·»åŠ åˆ°provideré‡Œï¼Œæˆ‘ä»¬ä¹‹å‰è¯´provideræ˜¯ä¸€ä¸ªhashmap å®ƒçš„keyå°±æ˜¯æˆ‘ä»¬æ ‡æ³¨çš„nameçš„åå­—ï¼Œvalueæ˜¯navigatorçš„å®ä¾‹æœ¬èº« //2.navigatoråœ¨åˆ›å»ºdestinationçš„æ—¶å€™,å®ƒä¼šè§£ænavigatorä¸Šçš„nameï¼Œä»¥æ­¤æ¥å¾—åˆ°å¯¼èˆªå™¨çš„åç§° public @interface Name &#123; String value(); &#125; ... //åˆ›å»ºDestination çœ‹ä¸‹é¢Destinationçš„æ„é€  public abstract D createDestination(); //è·³è½¬é€»è¾‘ public abstract NavDestination navigate(@NonNull D destination, @Nullable Bundle args,@Nullable NavOptions navOptions, @Nullable Extras navigatorExtras); //æ˜¯å¦æ‹¦æˆªç³»ç»Ÿçš„è¿”å›é”®ï¼Œå®ç°å›é€€æ ˆçš„æ“ä½œ public abstract boolean popBackStack(); //ç©ºæ¥å£ï¼Œå®ç°ç”¨æ¥åšé¢å¤–çš„äº‹æƒ…ï¼Œæ¯”å¦‚è¿‡æ¸¡å…ƒç´ ï¼Œè½¬åœºåŠ¨ç”» public interface Extras &#123; &#125;&#125; 123456789//ä¼ å…¥ä¸€ä¸ªnavigatorpublic NavDestination(@NonNull Navigator&lt;? extends NavDestination&gt; navigator) &#123; this(NavigatorProvider.getNameForNavigator(navigator.getClass()));&#125;//ä¼ å…¥ä¸€ä¸ªnavigatorName è¿™ä¸ªnameå°±æ˜¯é€šè¿‡æ ‡æ³¨åœ¨navigatorä¸Šé¢çš„nameçš„æ³¨è§£å¾—åˆ°çš„public NavDestination(@NonNull String navigatorName) &#123; mNavigatorName = navigatorName;&#125; é‚£ä¹ˆä¸ºä»€ä¹ˆè¦ä¼ å…¥navigatorNameå‘¢ï¼Ÿ NavDestinationå°±æ˜¯æˆ‘ä»¬è·³è½¬çš„ä¸€ä¸ªä¸ªé¡µé¢ï¼Œæˆ‘ä»¬é€šè¿‡ä¼ å…¥çš„navigatorNameåœ¨providerè¿™ä¸ªhashmapä¸­å¾—åˆ°destinationå®ä¾‹ï¼Œå°±æ˜¯è¿™ä¹ˆå¾—åˆ°æˆ‘ä»¬çš„è·³è½¬çš„å®ä¾‹çš„ æˆ‘ä»¬æ¥ç€çœ‹Navigatorä¸­çš„navigateæ–¹æ³• 12//è·³è½¬é€»è¾‘public abstract NavDestination navigate(@NonNull D destination, @Nullable Bundle args,@Nullable NavOptions navOptions, @Nullable Extras navigatorExtras); ç”±äºactivity fragment dialogçš„å…·ä½“è·³è½¬æ–¹æ³•éƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ï¼Œä¸ä¼šäº¤ç”±çˆ¶ç±»æ¥å®ç°ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯æŠ½è±¡çš„ï¼Œä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³• Navigatorçˆ¶ç±»äº†è§£åï¼Œæˆ‘ä»¬æ¥äº†äº†è§£å…¶å­ç±»çš„å®ç° ActivityNavigator 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119//providerä¸­çš„keyçš„åå­—å°±æ˜¯activity@Navigator.Name(&quot;activity&quot;)public class ActivityNavigator extends Navigator&lt;ActivityNavigator.Destination&gt; &#123; public final Destination setIntent(@Nullable Intent intent) &#123; mIntent = intent; return this &#125; ... public final Destination setTargetPackage(@Nullable String packageName) &#123; if (mIntent == null) &#123; mIntent = new Intent(); &#125; mIntent.setPackage(packageName); return this; &#125; public Destination setData()&#123; ... &#125; public Destination setComponentName()&#123; ... &#125; //ä¸Šé¢è¿™äº›ç±»éƒ½æ˜¯ä¸ºäº†æ„é€ æˆ–ä¼ å…¥Intentå¯¹è±¡ ... //æ ¸å¿ƒæ–¹æ³•navigate public NavDestination navigate(@NonNull Destination destination, @Nullable Bundle args, @Nullable NavOptions navOptions, @Nullable Navigator.Extras navigatorExtras) &#123; //1.è·å–è·³è½¬Intent if (destination.getIntent() == null) &#123; throw new IllegalStateException(&quot;Destination &quot; + destination.getId() + &quot; does not have an Intent set.&quot;); &#125; Intent intent = new Intent(destination.getIntent()); if (args != null) &#123; intent.putExtras(args); String dataPattern = destination.getDataPattern(); if (!TextUtils.isEmpty(dataPattern)) &#123; // Fill in the data pattern with the args to build a valid URI StringBuffer data = new StringBuffer(); Pattern fillInPattern = Pattern.compile(&quot;\\\\&#123;(.+?)\\\\&#125;&quot;); Matcher matcher = fillInPattern.matcher(dataPattern); while (matcher.find()) &#123; String argName = matcher.group(1); if (args.containsKey(argName)) &#123; matcher.appendReplacement(data, &quot;&quot;); //noinspection ConstantConditions data.append(Uri.encode(args.get(argName).toString())); &#125; else &#123; throw new IllegalArgumentException(&quot;Could not find &quot; + argName + &quot; in &quot; + args + &quot; to fill data pattern &quot; + dataPattern); &#125; &#125; matcher.appendTail(data); intent.setData(Uri.parse(data.toString())); &#125; &#125; // extra è·å–é¢å¤–çš„flag if (navigatorExtras instanceof Extras) &#123; Extras extras = (Extras) navigatorExtras; intent.addFlags(extras.getFlags()); &#125; //è®¾ç½®intentçš„è·³è½¬çš„flag if (!(mContext instanceof Activity)) &#123; // If we&#x27;re not launching from an Activity context we have to launch in a new task. intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); &#125; if (navOptions != null &amp;&amp; navOptions.shouldLaunchSingleTop()) &#123; intent.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP); &#125; //è®¾ç½®è·³è½¬çš„å½“å‰é¡µé¢çš„hostid ç”¨æ¥åšé¡µé¢æº¯æº if (mHostActivity != null) &#123; final Intent hostIntent = mHostActivity.getIntent(); if (hostIntent != null) &#123; final int hostCurrentId = hostIntent.getIntExtra(EXTRA_NAV_CURRENT, 0); if (hostCurrentId != 0) &#123; intent.putExtra(EXTRA_NAV_SOURCE, hostCurrentId); &#125; &#125; &#125; final int destId = destination.getId(); intent.putExtra(EXTRA_NAV_CURRENT, destId); //è®¾ç½®è·³è½¬çš„åŠ¨ç”» if (navOptions != null) &#123; // For use in applyPopAnimationsToPendingTransition() intent.putExtra(EXTRA_POP_ENTER_ANIM, navOptions.getPopEnterAnim()); intent.putExtra(EXTRA_POP_EXIT_ANIM, navOptions.getPopExitAnim()); &#125; //ä½¿ç”¨context.startActivityæ¥è¿›è¡ŒçœŸæ­£çš„è·³è½¬ if (navigatorExtras instanceof Extras) &#123; Extras extras = (Extras) navigatorExtras; ActivityOptionsCompat activityOptions = extras.getActivityOptions(); if (activityOptions != null) &#123; ActivityCompat.startActivity(mContext, intent, activityOptions.toBundle()); &#125; else &#123; mContext.startActivity(intent); &#125; &#125; else &#123; mContext.startActivity(intent); &#125; if (navOptions != null &amp;&amp; mHostActivity != null) &#123; int enterAnim = navOptions.getEnterAnim(); int exitAnim = navOptions.getExitAnim(); if (enterAnim != -1 || exitAnim != -1) &#123; enterAnim = enterAnim != -1 ? enterAnim : 0; exitAnim = exitAnim != -1 ? exitAnim : 0; mHostActivity.overridePendingTransition(enterAnim, exitAnim); &#125; &#125; return null; &#125; &#125; æ¥ä¸‹æ¥DialogFragment 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051@Navigator.Name(&quot;dialog&quot;)public final class DialogFragmentNavigator extends Navigator&lt;DialogFragmentNavigator.Destination&gt; &#123; //åŒæ ·çš„åˆ›å»ºï¼Œä¼ å…¥navigatoré€šè¿‡navigatoræ¥å–å‡ºå®ƒçš„åå­— public Destination createDestination() &#123; return new Destination(this); &#125; //è®¾ç½®className public final Destination setClassName(@NonNull String className) &#123; mClassName = className; return this; &#125; //æ ¸å¿ƒè·³è½¬navigate public NavDestination navigate(@NonNull final Destination destination, @Nullable Bundle args, @Nullable NavOptions navOptions, @Nullable Navigator.Extras navigatorExtras) &#123; if (mFragmentManager.isStateSaved()) &#123; Log.i(TAG, &quot;Ignoring navigate() call: FragmentManager has already&quot; + &quot; saved its state&quot;); return null; &#125; String className = destination.getClassName(); //1.è·å–classname å…¨ç±»å if (className.charAt(0) == &#x27;.&#x27;) &#123; className = mContext.getPackageName() + className; &#125; //2.é€šè¿‡classname åå°„æ„é€ ä¸€ä¸ªfragmentçš„å¯¹è±¡ instantiateè¿™ä¸ªæ–¹æ³• final Fragment frag = mFragmentManager.getFragmentFactory().instantiate( mContext.getClassLoader(), className); //3.å¦‚æœä¸æ˜¯dialogfragmentçš„å­ç±»ï¼Œå°±æŠ›å¼‚å¸¸ if (!DialogFragment.class.isAssignableFrom(frag.getClass())) &#123; throw new IllegalArgumentException(&quot;Dialog destination &quot; + destination.getClassName() + &quot; is not an instance of DialogFragment&quot;); &#125; //4.å¼ºè½¬æˆDialogFragment final DialogFragment dialogFragment = (DialogFragment) frag; dialogFragment.setArguments(args); dialogFragment.getLifecycle().addObserver(mObserver); //5.é€šè¿‡showæ–¹æ³•å°±æŠŠdialogfragmentå±•ç¤ºå‡ºæ¥ dialogFragment.show(mFragmentManager, DIALOG_TAG + mDialogCount++); return destination; &#125;&#125; å†æ¥çœ‹FragmentNavigator 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697@Navigator.Name(&quot;fragment&quot;)public class FragmentNavigator extends Navigator&lt;FragmentNavigator.Destination&gt; &#123; public Destination createDestination() &#123; return new Destination(this); &#125; @NavDestination.ClassType(Fragment.class) public static class Destination extends NavDestination &#123; //åŒä¸Šï¼Œè®¾ç½®å…¨ç±»å public final Destination setClassName(@NonNull String className) &#123; mClassName = className; return this; &#125; &#125; public NavDestination navigate(@NonNull Destination destination, @Nullable Bundle args, @Nullable NavOptions navOptions, @Nullable Navigator.Extras navigatorExtras) &#123; if (mFragmentManager.isStateSaved()) &#123; Log.i(TAG, &quot;Ignoring navigate() call: FragmentManager has already&quot; + &quot; saved its state&quot;); return null; &#125; //1.é€šè¿‡destinationè·å–classname å…¨ç±»å String className = destination.getClassName(); if (className.charAt(0) == &#x27;.&#x27;) &#123; className = mContext.getPackageName() + className; &#125; //2.å®ä¾‹åŒ–ä¸€ä¸ªfragmentå¯¹è±¡ï¼Œå¹¶è®¾ç½®arguments final Fragment frag = instantiateFragment(mContext, mFragmentManager, className, args); frag.setArguments(args); //3.å¾—åˆ°Transactionå¯¹è±¡ final FragmentTransaction ft = mFragmentManager.beginTransaction(); //è·³è½¬åŠ¨ç”» int enterAnim = navOptions != null ? navOptions.getEnterAnim() : -1; int exitAnim = navOptions != null ? navOptions.getExitAnim() : -1; int popEnterAnim = navOptions != null ? navOptions.getPopEnterAnim() : -1; int popExitAnim = navOptions != null ? navOptions.getPopExitAnim() : -1; if (enterAnim != -1 || exitAnim != -1 || popEnterAnim != -1 || popExitAnim != -1) &#123; enterAnim = enterAnim != -1 ? enterAnim : 0; exitAnim = exitAnim != -1 ? exitAnim : 0; popEnterAnim = popEnterAnim != -1 ? popEnterAnim : 0; popExitAnim = popExitAnim != -1 ? popExitAnim : 0; ft.setCustomAnimations(enterAnim, exitAnim, popEnterAnim, popExitAnim); &#125; //4.é€šè¿‡replaceè·³è½¬ï¼Œè¿™ç§æ–¹å¼ä¸å¥½ï¼Œä¼šå‘Šè¯‰é¡µé¢ç”Ÿå‘½å‘¨æœŸé‡å¯ï¼Œéœ€è¦è‡ªå·±å†æ„å»ºä¸€ä¸ªä½¿ç”¨hideå’Œshowçš„FragmentNavigator ft.replace(mContainerId, frag); ft.setPrimaryNavigationFragment(frag); final @IdRes int destId = destination.getId(); final boolean initialNavigation = mBackStack.isEmpty(); // TODO Build first class singleTop behavior for fragments final boolean isSingleTopReplacement = navOptions != null &amp;&amp; !initialNavigation &amp;&amp; navOptions.shouldLaunchSingleTop() &amp;&amp; mBackStack.peekLast() == destId; boolean isAdded; if (initialNavigation) &#123; isAdded = true; &#125; else if (isSingleTopReplacement) &#123; // Single Top means we only want one instance on the back stack if (mBackStack.size() &gt; 1) &#123; // If the Fragment to be replaced is on the FragmentManager&#x27;s // back stack, a simple replace() isn&#x27;t enough so we // remove it from the back stack and put our replacement // on the back stack in its place mFragmentManager.popBackStack( generateBackStackName(mBackStack.size(), mBackStack.peekLast()), FragmentManager.POP_BACK_STACK_INCLUSIVE); ft.addToBackStack(generateBackStackName(mBackStack.size(), destId)); &#125; isAdded = false; &#125; else &#123; ft.addToBackStack(generateBackStackName(mBackStack.size() + 1, destId)); isAdded = true; &#125; if (navigatorExtras instanceof Extras) &#123; Extras extras = (Extras) navigatorExtras; for (Map.Entry&lt;View, String&gt; sharedElement : extras.getSharedElements().entrySet()) &#123; ft.addSharedElement(sharedElement.getKey(), sharedElement.getValue()); &#125; &#125; ft.setReorderingAllowed(true); ft.commit(); // The commit succeeded, update our view of the world if (isAdded) &#123; mBackStack.add(destId); return destination; &#125; else &#123; return null; &#125; &#125;&#125; æœ€åæ¥çœ‹NavGraphNavigator 1234567891011@Navigator.Name(&quot;navigation&quot;)public class NavGraphNavigator extends Navigator&lt;NavGraph&gt; &#123; //è¿™é‡Œæ²¡æœ‰new Destinationå¯¹è±¡ï¼Œè€Œæ˜¯newäº†ä¸€ä¸ªNavGraph,ä¼ å…¥Navigator public NavGraph createDestination() &#123; return new NavGraph(this); &#125; &#125; NavGraph.java æ˜¯NavDestinationçš„å­ç±»ï¼Œæ˜¯ç‰¹æ®Šçš„å­ç±» 123456789public class NavGraph extends NavDestination implements Iterable&lt;NavDestination&gt; &#123; //nodeæ•°ç»„ï¼Œè¿™é‡Œå°±æ˜¯å­˜å‚¨äº†ä¸€ä¸ªä¸ªè·³è½¬èŠ‚ç‚¹çš„çš„å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨ mobile_navigation.xmlä¸­å£°æ˜çš„ä¸€ä¸ªä¸ªfragment activityå®ä¾‹ï¼Œéƒ½ä¼šè¢«å­˜å‚¨åˆ°mNodesä¸­ final SparseArrayCompat&lt;NavDestination&gt; mNodes = new SparseArrayCompat&lt;&gt;(); //è¿™ä¸ªå°±æ˜¯å¯¹åº”mobile_navigation.xmlä¸­æŒ‡å®šçš„app:startDestination=&quot;@+id/navigation_dashboard&quot; è€Œä¸€æ—¦xmlè¢«è§£æï¼Œè¿™é‡Œå°±è·å–åˆ°æˆ‘ä»¬æŒ‡å®šçš„é¡µé¢id private int mStartDestId;&#125; é‚£ä¹ˆåˆæ˜¯åœ¨å“ªé‡Œè§£æçš„ï¼Œä»€ä¹ˆæ—¶å€™è§£æçš„å‘¢ï¼Ÿ è¿˜è®°å¾—æˆ‘ä»¬ä¸Šé¢çš„å®¿ä¸»fragment NavHostFragment æˆ‘ä»¬åœ¨oncreateä¸­åˆ›å»ºäº†NavHostController æˆ‘ä»¬çœ‹ä¸‹Controllerä¸­çš„é€»è¾‘ 123456789101112public class NavController &#123; public void setGraph(@NavigationRes int graphResId) &#123; setGraph(graphResId, null); &#125; public void setGraph(@NavigationRes int graphResId, @Nullable Bundle startDestinationArgs) &#123; //è°ƒç”¨navinflaterçš„inflateæ–¹æ³•æ¥è§£æxmlæ–‡ä»¶ setGraph(getNavInflater().inflate(graphResId), startDestinationArgs); &#125;&#125; è¿™ä¸ªinflateæ–¹æ³• 12345678910111213141516171819202122232425262728293031323334public NavGraph inflate(@NavigationRes int graphResId) &#123; Resources res = mContext.getResources(); //1.è·å–xml parseræ¥è§£æxmlæ–‡ä»¶ XmlResourceParser parser = res.getXml(graphResId); //2.è·å–å±æ€§ final AttributeSet attrs = Xml.asAttributeSet(parser); try &#123; int type; while ((type = parser.next()) != XmlPullParser.START_TAG &amp;&amp; type != XmlPullParser.END_DOCUMENT) &#123; // Empty loop &#125; if (type != XmlPullParser.START_TAG) &#123; throw new XmlPullParserException(&quot;No start tag found&quot;); &#125; String rootElement = parser.getName(); //3.å®é™…ä¸Šæ˜¯å¦ä¸€ä¸ªinflateæ–¹æ³•æ¥è§£ææ„é€ å‡ºçš„å…·ä½“çš„NavDestionå¯¹è±¡ è¿™é‡Œä¸»è¦é€šè¿‡parserè·å–æ ‡ç­¾åï¼Œå†é€šè¿‡name åœ¨providerä¸­æ‹¿åˆ°navigator å†é€šè¿‡navigatoræ¥åˆ›å»ºå„è‡ªçš„navigation NavDestination destination = inflate(res, parser, attrs, graphResId); if (!(destination instanceof NavGraph)) &#123; throw new IllegalArgumentException(&quot;Root element &lt;&quot; + rootElement + &quot;&gt;&quot; + &quot; did not inflate into a NavGraph&quot;); &#125; return (NavGraph) destination; &#125; catch (Exception e) &#123; //ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨ç¼–å†™mobile_navigation.xmlä¸­çš„æ ¹èŠ‚ç‚¹å¿…é¡»æ˜¯navigation å¦åˆ™è§£æåä¼šæŠ›å‡ºå¼‚å¸¸ throw new RuntimeException(&quot;Exception inflating &quot; + res.getResourceName(graphResId) + &quot; line &quot; + parser.getLineNumber(), e); &#125; finally &#123; parser.close(); &#125;&#125; é€šè¿‡navigatoræ¥åˆ›å»ºå…·ä½“çš„è·³è½¬navigationå®ä¾‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051private NavDestination inflate(@NonNull Resources res, @NonNull XmlResourceParser parser, @NonNull AttributeSet attrs, int graphResId) throws XmlPullParserException, IOException &#123; //1.é€šè¿‡providerè·å–å…·ä½“çš„navigatorå¯¹è±¡ parser.getName å¾—åˆ°çš„å°±æ˜¯æ ‡ç­¾çš„åfragment dialog activity Navigator&lt;?&gt; navigator = mNavigatorProvider.getNavigator(parser.getName()); //2.å¾—åˆ°navigatoråï¼Œå°±é€šè¿‡è°ƒç”¨ createDestinationæ–¹æ³•æ¥å¾—åˆ°åˆ›å»ºNavDestination æœ€åä¹Ÿæ˜¯è¿”å›çš„æ˜¯è¿™ä¸ªdest final NavDestination dest = navigator.createDestination(); dest.onInflate(mContext, attrs); final int innerDepth = parser.getDepth() + 1; int type; int depth; while ((type = parser.next()) != XmlPullParser.END_DOCUMENT &amp;&amp; ((depth = parser.getDepth()) &gt;= innerDepth || type != XmlPullParser.END_TAG)) &#123; if (type != XmlPullParser.START_TAG) &#123; continue; &#125; if (depth &gt; innerDepth) &#123; continue; &#125; final String name = parser.getName(); //3.ä¸­é—´è§£æå„ä¸ªå­æ ‡ç­¾ //å¦‚æŸ¥æ˜¯argumentæ ‡ç­¾ï¼Œå°±æŠŠargumentæ•°æ®inflateåˆ°destinationä¸­ if (TAG_ARGUMENT.equals(name)) &#123; inflateArgumentForDestination(res, dest, attrs, graphResId); &#125; else if (TAG_DEEP_LINK.equals(name)) &#123; //å¦‚æœæ˜¯deeplink å°±æŠŠä¿¡æ¯inflateåˆ°destination inflateDeepLink(res, dest, attrs); &#125; else if (TAG_ACTION.equals(name)) &#123; //å¦‚æœæ˜¯actionå°±æŠŠä¿¡æ¯infalteåˆ°destinatioinä¸­çš„actioinä¸­ inflateAction(res, dest, attrs, parser, graphResId); &#125; else if (TAG_INCLUDE.equals(name) &amp;&amp; dest instanceof NavGraph) &#123; final TypedArray a = res.obtainAttributes( attrs, androidx.navigation.R.styleable.NavInclude); final int id = a.getResourceId( androidx.navigation.R.styleable.NavInclude_graph, 0); ((NavGraph) dest).addDestination(inflate(id)); a.recycle(); //å¦‚æŸ¥æ˜¯NavGraph &#125; else if (dest instanceof NavGraph) &#123; //å°±é€’å½’å»è°ƒç”¨ inflateè§£æå­æ ‡ç­¾ï¼Œç„¶åæŠŠå­æ ‡ç­¾ç”Ÿæˆçš„destinatioinåŠ å…¥åˆ°NavGraphçš„mNodesä¸­å» ((NavGraph) dest).addDestination(inflate(res, parser, attrs, graphResId)); &#125; &#125; return dest;&#125; è§£æå®ŒNavgraphåï¼ŒæŠŠgraphå’Œcontrollerç›¸å…³è” 12345678910public void setGraph(@NonNull NavGraph graph, @Nullable Bundle startDestinationArgs) &#123; if (mGraph != null) &#123; // Pop everything from the old graph off the back stack popBackStackInternal(mGraph.getId(), true); &#125; //æŠŠgraph èµ‹å€¼ç»™controllerä¸­çš„mGraphå˜é‡ mGraph = graph; //è¿™é‡Œå°±ä¼šæŠŠé»˜è®¤æ˜¾ç¤ºçš„é¡µé¢ç»™æ‰“å¼€ onGraphCreated(startDestinationArgs);&#125; å›å¤´çœ‹çœ‹NavGraphNavigator.java çš„navigateæ–¹æ³• 1234567891011121314151617181920212223public NavDestination navigate(@NonNull NavGraph destination, @Nullable Bundle args, @Nullable NavOptions navOptions, @Nullable Extras navigatorExtras) &#123; //æ‹¿åˆ°é»˜è®¤å±•ç¤ºé¡µé¢çš„id int startId = destination.getStartDestination(); if (startId == 0) &#123; throw new IllegalStateException(&quot;no start destination defined via&quot; + &quot; app:startDestination for &quot; + destination.getDisplayName()); &#125; //æœ‰è¿™ä¸ªidåï¼Œå°±èƒ½æ‹¿åˆ°é»˜è®¤å±•ç¤ºé¡µé¢çš„destinationå¯¹è±¡ NavDestination startDestination = destination.findNode(startId, false); if (startDestination == null) &#123; final String dest = destination.getStartDestDisplayName(); throw new IllegalArgumentException(&quot;navigation destination &quot; + dest + &quot; is not a direct child of this NavGraph&quot;); &#125; //ç„¶åé€šè¿‡nameåœ¨providerä¸­æ‹¿åˆ°navigator è¿™ä¸ªnavigatorå¯èƒ½æ˜¯fragmentnavigator activitynavigator dialognavigator Navigator&lt;NavDestination&gt; navigator = mNavigatorProvider.getNavigator( startDestination.getNavigatorName()); //æ‰§è¡Œå…·ä½“çš„navigatorçš„naigateæ–¹æ³•æŠŠé»˜è®¤é¡µé¢å¯åŠ¨èµ·æ¥ return navigator.navigate(startDestination, startDestination.addInDefaultArgs(args), navOptions, navigatorExtras);&#125; Navigationå„ç±»ä¹‹é—´çš„å…³ç³»","categories":[{"name":"Jetpackç³»åˆ—","slug":"Jetpackç³»åˆ—","permalink":"http://example.com/categories/Jetpack%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"Android","slug":"Android","permalink":"http://example.com/tags/Android/"},{"name":"Jetpack","slug":"Jetpack","permalink":"http://example.com/tags/Jetpack/"}]},{"title":"GradleåŸºç¡€","slug":"GradleåŸºç¡€","date":"2022-02-08T20:40:17.000Z","updated":"2022-02-09T22:21:28.000Z","comments":true,"path":"2022/02/09/GradleåŸºç¡€/","link":"","permalink":"http://example.com/2022/02/09/Gradle%E5%9F%BA%E7%A1%80/","excerpt":"è®²è§£GradleåŸºç¡€çŸ¥è¯†ï¼Œè¯­æ³•åŠç”Ÿå‘½å‘¨æœŸ","text":"è®²è§£GradleåŸºç¡€çŸ¥è¯†ï¼Œè¯­æ³•åŠç”Ÿå‘½å‘¨æœŸ Gradle åŸºç¡€ä½¿ç”¨ .&#x2F;gradlew clean -q æ¥è¿‡æ»¤åªæ˜¾ç¤ºæˆ‘ä»¬çš„è‡ªå·±çš„è¾“å‡ºæ—¥å¿— ä¸€ è¯­æ³•1.1 åŸºç¡€è¯­æ³•123456789101112131415161718192021222324252627int a = 10def b = 10String str = &quot;Hello,&quot; + &quot;World&quot;String str2 = str.toUpperCase()//åˆ—è¡¨def array = [1,2,3,4]array.add(5)array.each&#123;//é—­åŒ…ç‰¹æ€§ï¼Œåªæœ‰ä¸€ä¸ªå‚æ•°é»˜è®¤ä¸ºit å¯ä»¥çœç•¥ it -&gt; ä¸å†™ println(&quot;each item is $it&quot;)&#125;//æ˜ å°„è¡¨def map = [&quot;name&quot;:&quot;mooc&quot;,&quot;age&quot;:&quot;100&quot;]println(&quot;age is $&#123;map[&quot;age&quot;]&#125;&quot;)//å¾ªç¯for(int i = 0;i&lt;10;i++)&#123; println(&quot;i is $i&quot;)&#125;//å‡½æ•°def hello(String name)&#123; println(&quot;Hello, $name&quot;)&#125; 1.2 DSL Domain Specific Language é¢†åŸŸä¸“ç”¨è¯­è¨€ åªèƒ½ç”¨äºæ„å»ºï¼Œä¸èƒ½å¹²åˆ«çš„ï¼Œæ‰€ä»¥è¯´æ˜¯é¢†åŸŸä¸“ç”¨è¯­è¨€ è¿™ä¸ªæ˜¯android build.gradle çš„DSL 12345678910111213141516171819202122232425262728android &#123; compileSdkVersion 30 buildToolsVersion &quot;30.0.3&quot; defaultConfig &#123; applicationId &quot;com.steve.gradle_study&quot; minSdkVersion 21 targetSdkVersion 30 versionCode 1 versionName &quot;1.0&quot; testInstrumentationRunner &quot;androidx.test.runner.AndroidJUnitRunner&quot; &#125; buildTypes &#123; release &#123; minifyEnabled false proguardFiles getDefaultProguardFile(&#x27;proguard-android-optimize.txt&#x27;), &#x27;proguard-rules.pro&#x27; &#125; &#125; compileOptions &#123; sourceCompatibility JavaVersion.VERSION_1_8 targetCompatibility JavaVersion.VERSION_1_8 &#125; kotlinOptions &#123; jvmTarget = &#x27;1.8&#x27; &#125;&#125; 1.3 é—­åŒ…DSLçš„å®ç°æ˜¯åŸºäºgroovyä¸­çš„é—­åŒ…å®ç°çš„ å¼€æ”¾åŒ¿åçš„ä»£ç å—ï¼Œå¯ä»¥æ¥å—å‚æ•°ï¼Œå…·æœ‰è¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥è¢«åˆ†é…ç»™å˜é‡ å®šä¹‰è§„åˆ™:{ [params -&gt; ] statements } 123456789101112131415161718def c = &#123; println(&quot;hello closure&quot;)&#125;c()def c2 = &#123; it -&gt; println (&quot;it is $it&quot;)&#125;c2(&quot;yt&quot;)def c3 = &#123; println (&quot;it is $it&quot;)&#125;c3(&quot;yt&quot;)def c4 = &#123; name,age -&gt; println (&quot;name is $name&quot;) println (&quot;age is $age&quot;)&#125;c4(&quot;wwww&quot;,33) 1.4 å®ç°è‡ªå·±çš„DSL123456&#123; compileSdkVersion 25 defaultConfig&#123; versionName &quot;1.0&quot; &#125;&#125; ç”¨æˆ·é…ç½®æˆè¿™æ ·ï¼Œæˆ‘ä»¬æ€ä¹ˆèƒ½å–åˆ°å¯¹åº”çš„é…ç½®çš„å€¼ï¼Œä½¿ç”¨å¯¹è±¡å…³è”èµ·æ¥ é‡Œé¢çš„defaultconfig é—­åŒ…å¯¹åº”çš„å¯¹è±¡ 123456class DefalutConfig&#123; private String versionName def versionName(String versionName)&#123; this.versionName = versionName &#125;&#125; å¤–é¢çš„android é—­åŒ…å¯¹åº”çš„å¯¹è±¡ 1234567891011121314151617181920class Android&#123; private int compileSdkVersion private DefalutConfig defalutConfig Android()&#123; this.defalutConfig = new DefalutConfig() &#125; def compileSdkVersion(int compileSdkVersion)&#123; this.compileSdkVersion =compileSdkVersion &#125; //ä¼ å…¥ä¸€ä¸ªé—­åŒ…ï¼Œæ¥æ”¶åˆ°é—­åŒ…åè·Ÿæˆ‘ä»¬çš„DefaultConfigæˆå‘˜å˜é‡å…³è”èµ·æ¥ def defaultConfig(Closure closure)&#123; //å…³è”ä¹‹åï¼Œå¯¹è±¡å°±è·åˆ°åˆ°é—­åŒ…ä¸­å¯¹åº”åŒåçš„å€¼äº† closure.setDelegate(defalutConfig) closure.call() &#125;&#125; ä½¿ç”¨ 123456789101112def myAndroid = &#123; compileSdkVersion 25 defaultConfig&#123; versionName &quot;1.0&quot; &#125;&#125;Android a = new Android()//å°†é—­åŒ…ä¸å…·ä½“å¯¹è±¡å…³è”èµ·æ¥ï¼Œè¿™æ ·åœ¨é—­åŒ…ä¸­è®¾ç½®çš„å€¼å°±åˆ°äº†å¯¹è±¡aä¸­äº†ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å°a è·å–aä¸­çš„å€¼myAndroid.delegate = amyAndroid.call() è¿è¡Œ 1./graldew clean -q äºŒ Gradleæ„å»ºè„šæœ¬åŸºç¡€å‡ ä¸ªå…³é”®çš„æ–‡ä»¶ settings.gradleâ€”å®šä¹‰å…¨å±€å‚ä¸æ„å»ºçš„æ¨¡å— build.gradleâ€”æœ‰ä¸¤ç±»build.gradleæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯å…¨å±€çš„å®šä¹‰å…±ç”¨å‚æ•°ï¼Œå„ä¸ªå•ç‹¬çš„å®šä¹‰è‡ªå·±çš„é…ç½® gradle.propertiesâ€”å®šä¹‰å¼€å…³å‹å‚æ•°çš„æ–‡ä»¶ ä¸‰ Gradleæ„å»ºçš„ç”Ÿå‘½å‘¨æœŸ åˆå§‹åŒ–é˜¶æ®µâ€”æ”¶é›†æ‰€æœ‰è¦å‚ä¸æ„å»ºçš„å­å·¥ç¨‹ï¼Œåˆ›å»ºä¸€ä¸ªé¡¹ç›®å±‚æ¬¡ç»“æ„ï¼Œå¹¶ä¸”ä¸ºæ¯ä¸€ä¸ªé¡¹ç›®åˆ›å»ºä¸€ä¸ªprojectå®ä¾‹ï¼Œå’Œè¿™ä¸ªé˜¶æ®µå…³ç³»æœ€å¤§çš„å°±æ˜¯æˆ‘ä»¬çš„settings.gradleæ–‡ä»¶ é…ç½®é˜¶æ®µâ€”æ‰§è¡Œå„ä¸ªå­å·¥ç¨‹è‡ªå·±çš„build.gradleï¼Œå¯¹projectè¿›è¡Œé…ç½®ï¼Œå¹¶ä¸”æ ¹æ®é…ç½®å½¢æˆä¸€ä¸ªä»»åŠ¡ä¾èµ–é“¾ï¼Œä»¥ä¾¿åœ¨ä¸‹ä¸€ä¸ªé˜¶æ®µæ‰§è¡Œé˜¶æ®µï¼Œæ–¹ä¾¿æ‰§è¡Œä»»åŠ¡ æ‰§è¡Œé˜¶æ®µâ€”æ‰§è¡Œä¸Šä¸€é˜¶æ®µçš„tasks æˆ‘ä»¬åœ¨settings.gradleä¸­æ·»åŠ ç”Ÿå‘½å‘¨æœŸçš„ç›‘å¬å‡½æ•° 1234567891011121314151617181920//æ·»åŠ æ„å»ºçš„ç”Ÿå‘½å‘¨æœŸgradle.addBuildListener(new BuildAdapter()&#123; @Override void settingsEvaluated(Settings settings) &#123; super.settingsEvaluated(settings) println (&quot;[life-cycle] åˆå§‹åŒ–é˜¶æ®µå®Œæˆ&quot;) &#125; @Override void projectsEvaluated(Gradle gradle) &#123; super.projectsEvaluated(gradle) println (&quot;[life-cycle] é…ç½®é˜¶æ®µå®Œæˆ&quot;) &#125; @Override void buildFinished(BuildResult result) &#123; super.buildFinished(result) println (&quot;[life-cycle] æ„å»ºç»“æŸ&quot;) &#125;&#125;) æ‰“å°ç»“æœ å‡ ä¸ªä¸»è¦è§’è‰² åˆå§‹åŒ–é˜¶æ®µ-root project é…ç½®é˜¶æ®µ-project æ‰§è¡Œé˜¶æ®µ-task","categories":[],"tags":[]},{"title":"å€ŸåŠ©v2ray,è®°ä¸€æ¬¡VPNå†…ç½‘ç©¿é€å®è·µ","slug":"è®°ä¸€æ¬¡vpnå†…ç½‘ç©¿é€å®è·µ","date":"2022-02-02T08:29:10.000Z","updated":"2022-02-09T00:14:29.000Z","comments":true,"path":"2022/02/02/è®°ä¸€æ¬¡vpnå†…ç½‘ç©¿é€å®è·µ/","link":"","permalink":"http://example.com/2022/02/02/%E8%AE%B0%E4%B8%80%E6%AC%A1vpn%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%AE%9E%E8%B7%B5/","excerpt":"èŠ±äº†ä¸€å¤©æäº†ä¸‹å…¬å¸çš„å†…ç½‘ç©¿é€ï¼Œå…ˆç»™å‡ºå‚è€ƒçš„é“¾æ¥åŸæ–‡åŠåŸç†ï¼Œå†ç»™å‡ºè‡ªå·±çš„å®è·µè®°å½•ï¼Œå¯ä»¥ç›´æ¥æ‹·è´ï¼Œæ¢ä¸‹ç«¯å£å’Œä½ ä»¬é˜¿é‡Œäº‘(æˆ–è€…è‡ªå·±ä½¿ç”¨çš„äº‘ï¼Œè¿™é‡Œéƒ½ä»¥é˜¿é‡Œäº‘åšä¾‹å­)çš„å¤–ç½‘IPå°±OKäº†","text":"èŠ±äº†ä¸€å¤©æäº†ä¸‹å…¬å¸çš„å†…ç½‘ç©¿é€ï¼Œå…ˆç»™å‡ºå‚è€ƒçš„é“¾æ¥åŸæ–‡åŠåŸç†ï¼Œå†ç»™å‡ºè‡ªå·±çš„å®è·µè®°å½•ï¼Œå¯ä»¥ç›´æ¥æ‹·è´ï¼Œæ¢ä¸‹ç«¯å£å’Œä½ ä»¬é˜¿é‡Œäº‘(æˆ–è€…è‡ªå·±ä½¿ç”¨çš„äº‘ï¼Œè¿™é‡Œéƒ½ä»¥é˜¿é‡Œäº‘åšä¾‹å­)çš„å¤–ç½‘IPå°±OKäº† åå‘ä»£ç†&#x2F;å†…ç½‘ç©¿é€ åŸç†ç®€å•ç‚¹è¯´ï¼Œå°±æ˜¯ï¼Œæœ€ç»ˆå®ç°äº†ï¼Œä½ åœ¨å®¶é‡Œï¼Œé€šè¿‡é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œé€šè¿‡å…¬å¸çš„å±€åŸŸç½‘æœåŠ¡å™¨æ¥è®¿é—®å…¬å¸çš„å±€åŸŸç½‘èµ„æºï¼Œè¿™ä¸ªç‰¹åˆ«é€‚ç”¨äºï¼Œä½ ä¸ªäººæ²¡æ³•ä½¿ç”¨å…¬å¸å¤–ç½‘IPåšå†…ç½‘æ˜ å°„ï¼Œå±€åŸŸç½‘æœåŠ¡å™¨(æˆ–è€…åœ¨å…¬å¸çš„æŸä¸€å°ç”µè„‘)å¯ä»¥è®¿é—®å¤–ç½‘çš„æƒ…å†µã€‚å½“ç„¶æ›´ä¹ æƒ¯äºç”¨è¿œç¨‹çš„å½“æˆ‘æ²¡è¯´ã€‚åŸç†å°±æ˜¯ï¼Œä¸¤ä¸ªæœåŠ¡å™¨éƒ½éƒ¨ç½²v2rayï¼Œç„¶åå…¬å¸çš„å±€åŸŸç½‘è¿æ¥é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œå†åå‘ä»£ç†å›æ¥ï¼Œæœ€ç»ˆå®¢æˆ·æœºé€šè¿‡å®¢æˆ·ç«¯è¿æ¥é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œæœ€ç»ˆé€šè¿‡å…¬å¸çš„æœåŠ¡å™¨è®¿é—®å†…ç½‘ã€‚ é…ç½®1.é˜¿é‡Œäº‘æœåŠ¡å™¨å…ˆé…ç½®ä¸­é—´çš„é˜¿é‡Œäº‘æœåŠ¡å™¨ï¼Œåˆ«å¿˜äº†é˜¿é‡Œäº‘æœåŠ¡å™¨è¦ä¿è¯ä½ çš„vpnæœåŠ¡çš„ç«¯å£è¦è®¾ç½®ä¸ºå¼€æ”¾çŠ¶æ€ï¼Œå› ä¸ºæœ¬æ¥æ˜¯è¦å®¢æˆ·æœºå’Œå†…ç½‘çš„æœåŠ¡å™¨èµ°ä¸¤ä¸ªinboundsçš„ï¼Œä½†è¿˜éœ€è¦è®©é¢†å¯¼å†å¼€ä¸€ä¸ªç«¯å£å°±æ²¡å¥½æ„æ€æï¼Œè¿™é‡Œç”¨åŒä¸€ä¸ªvemess inbound æ¥æ¥æ”¶æ¥è‡ªä¸¤ç«¯çš„è¯·æ±‚ï¼Œåšç®€åŒ–å¤„ç†ä¹Ÿæ˜¯å¯è¡Œçš„ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&#123; &quot;reverse&quot;:&#123;//åå‘ä»£ç†è®¾ç½®ï¼Œæ­£å¸¸æ­vpnä¸éœ€è¦ &quot;portals&quot;:[ &#123; &quot;tag&quot;:&quot;portal&quot;, &quot;domain&quot;:&quot;private.cloud.com&quot; //è¿™ä¸ªåŸŸåå¯ä»¥éšä¾¿å–ï¼Œä½†è¦å’Œä¸‹é¢ä¿æŒä¸€è‡´ &#125; ] &#125;, &quot;log&quot;: &#123; &quot;access&quot;: &quot;&quot;, &quot;error&quot;: &quot;&quot;, &quot;loglevel&quot;: &quot;warning&quot; &#125;, &quot;inbounds&quot;: [ &#123; &quot;tag&quot;:&quot;interconn&quot;, &quot;port&quot;: 10086, //å¼€æ”¾çš„ç«¯å£ &quot;protocol&quot;: &quot;vmess&quot;, &quot;settings&quot;: &#123; &quot;clients&quot;: [//è®¾ç½®è®¿é—®è´¦æˆ·çš„id å¯éšæœºç”Ÿæˆ ä½†è¦æ³¨æ„å¯¹åº” &#123; &quot;id&quot;: &quot;0c15dd83-3552-4b53-b835-907e6c262d9b&quot;, &quot;alterId&quot;: 64 &#125; ] &#125; &#125; ], &quot;routing&quot;:&#123; &quot;rules&quot;:[ &#123; &quot;type&quot;:&quot;field&quot;, &quot;inboundTag&quot;:[ &quot;external&quot; ], &quot;outboundTag&quot;:&quot;portal&quot; &#125;, &#123; &quot;type&quot;:&quot;field&quot;, &quot;inboundTag&quot;:[ &quot;tunnel&quot; ], &quot;domain&quot;:[ &quot;full:private.cloud.com&quot; ], &quot;outboundTag&quot;:&quot;portal&quot; &#125; ] &#125;&#125; å› ä¸ºå…¬å¸é˜¿é‡Œäº‘æœåŠ¡å™¨æ˜¯windowsæœåŠ¡å™¨ï¼Œæ‰€ä»¥ä¹Ÿå­¦ä¹ äº†ä¸‹windowsç‰ˆæœ¬çš„v2rayæœåŠ¡å™¨çš„éƒ¨ç½²ï¼Œå…¶å®éå¸¸ç®€å•ã€‚ ç½‘ä¸Šä¸‹è½½v2ray-windows-64 v2ray.exeæ‰§è¡Œå°±æ˜¯æŠŠæ§åˆ¶å°æ˜¾ç¤ºå‡ºæ¥å¹¶å¯åŠ¨v2rayï¼Œå®ƒä¼šè‡ªåŠ¨ä½¿ç”¨å½“å‰ç›®å½•ä¸‹çš„configé…ç½®ï¼Œå¯ä»¥çœ‹åˆ°è®¿é—®çš„ip wv2ray.exeä¹Ÿæ˜¯å¯åŠ¨v2rayï¼Œä½†æ˜¯å®ƒæ˜¯åå°å¯åŠ¨ï¼Œèƒ½åœ¨ä»»åŠ¡è¿›ç¨‹ä¸­çœ‹åˆ°åŠå…³é—­è¯¥è¿›ç¨‹æœåŠ¡ 2.å†…ç½‘æœåŠ¡å™¨å› ä¸ºä¸€ç›´æ‹‰å–githubçš„å†…å®¹æ‹‰ä¸ä¸‹æ¥ï¼Œè‡ªåŠ¨å®‰è£…ä¸€ç›´ä¸æˆåŠŸï¼Œæ‰€ä»¥å†…ç½‘çš„linuxæœåŠ¡å™¨æ˜¯æ‰‹åŠ¨éƒ¨ç½²çš„ï¼Œå…¶å®æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œå°±æ˜¯ç¨å¾®éº»çƒ¦äº› v2rayå®Œå…¨ä½¿ç”¨æ•™ç¨‹ 2-2æ‰‹åŠ¨å®‰è£… æˆ‘è¿™é‡Œæ˜¯é€šè¿‡è‡ªå·±çš„ç”µè„‘ä¸‹è½½ä¸‹æ¥v2ray-linux-64.zip ç„¶åscpåˆ°æœåŠ¡å™¨ä¸Šè§£å‹ï¼Œç„¶åè¿›è¡Œæ‰‹åŠ¨éƒ¨ç½²çš„ ç„¶åæŠŠå„ä¸ªæ–‡ä»¶mvåˆ°ç›¸åº”çš„ç›®å½•ä¸­ 123456sudo mkdir /etc/v2ray /usr/bin/v2ray /var/log/v2ray # åˆ›å»ºç›®å½•sudo chmod +x v2ray v2ctl # èµ‹äºˆå¯æ‰§è¡Œæƒé™sudo mv v2ray v2ctl geoip.dat geosite.dat -t /usr/bin/v2ray # ç§»åŠ¨æ–‡ä»¶touch /etc/v2ray/config.json # ä»…åˆ›å»ºé…ç½®æ–‡ä»¶çš„ç©ºæ–‡ä»¶sudo mv systemd/v2ray.service /etc/systemd/system/sudo systemctl enable v2ray # ç”¨äºç¨‹åºå¼€æœºå¯åŠ¨å¹¶ä¸”å´©æºƒæ—¶è‡ªåŠ¨é‡å¯ç¨‹åº ä½†è¦æ³¨æ„å¯¹åº”çš„ç›®å½•ï¼Œè€Œä¸”è¦çœ‹ä¸‹v2ray.serviceä¸­çš„é…ç½®ï¼Œæ‰§è¡Œçš„å‘½ä»¤çš„v2rayç›¸åº”çš„æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œåœ¨è¿™é‡Œå¡äº†å¥½ä¹…ï¼Œä¸€ç›´å¯ä¸èµ·æ¥æœåŠ¡ï¼Œç»“æœå‘ç°æ˜¯v2rayå’Œconfig.jsonç›¸åº”çš„ç›®å½•ä¸å¯¹ 12345678#å¯ç”¨å’Œç¦ç”¨sudo systemctl enable v2raysudo systemctl disable v2ray#å¯åŠ¨ã€åœæ­¢ã€é‡å¯v2raysudo systemctl start v2raysudo systemctl stop v2raysudo systemctl restart v2ray ä¸‹é¢ç»™å‡ºå†…ç½‘æœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&#123; &quot;reverse&quot;:&#123; &quot;bridges&quot;:[ &#123; &quot;tag&quot;:&quot;bridge&quot;, &quot;domain&quot;:&quot;private.cloud.com&quot; // A å’Œ B åå‘ä»£ç†é€šä¿¡çš„åŸŸåï¼Œå¯ä»¥è‡ªå·±å–ä¸€ä¸ªï¼Œå¯ä»¥ä¸æ˜¯è‡ªå·±è´­ä¹°çš„åŸŸåï¼Œä½†å¿…é¡»è·Ÿä¸Šé¢ é˜¿é‡Œäº‘ ä¸­çš„ reverse é…ç½®çš„åŸŸåä¸€è‡´ &#125; ] &#125;, &quot;outbounds&quot;:[ &#123; //å†…ç½‘è¿æ¥é˜¿é‡Œäº‘çš„outbound &quot;tag&quot;:&quot;tunnel&quot;, &quot;protocol&quot;:&quot;vmess&quot;, &quot;settings&quot;:&#123; &quot;vnext&quot;:[ &#123; &quot;address&quot;:&quot;serveraddr.com&quot;, // é˜¿é‡Œäº‘å¤–ç½‘ åœ°å€ï¼ŒIP æˆ– å®é™…çš„åŸŸå &quot;port&quot;:10086, &quot;users&quot;:[ &#123; &quot;id&quot;:&quot;0c15dd83-3552-4b53-b835-907e6c262d9b&quot;, &quot;alterId&quot;:64 &#125; ] &#125; ] &#125; &#125;, // å¦ä¸€ä¸ª outboundï¼Œæœ€ç»ˆè¿æ¥ç§æœ‰ç½‘ç›˜ &#123; &quot;protocol&quot;:&quot;freedom&quot;, &quot;settings&quot;:&#123; &#125;, &quot;tag&quot;:&quot;out&quot; &#125; ], &quot;routing&quot;:&#123; &quot;rules&quot;:[ &#123; // é…ç½® A ä¸»åŠ¨è¿æ¥ B çš„è·¯ç”±è§„åˆ™ &quot;type&quot;:&quot;field&quot;, &quot;inboundTag&quot;:[ &quot;bridge&quot; ], &quot;domain&quot;:[ &quot;full:private.cloud.com&quot; ], &quot;outboundTag&quot;:&quot;tunnel&quot; &#125;, &#123; // åå‘è¿æ¥è®¿é—®ç§æœ‰ç½‘ç›˜çš„è§„åˆ™ &quot;type&quot;:&quot;field&quot;, &quot;inboundTag&quot;:[ &quot;bridge&quot; ], &quot;outboundTag&quot;:&quot;out&quot; &#125; ] &#125;&#125; 3.å®¢æˆ·ç«¯é…ç½®çœ‹ä½ ä½¿ç”¨çš„ç³»ç»Ÿï¼Œæˆ‘çš„æ˜¯å®¢æˆ·ç«¯è®¾ç½®å®Œåè‡ªåŠ¨ç”Ÿæˆjsonçš„ï¼Œæ²¡å•¥ç‰¹æ®Šè¦è¯´çš„ï¼Œå¯ä»¥è‡ªå·±ç”Ÿæˆï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªé…ç½® 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115&#123; &quot;routing&quot; : &#123; &quot;name&quot; : &quot;all_to_main&quot;, &quot;domainStrategy&quot; : &quot;AsIs&quot;, &quot;rules&quot; : [ &#123; &quot;type&quot; : &quot;field&quot;, &quot;outboundTag&quot; : &quot;ip_60&quot;, &quot;port&quot; : &quot;0-65535&quot; &#125; ] &#125;, &quot;inbounds&quot; : [ &#123; &quot;listen&quot; : &quot;127.0.0.1&quot;, &quot;protocol&quot; : &quot;socks&quot;, &quot;settings&quot; : &#123; &quot;ip&quot; : &quot;127.0.0.1&quot;, &quot;auth&quot; : &quot;noauth&quot;, &quot;udp&quot; : false &#125;, &quot;tag&quot; : &quot;socksinbound&quot;, &quot;port&quot; : 1081 &#125;, &#123; &quot;listen&quot; : &quot;127.0.0.1&quot;, &quot;protocol&quot; : &quot;http&quot;, &quot;settings&quot; : &#123; &quot;timeout&quot; : 0 &#125;, &quot;tag&quot; : &quot;httpinbound&quot;, &quot;port&quot; : 8001 &#125; ], &quot;dns&quot; : &#123; &quot;servers&quot; : [ &quot;localhost&quot; ] &#125;, &quot;log&quot; : &#123; &quot;loglevel&quot; : &quot;info&quot; &#125;, &quot;outbounds&quot; : [ &#123; &quot;sendThrough&quot; : &quot;0.0.0.0&quot;, &quot;mux&quot; : &#123; &quot;enabled&quot; : false, &quot;concurrency&quot; : 8 &#125;, &quot;protocol&quot; : &quot;vmess&quot;, &quot;settings&quot; : &#123; &quot;vnext&quot; : [ &#123; &quot;address&quot; : &quot;serveraddr.com&quot;, &quot;users&quot; : [ &#123; &quot;id&quot; : &quot;0c15dd83-3552-4b53-b835-907e6c262d9b&quot;, &quot;alterId&quot; : 64, &quot;security&quot; : &quot;auto&quot;, &quot;level&quot; : 0 &#125; ], &quot;port&quot; : 10086 &#125; ] &#125;, &quot;tag&quot; : &quot;ip_60&quot;, &quot;streamSettings&quot; : &#123; &quot;wsSettings&quot; : &#123; &quot;path&quot; : &quot;&quot;, &quot;headers&quot; : &#123; &#125; &#125;, &quot;quicSettings&quot; : &#123; &quot;key&quot; : &quot;&quot;, &quot;header&quot; : &#123; &quot;type&quot; : &quot;none&quot; &#125;, &quot;security&quot; : &quot;none&quot; &#125;, &quot;tlsSettings&quot; : &#123; &quot;allowInsecure&quot; : false, &quot;alpn&quot; : [ &quot;http\\/1.1&quot; ], &quot;serverName&quot; : &quot;server.cc&quot;, &quot;allowInsecureCiphers&quot; : false &#125;, &quot;httpSettings&quot; : &#123; &quot;path&quot; : &quot;&quot; &#125;, &quot;kcpSettings&quot; : &#123; &quot;header&quot; : &#123; &quot;type&quot; : &quot;none&quot; &#125;, &quot;mtu&quot; : 1350, &quot;congestion&quot; : false, &quot;tti&quot; : 20, &quot;uplinkCapacity&quot; : 5, &quot;writeBufferSize&quot; : 1, &quot;readBufferSize&quot; : 1, &quot;downlinkCapacity&quot; : 20 &#125;, &quot;tcpSettings&quot; : &#123; &quot;header&quot; : &#123; &quot;type&quot; : &quot;none&quot; &#125; &#125;, &quot;security&quot; : &quot;none&quot;, &quot;network&quot; : &quot;tcp&quot; &#125; &#125; ]&#125;","categories":[],"tags":[]}],"categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"},{"name":"UI","slug":"UI","permalink":"http://example.com/categories/UI/"},{"name":"Jetpackç³»åˆ—","slug":"Jetpackç³»åˆ—","permalink":"http://example.com/categories/Jetpack%E7%B3%BB%E5%88%97/"}],"tags":[{"name":"webview","slug":"webview","permalink":"http://example.com/tags/webview/"},{"name":"hybrid","slug":"hybrid","permalink":"http://example.com/tags/hybrid/"},{"name":"Android","slug":"Android","permalink":"http://example.com/tags/Android/"},{"name":"Jetpack","slug":"Jetpack","permalink":"http://example.com/tags/Jetpack/"}]}